_SH.Modals.login=function(a){_SH.Components.Checkbox(a.find('input[type="checkbox"]'))
};
_SH.Modals.recontract=function(a){_SH.Components.Radio(a.find('input[type="radio"]')).on("change",function(){var b=$(this),c=b.parents("li");
c.addClass("selected").siblings().removeClass("selected");
$.colorbox.resize()
})
};
_SH.Modals.test_form=function(a){_SH.Components.Dropdown(a.find("select:not(.listbox)"));
a.find(".datepicker").datepicker({inline:true,dateFormat:"dd/mm/yy",changeMonth:true,changeYear:true,yearRange:"-60:+0"})
};
_SH.Modals.hubid_lite=function(a){_SH.Components.Dropdown(a.find("select:not(.listbox)"));
a.find(".calendar-icon").on("click",function(){$(this).siblings(".datepicker").focus()
});
a.find(".datepicker").datepicker({inline:true,dateFormat:"dd/mm/yy",changeMonth:true,changeYear:true,yearRange:"-60:+0"});
_SH.Components.Button(a.find("button"));
var b={nric:[{value:"singaporean",text:"Singaporean"},{value:"permanent resident",text:"Permanent Resident"}],fin:[{value:"dependent Pass",text:"Dependent Pass"},{value:"diplomat",text:"Diplomat"},{value:"tve",text:"Entrepass / TVE"},{value:"ltsvp",text:"LTSVP"},{value:"non diplomat",text:"Non-Diplomat"},{value:"p1",text:"P1"},{value:"p2",text:"P2"},{value:"pep",text:"PEP"},{value:"q1",text:"Q1"},{value:"q2",text:"Q2 / S Pass"},{value:"student pass",text:"Student Pass"},{value:"tvp",text:"TVP"},{value:"work permit",text:"Work Permit"}],passport:[{value:"diplomat",text:"Diplomat"},{value:"svp",text:"SVP"}]};
a.find("#personal_id").on("change",function(j){var d=a.find("#id_type"),g=d.data("dd");
if(typeof b[this.value]=="undefined"){alert("Doc Type not valid!!");
return false
}for(var h=g.length,f=0;
h>0;
h--){g.remove(0)
}for(var h=0,c=b[this.value].length;
h<c;
h++){g.add(b[this.value][h])
}g.setIndexByValue(b[this.value][0].value)
})
};
var baseUrl=baseUrl||{};
baseUrl.prefix="/content/starhub/en/personal/store/mobile";
baseUrl.storePrefix="/content/starhub/en/personal/store";
baseUrl.browse=baseUrl.prefix+"/browse.html";
baseUrl.mangleName=function(b){var a=$.trim(b);
return a.toLowerCase().replace(/[ ]/g,"-").replace(/[^a-zA-Z0-9_-]/g,"_")
};
baseUrl.browseBrand=function(a){return baseUrl.prefix+"/browse.html?brand="+escapeParam(a)
};
baseUrl.mobileDetail=function(b,a){return baseUrl.prefix+"/browse/"+baseUrl.mangleName(b)+"/"+baseUrl.mangleName(a)+".html"
};
baseUrl.billRebate=baseUrl.prefix+"/orderconfig_billrebate.html";
baseUrl.billing=baseUrl.storePrefix+"/billing.html";
baseUrl.cartSummary=baseUrl.storePrefix+"/cartsummary.html";
baseUrl.phoneComparison=baseUrl.prefix+"/browse/phone-comparison.html";
baseUrl.orderConfig=baseUrl.prefix+"/orderconfigurator.html";
baseUrl.orderConfirmation=baseUrl.storePrefix+"/orderconfirmation.html";
baseUrl.landingBillRebate=baseUrl.prefix+"/bill-rebate.html";
baseUrl.modalRecontractLightbox="/content/dam/onlinestore/html/modal-recontract.html";
baseUrl.FAIL_MSG_URL="/content/dam/onlinestore/html/failmsg.html";
baseUrl.LOGIN_FORM_HTML="/content/dam/onlinestore/html/modal-login.html";
baseUrl.modalChangeDeviceLightBox="/content/dam/onlinestore/html/modal-change-device.html";
baseUrl.confirmRemoveMainPIck="/content/dam/onlinestore/html/confirm_remove.html";
baseUrl.DEFAULT_IMAGE="/etc/designs/onlinestore/img/imagenotavailable.jpg";
baseUrl.FILTER_JSON_FILE="/content/starhub/en/dev/onlinestore/json/filter.json";
baseUrl.paymentPlanJsonLocation="/content/starhub/en/dev/onlinestore/json/paymentplan.json";
baseUrl.accessoryDefaultImageURL="/etc/designs/onlinestore/img/imagenotavailable-accessories.jpg";
baseUrl.modalBillingLinesLightBox="/content/dam/onlinestore/html/modal-billing-lines.html";
baseUrl.paymentSling="/content/starhub/en/dev/onlinestore/PaymentSlingServlet";
baseUrl.txStatusSling="/content/starhub/en/dev/onlinestore/TxStatusProcessorSlingServlet";
baseUrl.modalUserInfo="/content/dam/onlinestore/html/modal-user-info.html";
baseUrl.newSignUpOrRecontract="/content/dam/onlinestore/html/modal-signup-or-recontract.html";
baseUrl.roundingPrice=function(a){return +(Math.round(a+"e+2")+"e-2")
};
var AJAX_UTOKEN_URL="/content/starhub/en/dev/login/loginfapi.html";
"use strict";
var hashedVctk3=hashedVctk3||undefined;
var hashedHubID=hashedHubID||undefined;
var scPageName=scPageName||"";
function getHashedVctk3(){if(hashedVctk3==null||hashedVctk3==undefined){var a=getCookie("vctk3");
hashedVctk3=(a?$.md5(a):"")
}return hashedVctk3
}function getHashedHudID(a){if(hashedHubID==null||hashedHubID==undefined){if(a!=undefined&&a!=null){hashedHubID=$.md5(a)
}else{hashedHubID=""
}}return hashedHubID
}function getCookie(d){var b=d+"=";
var a=document.cookie.split(";");
for(var e=0;
e<a.length;
e++){var f=$.trim(a[e]);
if(f.indexOf(b)==0){return f.substring(b.length,f.length)
}}return undefined
}function getNowTimeStamp(){return new Date().getTime()
}var ONLINEWEB_FAPI_URL={DEVICE_MOBILE_HANDSETS:"/devices/mobile?ts="+getNowTimeStamp(),DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID:"/devices?campaignId={0}&ts="+getNowTimeStamp(),DEVICE_MOBILE_HANDSETS_BRAND:"/devices/mobile;brand={0}?ts="+getNowTimeStamp(),DEVICE_MOBILE_HANDSETS_OFFER:"/devices/mobile/{0}/{1}?ts="+getNowTimeStamp(),PRODUCTS_MOBILE_PLANS:"/products/mobile/plans?ts="+getNowTimeStamp(),CONTRACTS_MOBILE:"/contracts/mobile?ts="+getHashedVctk3(),LOGIN_ESSO:"/login/esso",EXISTING_VAS:"/products?planPartNumber={0}&serviceId={1}&ts="+getHashedVctk3(),VAS:"/products?planPartNumber={0}&ts="+getHashedVctk3(),BASKET_PICK:"/basket/pick",BASKET:"/basket?ts="+getHashedVctk3(),DELETE_PICK:"/basket/pick/{0}",LOV_SIMTYPE:"/lov/simType",ADDRESS_POSTALCODE:"/address?PostalCode={0}",ELIGIBILITY_NEW_SIGNUP_MASTER:"/eligibility?name=master&ts="+getHashedVctk3(),ELIGIBILITY_NEW_SIGNUP:"/new/mobile",ELIGIBILITY_RECONTRACT:"/recontract/mobile/{0}",ELIGIBILITY_BASKET:"/basket/eligibility?ts="+getHashedVctk3(),ELIGIBILITY_BILLREBATE:"/request/discount/{0}?name=billrebate&ts="+getHashedVctk3(),MOBILE_ACCESSORY:"/devices/mobile/accessories/{0}",MOBILE_STOCK_STATUS:"/inventory/{0}?ts="+getNowTimeStamp(),TRAY:"/tray?ts="+getHashedVctk3(),RETRIEVE_MOBILE_NUMBERS_NEWSIGNUP:"/numbers/msisdn/{0}?simCategory={1}&ts="+getHashedVctk3(),BASKET_APPOINTMENT:"/appointmentslots/{0}?ts="+getHashedVctk3(),RPODUCT_PLAN:"/products/plan/{0}",BILLS:"/bills?ts="+getHashedVctk3(),DOCUMENT_TYPE:"/lov/customer/documenttype",HUBIDLITE_AUTHTOKEN:"/authtoken",ORDER_TRACK:"/orders/status?ts="+getHashedVctk3(),ORDER_ELIGIBILITY:"/basket/pick/subscription/eligibility/{0}",LOV_TITLE:"/lov/customer/title",LOV_RACE:"/lov/customer/race",LOV_NATIONALITY:"/lov/customer/nationality",LOV_GENDER:"/lov/customer/gender",LOV_DOCSUBTYPE:"/lov/customer/docSubType?docType={0}",UPDATE_CUST_PDPA:"/request/updatepersonalinformation",UPDATE_CUST_INFO:"/customerinfo",ELIGIBILITY_HUBCLUB_DISCOUNT:"/eligibility?name=hubcluberfdiscount&serviceid={0}&ts="+getHashedVctk3(),CHECK_SR_STATUS:"/check/pendingRequest?ts="+getNowTimeStamp()};
function setHeader(c,b){var a={};
if(b===""||b==null||b==undefined){if(c===FAPI_HOST.HTTPS){a.userAgent=X_USER_AGENT.HTTPS+""
}else{a.userAgent=X_USER_AGENT.HTTP+""
}}else{if(c===FAPI_HOST.HTTPS){a.userAgent=X_USER_AGENT.HTTPS+"";
a.auth=b+""
}else{a.userAgent=X_USER_AGENT.HTTP+"";
a.auth=b+""
}}return a
}function getFAPIURL(c,b,d,a){if(d==null||d==undefined||d==""){return c+b
}if(a==null||a==undefined){return c+b.replace("{0}",d)
}else{return c+b.replace("{0}",d).replace("{1}",a)
}}function getURL(d,e,b,c){var a={};
switch(d){case ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BRAND:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BRAND,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BRAND,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_OFFER:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_OFFER,e,c);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_OFFER,e,c);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.VAS:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.VAS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.EXISTING_VAS:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.EXISTING_VAS,e,c);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.BASKET_PICK:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.BASKET_PICK,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.DELETE_PICK:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DELETE_PICK,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.BASKET:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.BASKET,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ADDRESS_POSTALCODE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ADDRESS_POSTALCODE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.LOV_SIMTYPE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_SIMTYPE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_RECONTRACT:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_RECONTRACT,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP_MASTER:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP_MASTER,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_BASKET:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_BASKET,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_BILLREBATE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_BILLREBATE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.MOBILE_ACCESSORY:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.MOBILE_ACCESSORY,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.MOBILE_STOCK_STATUS:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.MOBILE_STOCK_STATUS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.MOBILE_STOCK_STATUS,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.RETRIEVE_MOBILE_NUMBERS_NEWSIGNUP:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.RETRIEVE_MOBILE_NUMBERS_NEWSIGNUP,e,c);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.BASKET_APPOINTMENT:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.BASKET_APPOINTMENT,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.RPODUCT_PLAN:if(isLogon()){a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.RPODUCT_PLAN,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS).userAgent
}else{a.url=getFAPIURL(FAPI_HOST.HTTP,ONLINEWEB_FAPI_URL.RPODUCT_PLAN,e);
a.userAgent=setHeader(FAPI_HOST.HTTP).userAgent
}break;
case ONLINEWEB_FAPI_URL.TRAY:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.TRAY,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.BILLS:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.BILLS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.DOCUMENT_TYPE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.DOCUMENT_TYPE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.HUBIDLITE_AUTHTOKEN:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.HUBIDLITE_AUTHTOKEN,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ORDER_TRACK:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ORDER_TRACK,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ORDER_ELIGIBILITY:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ORDER_ELIGIBILITY,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.LOV_TITLE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_TITLE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
break;
case ONLINEWEB_FAPI_URL.LOV_RACE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_RACE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
break;
case ONLINEWEB_FAPI_URL.LOV_NATIONALITY:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_NATIONALITY,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
break;
case ONLINEWEB_FAPI_URL.LOV_GENDER:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_GENDER,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
break;
case ONLINEWEB_FAPI_URL.LOV_DOCSUBTYPE:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.LOV_DOCSUBTYPE,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
break;
case ONLINEWEB_FAPI_URL.UPDATE_CUST_INFO:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.UPDATE_CUST_INFO,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.UPDATE_CUST_PDPA:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.UPDATE_CUST_PDPA,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.GET_CUSTINFO:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.GET_CUSTINFO,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.ELIGIBILITY_HUBCLUB_DISCOUNT:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.ELIGIBILITY_HUBCLUB_DISCOUNT,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth;
break;
case ONLINEWEB_FAPI_URL.CHECK_SR_STATUS:a.url=getFAPIURL(FAPI_HOST.HTTPS,ONLINEWEB_FAPI_URL.CHECK_SR_STATUS,e);
a.userAgent=setHeader(FAPI_HOST.HTTPS,b).userAgent;
a.auth=setHeader(FAPI_HOST.HTTPS,b).auth
}return a
}function callFAPI_(b,h,c,g,f,e){var a=getURL(b,h,f,e);
var d=$.ajax({url:a.url,cache:true,type:c,data:g==undefined||g==null||g==""?"":g,beforeSend:function(j){if(a.auth!==undefined&&a.auth!==""){j.setRequestHeader("Authorization",a.auth)
}if(a.auth!==undefined&&a.auth!==""){j.setRequestHeader("X-Forwarded-Proto",a.xForwardedProto)
}if(c.toUpperCase()==="DELETE"){j.setRequestHeader("X-User-Agent",a.userAgent);
j.setRequestHeader("Accept","text/plain")
}else{j.setRequestHeader("X-User-Agent",a.userAgent);
j.setRequestHeader("X-Content-Type","text/xml");
if(b.indexOf("checkout")==-1){j.setRequestHeader("Accept","application/json")
}}}});
return d
}var XML_NAMESPACE='<ns20:Pick xmlns="http://www.starhub.com/FrontAPI" xmlns:ns20="http://www.starhub.com/FAPI_Shopping" xmlns:ns5="http://www.starhub.com/FAPI_Addresses" xmlns:ns11="http://www.starhub.com/FAPI_OfferTray" ';
function SubscriptionRequestPick(){}SubscriptionRequestPick.prototype.setPickId=function(a){this.pickId=a
};
SubscriptionRequestPick.prototype.setSubscriptionType=function(a){this.subscriptionType=a
};
SubscriptionRequestPick.prototype.setPartNum=function(a){this.partNum=a
};
SubscriptionRequestPick.prototype.setDeviceCategory=function(a){this.deviceCategory=a
};
SubscriptionRequestPick.prototype.setServiceId=function(a){this.serviceId=a
};
SubscriptionRequestPick.prototype.setPlanPartNum=function(a){this.planPartNum=a
};
SubscriptionRequestPick.prototype.setModeOfService=function(a){this.modeOfService=a
};
SubscriptionRequestPick.prototype.setTypeOfPlan=function(a){this.typeOfPlan=a
};
SubscriptionRequestPick.prototype.setBillingAccountId=function(a){this.billingAccountId=a
};
SubscriptionRequestPick.prototype.setBillingAccountNo=function(a){this.billingAccountNo=a
};
SubscriptionRequestPick.prototype.setAddressId=function(a){this.addressId=a
};
SubscriptionRequestPick.prototype.setBlockNo=function(a){this.blockNo=a
};
SubscriptionRequestPick.prototype.setStreet=function(a){this.street=a
};
SubscriptionRequestPick.prototype.setLevel=function(a){this.level=a
};
SubscriptionRequestPick.prototype.setUnit=function(a){this.unit=a
};
SubscriptionRequestPick.prototype.setBuildingName=function(a){this.buildingName=a
};
SubscriptionRequestPick.prototype.setPostalCode=function(a){this.postalCode=a
};
function DevicePick(){}DevicePick.prototype.setPickId=function(a){this.pickId=a
};
DevicePick.prototype.setMainPickId=function(a){this.mainPickId=a
};
DevicePick.prototype.setStockLoc=function(a){this.stockLoc=a
};
DevicePick.prototype.setStockResCode=function(a){this.stockResCode=a
};
DevicePick.prototype.setDeviceName=function(a){this.deviceName=a
};
DevicePick.prototype.setDeviceModel=function(a){this.deviceModel=a
};
DevicePick.prototype.setDeviceCapacity=function(a){this.deviceCapacity=a
};
DevicePick.prototype.setDeviceColor=function(a){this.deviceColor=a
};
DevicePick.prototype.setDeviceCategory=function(a){this.deviceCategory=a
};
DevicePick.prototype.setDeviceType=function(a){this.deviceType=a
};
DevicePick.prototype.setDeviceSubType=function(a){this.deviceSubType=a
};
DevicePick.prototype.setDevicePartNum=function(a){this.devicePartNum=a
};
DevicePick.prototype.setDeviceBrand=function(a){this.deviceBrand=a
};
DevicePick.prototype.setDevicePrice=function(a){this.devicePrice=a
};
DevicePick.prototype.setDeviceStockCode=function(a){this.deviceStockCode=a
};
DevicePick.prototype.setDevicePriceWithOffer=function(a){this.devicePriceWithOffer=a
};
DevicePick.prototype.setPlanPartNum=function(a){this.planPartNum=a
};
DevicePick.prototype.setProductline=function(a){this.productline=a
};
DevicePick.prototype.setCommitmentName=function(a){this.commitmentName=a
};
DevicePick.prototype.setCommitPeriod=function(a){this.commitPeriod=a
};
DevicePick.prototype.setCommitPartNum=function(a){this.commitPartNum=a
};
DevicePick.prototype.setPromoBundlePartNum=function(a){this.promoBundlePartNum=a
};
DevicePick.prototype.setCampaignId=function(a){this.campaignId=a
};
DevicePick.prototype.setPromocode=function(a){this.promocode=a
};
DevicePick.prototype.setPromoPartNumber=function(a){this.promoPartNumber=a
};
DevicePick.prototype.setDeviceStockPartNumber=function(a){this.deviceStockPartNumber=a
};
DevicePick.prototype.setCCCode=function(a){this.ccCode=a
};
function PlanPick(){}PlanPick.prototype.setPickId=function(a){this.pickId=a
};
PlanPick.prototype.setMainPickId=function(a){this.mainPickId=a
};
PlanPick.prototype.setPartNum=function(a){this.partNum=a
};
PlanPick.prototype.setProdName=function(a){this.prodName=a
};
PlanPick.prototype.setProdType=function(a){this.prodType=a
};
PlanPick.prototype.setMRC=function(a){this.MRC=a
};
PlanPick.prototype.setOTC=function(a){this.OTC=a
};
PlanPick.prototype.setIsContainOffer=function(a){this.isContainOffer=a
};
PlanPick.prototype.setCampaignId=function(a){this.campaignId=a
};
PlanPick.prototype.setPromoCode=function(a){this.promoCode=a
};
PlanPick.prototype.setAppliedTo=function(a){this.appliedTo=a
};
PlanPick.prototype.setDiscountName=function(a){this.discountName=a
};
PlanPick.prototype.setDiscValueType=function(a){this.discValueType=a
};
PlanPick.prototype.setDiscValue=function(a){this.discValue=a
};
PlanPick.prototype.setDiscPartNum=function(a){this.discPartNum=a
};
PlanPick.prototype.setCommitmentName=function(a){this.commitmentName=a
};
PlanPick.prototype.setCommitmentPeriod=function(a){this.commitmentPeriod=a
};
PlanPick.prototype.setCommitmentPartNum=function(a){this.commitmentPartNum=a
};
PlanPick.prototype.setRootPartNum=function(a){this.rootPartNum=a
};
PlanPick.prototype.setProdSubType=function(a){this.prodSubType=a
};
function ResourcePick(){}ResourcePick.prototype.setPickId=function(a){this.pickId=a
};
ResourcePick.prototype.setMainPickId=function(a){this.mainPickId=a
};
ResourcePick.prototype.setNumber=function(a){this.number=a
};
ResourcePick.prototype.setIMSI=function(a){this.IMSI=a
};
ResourcePick.prototype.setSIMType=function(a){this.SIMType=a
};
ResourcePick.prototype.setHLR=function(a){if(a!=undefined&&a!=null){this.HLR=a
}else{this.HLR=""
}};
ResourcePick.prototype.setICCID=function(a){if(a!=undefined&&a!=null){this.ICCID=a
}else{this.ICCID=""
}};
function VASPick(){}VASPick.prototype.setPickId=function(a){this.pickId=a
};
VASPick.prototype.setMainPickId=function(a){this.mainPickId=a
};
VASPick.prototype.setPartNum=function(a){this.partNum=a
};
VASPick.prototype.setProdName=function(a){this.prodName=a
};
VASPick.prototype.setProdDisplayName=function(a){this.prodDisplayName=a
};
VASPick.prototype.setProdGroup=function(a){this.prodGroup=a
};
VASPick.prototype.setProdDesc=function(a){this.prodDesc=a
};
VASPick.prototype.setMRC=function(a){this.MRC=a
};
VASPick.prototype.setOTC=function(a){this.OTC=a
};
VASPick.prototype.setRootPartNum=function(a){this.rootPartNum=a
};
VASPick.prototype.setProdType=function(a){this.prodType=a
};
VASPick.prototype.setProdParamGroupType=function(a){this.prodParamGroupType=a
};
VASPick.prototype.setProdParamGroupName=function(a){this.prodParamGroupName=a
};
VASPick.prototype.setCardinal=function(a){this.cardinal=a
};
VASPick.prototype.setMaxValue=function(a){this.maxValue=a
};
VASPick.prototype.setMinValue=function(a){this.minValue=a
};
VASPick.prototype.setProdParamPartNo=function(a){this.prodParamPartNo=a
};
VASPick.prototype.setProdParamName=function(a){this.prodParamName=a
};
VASPick.prototype.setProdParamValue=function(a){this.prodParamValue=a
};
VASPick.prototype.setSelect=function(a){this.select=a
};
function AccessoryPick(){}AccessoryPick.prototype.setPickId=function(a){this.pickId=a
};
AccessoryPick.prototype.setMainPickId=function(a){this.mainPickId=a
};
AccessoryPick.prototype.setStockLoc=function(a){this.stockLoc=a
};
AccessoryPick.prototype.setStockResCode=function(a){this.stockResCode=a
};
AccessoryPick.prototype.setDeviceName=function(a){this.deviceName=a
};
AccessoryPick.prototype.setDeviceModel=function(a){this.deviceModel=a
};
AccessoryPick.prototype.setDeviceCategory=function(a){this.deviceCategory=a
};
AccessoryPick.prototype.setDeviceType=function(a){this.deviceType=a
};
AccessoryPick.prototype.setDeviceSubType=function(a){this.deviceSubType=a
};
AccessoryPick.prototype.setDevicePartNum=function(a){this.devicePartNum=a
};
AccessoryPick.prototype.setDeviceBrand=function(a){this.deviceBrand=a
};
AccessoryPick.prototype.setDevicePrice=function(a){this.devicePrice=a
};
AccessoryPick.prototype.setDeviceStockCode=function(a){this.deviceStockCode=a
};
AccessoryPick.prototype.setDeviceStockPartNumber=function(a){this.deviceStockPartNumber=a
};
function OfferPick(){}OfferPick.prototype.setPickId=function(a){this.pickId=a
};
OfferPick.prototype.setMainPickId=function(a){this.mainPickId=a
};
OfferPick.prototype.setOfferId=function(a){this.offerId=a
};
OfferPick.prototype.setOfferServiceId=function(a){this.offerServiceId=a
};
OfferPick.prototype.setOfferSerialNum=function(a){this.offerSerialNum=a
};
OfferPick.prototype.setOfferType=function(a){this.offerType=a
};
OfferPick.prototype.setOfferStatus=function(a){this.offerStatus=a
};
OfferPick.prototype.setOfferReference=function(a){this.offerReference=a
};
OfferPick.prototype.setPromoType=function(a){this.promoType=a
};
OfferPick.prototype.setTargeted=function(a){this.targeted=a
};
OfferPick.prototype.setName=function(a){this.name=a
};
OfferPick.prototype.setDisplayName=function(a){this.displayName=a
};
OfferPick.prototype.setCode=function(a){this.code=a
};
OfferPick.prototype.setScmId=function(a){this.scmId=a
};
OfferPick.prototype.setCampaignId=function(a){this.campaignId=a
};
OfferPick.prototype.setPriority=function(a){this.priority=a
};
OfferPick.prototype.setWaivePartNum=function(a){this.waivePartNum=a
};
OfferPick.prototype.setWaiveStockCode=function(a){this.waiveStockCode=a
};
OfferPick.prototype.setWaiveValue=function(a){this.waiveValue=a
};
function AppointDetail(){}AppointDetail.prototype.setRefNumber=function(a){this.refNumber=a
};
AppointDetail.prototype.setAppDate=function(a){this.appDate=a
};
AppointDetail.prototype.setTimeBand=function(a){this.timeBand=a
};
function UpdateUserInfo(){}UpdateUserInfo.prototype.setTitle=function(a){this.title=a
};
UpdateUserInfo.prototype.setName=function(a){this.name=a
};
UpdateUserInfo.prototype.setDocType=function(a){this.docType=a
};
UpdateUserInfo.prototype.setDocSubType=function(a){this.docSubType=a
};
UpdateUserInfo.prototype.setGender=function(a){this.gender=a
};
UpdateUserInfo.prototype.setDob=function(a){this.dob=a
};
UpdateUserInfo.prototype.setRace=function(a){this.race=a
};
UpdateUserInfo.prototype.setNationality=function(a){this.nationality=a
};
UpdateUserInfo.prototype.setMobileNo=function(a){this.mobileNo=a
};
UpdateUserInfo.prototype.setHomeNo=function(a){this.homeNo=a
};
UpdateUserInfo.prototype.setRegAddressId=function(a){this.regAddressId=a
};
UpdateUserInfo.prototype.setPDPAOptIn=function(a){this.PDPAOptIn=a
};
UpdateUserInfo.prototype.setPartnerOrgPDPAOptIn=function(a){this.PartnerOrgPDPAOptIn=a
};
function UpdatePDPA(){}UpdatePDPA.prototype.setPDPAOptIn=function(a){this.PDPAOptIn=a
};
UpdatePDPA.prototype.setPartnerOrgPDPAOptIn=function(a){this.PartnerOrgPDPAOptIn=a
};
function DeliveryAddress(){}DeliveryAddress.prototype.setAddressId=function(a){this.addressId=a
};
DeliveryAddress.prototype.setBlockNo=function(a){this.blockNo=a
};
DeliveryAddress.prototype.setStreet=function(a){this.street=a
};
DeliveryAddress.prototype.setLevel=function(a){this.level=a
};
DeliveryAddress.prototype.setUnit=function(a){this.unit=a
};
DeliveryAddress.prototype.setPostalCode=function(a){this.postalCode=a
};
function HubclubDiscountPick(){}HubclubDiscountPick.prototype.setPartNum=function(a){this.partNum=a
};
HubclubDiscountPick.prototype.setMainPickId=function(a){this.mainPickId=a
};
function getSubscriptionRequestPickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a+=XML_NAMESPACE+">"
}else{a+=XML_NAMESPACE+'id="'+b.pickId+'">'
}a+='<ns20:Subscription type="'+b.subscriptionType+'">';
a+="<RootPartNum>MOBL-10001</RootPartNum>";
a+="<PartNum>"+b.partNum+"</PartNum>";
a+="<DeviceCategory>"+b.deviceCategory+"</DeviceCategory>";
a+="<Contract>";
if(b.subscriptionType==="existing"){a+="<ServiceId>"+b.serviceId+"</ServiceId>"
}a+="<PlanPartNum>"+b.planPartNum+"</PlanPartNum>";
a+="<ContractParams>";
a+="<ServiceParam>";
a+="<SvcParamName>Mode of Service</SvcParamName>";
a+="<SvcParamValue>"+b.modeOfService+"</SvcParamValue>";
a+="</ServiceParam>";
a+="<ServiceParam>";
a+="<SvcParamName>Type of Plan</SvcParamName>";
a+="<SvcParamValue>"+b.typeOfPlan+"</SvcParamValue>";
a+="</ServiceParam>";
a+="</ContractParams>";
a+="</Contract>";
if(b.billingAccountId||b.billingAccountNo||b.addressId){a+="<BillingAccount>";
if(b.billingAccountId){a+="<BillingAccountId>"+b.billingAccountId+"</BillingAccountId>"
}if(b.billingAccountNo){a+="<BillingAccountNo>"+b.billingAccountNo+"</BillingAccountNo>"
}if(b.addressId){a+="<BillingAddress>";
a+="<ns5:AddressId>"+b.addressId+"</ns5:AddressId>";
if(b.blockNo){a+="<ns5:BlockNo>"+b.blockNo+"</ns5:BlockNo>"
}if(b.street){a+="<ns5:Street>"+b.street+"</ns5:Street>"
}if(b.level){a+="<ns5:Level>"+b.level+"</ns5:Level>"
}if(b.unit){a+="<ns5:Unit>"+b.unit+"</ns5:Unit>"
}if(b.buildingName){a+="<ns5:BuildingName>"+b.buildingName+"</ns5:BuildingName>"
}if(b.postalCode){a+="<ns5:PostalCode>"+b.postalCode+"</ns5:PostalCode>"
}a+="</BillingAddress>";
a+="<BillDeliveryMethod>Hard Copy</BillDeliveryMethod>";
a+="<PaymentProfile><PaymentMethod>Cash</PaymentMethod></PaymentProfile>"
}a+="</BillingAccount>"
}a+="</ns20:Subscription>";
a+="</ns20:Pick>";
return a
}function getDevicePickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId="'+b.mainPickId+'">'
}else{a+=XML_NAMESPACE+'id="'+b.pickId+'" mainPickId="'+b.mainPickId+'">'
}a+='<Device issuance="buy">';
a+="<DeviceName>"+b.deviceName+"</DeviceName>";
a+="<DeviceModel>"+b.deviceModel+"</DeviceModel>";
a+="<DeviceCategory>"+b.deviceCategory+"</DeviceCategory>";
a+="<DeviceType>"+b.deviceType+"</DeviceType>";
a+="<DeviceSubType>"+b.deviceSubType+"</DeviceSubType>";
a+="<DevicePartNum>"+b.devicePartNum+"</DevicePartNum>";
a+="<DeviceBrand>"+b.deviceBrand+"</DeviceBrand>";
a+="<DevicePrice>"+b.devicePrice+"</DevicePrice>";
a+="<DeviceFeatures>";
a+="<LoV>";
a+='<Value key="FEATURE_STORAGE_INTERNAL" hint="Internal Storage">'+b.deviceCapacity+"</Value>";
a+="</LoV>";
a+="</DeviceFeatures>";
a+="<DeviceVariants>";
a+="<DeviceVariant>";
a+="<DeviceStockCode>"+b.deviceStockCode+"</DeviceStockCode>";
a+="<DeviceStockPartNumber>"+b.deviceStockPartNumber+"</DeviceStockPartNumber>";
a+="<LoV>";
a+='<Value key="FEATURE_COLOR" hint="Color">'+b.deviceColor+"</Value>";
a+="</LoV>";
a+="</DeviceVariant>";
a+="</DeviceVariants>";
a+="<DeviceOffers>";
a+='<deviceOffer partnumber="'+b.devicePartNum+'">';
a+="<devicePrice>"+b.devicePriceWithOffer+"</devicePrice>";
a+='<planPartNum productline="'+b.productline+'">'+b.planPartNum+"</planPartNum>";
a+="<commitment>";
a+="<name>"+b.commitmentName+"</name>";
a+="<commitPeriod>"+b.commitPeriod+"</commitPeriod>";
a+="<commitPartNum>"+b.commitPartNum+"</commitPartNum>";
a+="<promoBundlePartNum>"+b.promoBundlePartNum+"</promoBundlePartNum>";
a+="</commitment>";
a+="<campaignId>"+b.campaignId+"</campaignId>";
a+="<promoCode>"+b.promocode+"</promoCode>";
a+="<promoPartNumber>"+b.promoPartNumber+"</promoPartNumber>";
a+="<ccCode>"+b.ccCode+"</ccCode>";
a+="</deviceOffer>";
a+="</DeviceOffers>";
a+="</Device>";
a+="</ns20:Pick>";
return a
}function getAccessoryPickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId="'+b.mainPickId+'">'
}else{a+=XML_NAMESPACE+'id="'+b.pickId+'" mainPickId="'+b.mainPickId+'">'
}a+='<Device issuance="buy">';
a+="<DeviceName>"+b.deviceName+"</DeviceName>";
a+="<DeviceModel>"+b.deviceModel+"</DeviceModel>";
a+="<DeviceCategory>"+b.deviceCategory+"</DeviceCategory>";
a+="<DeviceType>"+b.deviceType+"</DeviceType>";
a+="<DeviceSubType>"+b.deviceSubType+"</DeviceSubType>";
a+="<DevicePartNum>"+b.devicePartNum+"</DevicePartNum>";
a+="<DeviceBrand>"+b.deviceBrand+"</DeviceBrand>";
a+="<DevicePrice>"+b.devicePrice+"</DevicePrice>";
a+="<DeviceVariants>";
a+="<DeviceVariant>";
a+="<DeviceStockCode>"+b.deviceStockCode+"</DeviceStockCode>";
a+="<DeviceStockPartNumber>"+b.deviceStockPartNumber+"</DeviceStockPartNumber>";
a+="</DeviceVariant>";
a+="</DeviceVariants>";
a+="<DeviceOffers/>";
a+="</Device>";
a+="</ns20:Pick>";
return a
}function getPlanPickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId="'+b.mainPickId+'">'
}else{a+=XML_NAMESPACE+'id="'+b.pickId+'" mainPickId="'+b.mainPickId+'">'
}a+="<Product>";
a+="<PartNum>"+b.partNum+"</PartNum>";
a+="<ProdName>"+b.prodName+"</ProdName>";
a+="<ProdType>"+b.prodType+"</ProdType>";
a+="<MRC>"+b.MRC+"</MRC>";
a+="<RootPartNum>"+b.rootPartNum+"</RootPartNum>";
a+="<ProdSubType>"+b.prodSubType+"</ProdSubType>";
if(b.isContainOffer){a+="<CommercialOffers>";
a+="<commercialOffer>";
a+="<campaignId>"+b.campaignId+"</campaignId>";
a+="<promoCode>"+b.promoCode+"</promoCode>";
a+='<discount appliedTo="'+b.appliedTo+'">';
a+="<name>"+b.discountName+"</name>";
a+='<discValue type="'+b.discValueType+'">'+b.discValue+"</discValue>";
a+="<discPartNum>"+b.discPartNum+"</discPartNum>";
a+="</discount>";
a+="<commitment>";
a+="<name>"+b.commitmentName+"</name>";
a+="<commitPeriod>"+b.commitmentPeriod+"</commitPeriod>";
a+="<commitPartNum>"+b.commitmentPartNum+"</commitPartNum>";
a+="</commitment>";
a+="<Select>true</Select>";
a+="</commercialOffer>";
a+="</CommercialOffers>"
}a+='<Select suppress="off">true</Select>';
a+="</Product>";
a+="</ns20:Pick>";
return a
}function getResourcePickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId="'+b.mainPickId+'">'
}else{a+=XML_NAMESPACE+'id="'+b.pickId+'" mainPickId="'+b.mainPickId+'">'
}a+="<Resource>";
a+="<msisdnInfo>";
a+="<number>"+b.number+"</number>";
a+="<SIMType>"+b.SIMType+"</SIMType>";
if(b.ISMI!=null&&b.ISMI!=undefined){a+="<ISMI>"+b.IMSI+"</ISMI>"
}if(b.HLR!=undefined&&b.HLR!=""){a+="<HLR>"+b.HLR+"</HLR>"
}if(b.ICCID!=undefined&&b.ICCID!=""){a+="<ICCID>"+b.ICCID+"</ICCID>"
}a+="</msisdnInfo>";
a+="</Resource>";
a+="</ns20:Pick>";
return a
}function getVASPickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId = "'+b.mainPickId+'" > '
}else{a+=XML_NAMESPACE+'id = "'+b.pickId+'" mainPickId = "'+b.mainPickId+'" > '
}a+="<Product>";
a+="<PartNum>"+b.partNum+"</PartNum>";
a+="<ProdName>"+b.prodName+"</ProdName> ";
a+="<ProdDisplayName>"+b.prodDisplayName+"</ProdDisplayName>";
a+="<ProdGroup>"+b.prodGroup+"</ProdGroup>";
a+="<ProdDesc>"+b.prodDesc+"</ProdDesc>";
a+="<MRC>"+b.MRC+"</MRC>";
a+="<OTC>"+b.OTC+"</OTC>";
a+="<RootPartNum>"+b.rootPartNum+"</RootPartNum>";
a+=" <ProdType>"+b.prodType+"</ProdType>";
if(b.prodParamGroupName!=undefined){a+="<ProductParams>";
a+='<ProdParamGroup type="'+b.prodParamGroupType+'" name="'+b.prodParamGroupName+'">';
a+='<ProductParam cardinal="'+b.cardinal+'" maxValue="'+b.maxValue+'" minValue="'+b.minValue+'">';
a+="<ProdParamPartNo>"+b.prodParamPartNo+"</ProdParamPartNo>";
a+="<ProdParamName>"+b.prodParamName+"</ProdParamName>";
a+="<ProdParamValue>"+b.prodParamValue+"</ProdParamValue>";
a+="</ProductParam>";
a+="</ProdParamGroup>";
a+="</ProductParams>"
}a+='<Select suppress="off">'+b.select+"</Select>";
a+="</Product>";
a+="</ns20:Pick>";
return a
}function getOfferPickMessage(b){var a="";
if(b.pickId==""||b.pickId==undefined||b.pickId==null){a=XML_NAMESPACE+' mainPickId = "'+b.mainPickId+'" > '
}else{a+=XML_NAMESPACE+'id = "'+b.pickId+'" mainPickId = "'+b.mainPickId+'" > '
}a+=" <ns11:Offer>";
a+=" <ns11:OfferId>"+b.offerId+"</ns11:OfferId>";
a+="<ns11:OfferSerialNum>"+b.offerSerialNum+"</ns11:OfferSerialNum>";
a+="<ns11:OfferServiceId>"+b.offerServiceId+"</ns11:OfferServiceId> ";
a+="<ns11:OfferType>"+b.offerType+"</ns11:OfferType>";
a+="<ns11:OfferStatus>"+b.offerStatus+"</ns11:OfferStatus>";
a+="<ns11:OfferReference>"+b.offerReference+"</ns11:OfferReference>";
a+="<promo>";
a+="<promoType>"+b.promoType+"</promoType>";
a+="<promoCategory>"+b.targeted+"</promoCategory>";
a+="<name>"+b.name+"</name>";
a+="<displayName>"+b.displayName+"</displayName>";
a+="<code>"+b.code+"</code>";
a+="<scmId>"+b.scmId+"</scmId>";
a+="<campaignId>"+b.campaignId+"</campaignId>";
a+="<priority>"+b.priority+"</priority>";
a+="<DeviceOffers>";
a+="<deviceOffer>";
a+="<waiver>";
a+="<waiveValue>"+b.waiveValue+"</waiveValue>";
a+="<waivePartNum>"+b.waivePartNum+"</waivePartNum>";
a+="<waiveStockCode>"+b.waiveStockCode+"</waiveStockCode>";
a+="</waiver>";
a+="</deviceOffer>";
a+="</DeviceOffers>";
a+="</promo>";
a+="</ns11:Offer>";
a+="</ns20:Pick>";
return a
}function getCheckoutMsgForBillRebate(a){return'<CheckoutInfo cartNumber="'+a+'" xsi:schemaLocation="http://www.starhub.com/FAPI_Shopping FAPI_Shopping.xsd"  xmlns="http://www.starhub.com/FAPI_Shopping" xmlns:addr="http://www.starhub.com/FAPI_Addresses"  xmlns:shop="http://www.starhub.com/fapi/shop/models" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"></CheckoutInfo>'
}function getCheckoutMsgForZeroPhone(c,b,a){return'<CheckoutInfo cartNumber="'+c+'" xsi:schemaLocation="http://www.starhub.com/FAPI_Shopping FAPI_Shopping.xsd"  xmlns="http://www.starhub.com/FAPI_Shopping" xmlns:addr="http://www.starhub.com/FAPI_Addresses"  xmlns:shop="http://www.starhub.com/fapi/shop/models" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <CollectionInfo type="delivery"> <shop:AppointDetail refNumber="'+b.refNumber+'"> <shop:OutletId>'+MOBILE_ESHOP_OUTLETID+"</shop:OutletId> <shop:AppDate>"+b.appDate+"</shop:AppDate>  <shop:TimeBand>"+b.timeBand+"</shop:TimeBand>  </shop:AppointDetail> <shop:DeliveryAddress> <addr:AddressId>"+a.addressId+"</addr:AddressId> <addr:BlockNo>"+a.blockNo+"</addr:BlockNo> <addr:Street>"+a.street+"</addr:Street> <addr:Level>"+a.level+"</addr:Level> <addr:Unit>"+a.unit+"</addr:Unit> <addr:PostalCode>"+a.postalCode+"</addr:PostalCode> </shop:DeliveryAddress> </CollectionInfo> <PaymentInfo>  <shop:PaymentRef></shop:PaymentRef>  <shop:TotalPaid>0.0</shop:TotalPaid>  <shop:CardType></shop:CardType>  </PaymentInfo>  </CheckoutInfo>"
}function getHubIdAuthTokenRequestMsg(a,c,b){return'<CustomerInfo xmlns:ns5="http://www.starhub.com/FAPI_Addresses" xmlns="http://www.starhub.com/FrontAPI"><DocNo>'+a+"</DocNo>	<DocType>"+c+"</DocType>	<DoB>"+b+"</DoB></CustomerInfo>"
}function getUpdateCustInfoMsg(b){var a="";
a+='<CustomerInfo xmlns="http://www.starhub.com/FrontAPI" xmlns:ns16="http://www.starhub.com/bss/eai/schema/udm/billingaccount" xmlns:ns17="http://www.starhub.com/bss/eai/schema/udm/customer" xmlns:ns14="http://www.starhub.com/bss/eai/schema/udm/asset" xmlns:ns15="http://www.starhub.com/bss/eai/schema/udm/common" xmlns:ns18="http://www.starhub.com/bss/eai/schema/udm/hubaccount" xmlns:ns19="http://www.starhub.com/bss/eai/schema/udm/header" xmlns:ns9="http://www.starhub.com/FAPI_Logins" xmlns:ns21="http://www.starhub.com/OTP" xmlns:ns12="http://www.starhub.com/FAPI_Kiosk" xmlns:ns5="http://www.starhub.com/FAPI_Addresses" xmlns:ns6="http://www.starhub.com/CQ_Partners" xmlns:ns13="http://www.starhub.com/fapi/shop/models" xmlns:ns10="http://www.starhub.com/FAPI_Usage" xmlns:ns7="http://www.starhub.com/CQ_Roaming" xmlns:ns11="http://www.starhub.com/FAPI_OfferTray" xmlns:ns20="http://www.starhub.com/FAPI_Shopping" xmlns:ns2="http://www.starhub.com/bdms/schema/common/facts" xmlns:ns4="http://www.starhub.com/FAPI_Outlets" xmlns:ns3="http://www.starhub.com/CQ_IDD">';
a+="	 <Title>"+b.title+"</Title>";
a+="  <Name>"+b.name+"</Name>";
a+="  <DocSubType>"+b.docSubType+"</DocSubType>";
a+="  <Gender>"+b.gender+"</Gender>";
a+="  <DoB>"+b.dob+"</DoB>";
a+="  <Race>"+b.race+"</Race>";
a+="  <Nationality>"+b.nationality+"</Nationality>";
a+="    <Category>Consumer</Category>";
a+="    <SubCategory>Regular</SubCategory>";
a+="<ContactInfo>";
a+="     <MobileNo>"+b.mobileNo+"</MobileNo>";
a+="        <HomeNo>"+b.homeNo+"</HomeNo>";
a+="        <RegisteredAddress>";
a+="  <ns5:AddressId>"+b.regAddressId+"</ns5:AddressId>";
a+="        </RegisteredAddress>";
a+="      </ContactInfo>";
a+=" </CustomerInfo>";
return a
}function getUpdataCustInfoMsgForPDPA(b){var a="";
a+='<CustomerInfo xmlns="http://www.starhub.com/FrontAPI" xmlns:ns16="http://www.starhub.com/bss/eai/schema/udm/billingaccount" xmlns:ns17="http://www.starhub.com/bss/eai/schema/udm/customer" xmlns:ns14="http://www.starhub.com/bss/eai/schema/udm/asset" xmlns:ns15="http://www.starhub.com/bss/eai/schema/udm/common" xmlns:ns18="http://www.starhub.com/bss/eai/schema/udm/hubaccount" xmlns:ns19="http://www.starhub.com/bss/eai/schema/udm/header" xmlns:ns9="http://www.starhub.com/FAPI_Logins" xmlns:ns21="http://www.starhub.com/OTP" xmlns:ns12="http://www.starhub.com/FAPI_Kiosk" xmlns:ns5="http://www.starhub.com/FAPI_Addresses" xmlns:ns6="http://www.starhub.com/CQ_Partners" xmlns:ns13="http://www.starhub.com/fapi/shop/models" xmlns:ns10="http://www.starhub.com/FAPI_Usage" xmlns:ns7="http://www.starhub.com/CQ_Roaming" xmlns:ns11="http://www.starhub.com/FAPI_OfferTray" xmlns:ns20="http://www.starhub.com/FAPI_Shopping" xmlns:ns2="http://www.starhub.com/bdms/schema/common/facts" xmlns:ns4="http://www.starhub.com/FAPI_Outlets" xmlns:ns3="http://www.starhub.com/CQ_IDD">';
a+="  <PDPAOptIn>"+b.PDPAOptIn+"</PDPAOptIn>";
a+="  <PartnerOrgPDPAOptIn>"+b.PartnerOrgPDPAOptIn+"</PartnerOrgPDPAOptIn>";
a+=" </CustomerInfo>";
return a
}function getUpdatePDPAMsg(b){var a="";
a+='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';
a+='<ns8:Request xmlns="http://www.starhub.com/FrontAPI" xmlns:ns16="http://www.starhub.com/bss/eai/schema/udm/billingaccount" xmlns:ns17="http://www.starhub.com/bss/eai/schema/udm/customer" xmlns:ns14="http://www.starhub.com/bss/eai/schema/udm/asset" xmlns:ns15="http://www.starhub.com/bss/eai/schema/udm/common" xmlns:ns18="http://www.starhub.com/bss/eai/schema/udm/hubaccount" xmlns:ns19="http://www.starhub.com/bss/eai/schema/udm/header" xmlns:ns9="http://www.starhub.com/FAPI_Logins" xmlns:ns21="http://www.starhub.com/OTP" xmlns:ns12="http://www.starhub.com/FAPI_Kiosk" xmlns:ns5="http://www.starhub.com/FAPI_Addresses" xmlns:ns6="http://www.starhub.com/CQ_Partners" xmlns:ns13="http://www.starhub.com/fapi/shop/models" xmlns:ns10="http://www.starhub.com/FAPI_Usage" xmlns:ns7="http://www.starhub.com/CQ_Roaming" xmlns:ns11="http://www.starhub.com/FAPI_OfferTray" xmlns:ns8="http://www.starhub.com/FAPI_Request" xmlns:ns20="http://www.starhub.com/FAPI_Shopping" xmlns:ns2="http://www.starhub.com/bdms/schema/common/facts" xmlns:ns4="http://www.starhub.com/FAPI_Outlets" xmlns:ns3="http://www.starhub.com/CQ_IDD">';
a+="<CustomerInfo>";
a+="<PDPAOptIn>"+b.PDPAOptIn+"</PDPAOptIn>";
a+="<PartnerOrgPDPAOptIn>"+b.PartnerOrgPDPAOptIn+"</PartnerOrgPDPAOptIn>";
a+="</CustomerInfo>";
a+="</ns8:Request>";
return a
}function getHubclubDiscountPickMsg(b){var a='<ns20:Pick mainPickId="'+b.mainPickId+'" xmlns="http://www.starhub.com/FrontAPI"  xmlns:ns20="http://www.starhub.com/FAPI_Shopping"><Product><PartNum>'+b.partNum+'</PartNum><RootPartNum>MOBL-10001</RootPartNum><CommercialOffers><commercialOffer><waiver><name>hubcluberfdiscount</name><waiveValue type="abs">200</waiveValue></waiver></commercialOffer></CommercialOffers></Product></ns20:Pick>';
return a
}var mobileService=mobileService||{};
mobileService.CONSTANTS={OSKEY:"FEATURE_OPERATING_SYSTEM",KEY_FEATURE_INDICATOR:"KEY-FEATURE",FEATURE_PHONE_INDICATOR:"TOP_SELLER",NORMAL_FEATURE_INDICATOR:"FEATURE_",HANDSET_RELEASE_DATE_KEY:"RELEASE_DATE",IMAGE_FRONT_HINT:"front",IMAGE_KEY:"PRODUCT_IMAGE",DEVICE_LOWEST_PRICE_KEY:"AS-LOW-AS",USERINFO_SUBCATEGORY:{VIP:"vip",VVIP:"vvip"}};
mobileService.vars={session_has_start:false,under_resizing:false,reset_session_timeout:true,otherErrorBeingThrowing:false,idle_settings:{tid:0,duration:7200000,events:"mousemove keypress mousedown",onIdel:mobileService.sessionTimeoutPop}};
if(typeof Object.size!=="function"){Object.size=function(c){var b=0,a;
for(a in c){if(c.hasOwnProperty(a)){b++
}}return b
}
}if(typeof Object.create!=="function"){Object.create=function(b){var a=function(){};
a.prototype=b;
return new a()
}
}mobileService.log=function(a){if(typeof console!="undefined"&&console&&console.log){console.log(a)
}else{}};
mobileService.triggerWindowResize=function(){if(!mobileService.under_resizing){mobileService.under_resizing=true;
setTimeout(function(){mobileService.under_resizing=false;
_SH.Elements.$w.triggerHandler("resize")
},500)
}};
mobileService.sesstionStartTimeout=function(b,c){if(c!=undefined){clearTimeout(c)
}var a=setTimeout(function(){mobileService.sessionTimeoutPop()
},b.duration);
return a
};
mobileService.sessionTimeoutPop=function(){$(document).off(mobileService.vars.idle_settings.events,mobileService.triggerSesstionTimeoutReset);
mobileService.vars.session_has_start=false;
var a={};
a.failmsg=onlinestore.MSG.SESSION_TIME_OUT;
a.yesButton=true;
a.yesButtonUrl="javascript:renewSession()";
a.noButton=true;
a.noButtonUrl=baseUrl.browse;
a.overlayClose=false;
a.escKey=false;
a.closeButton=false;
throwError(a)
};
mobileService.startSessionTimeout=function(){mobileService.vars.idle_settings.tid=mobileService.sesstionStartTimeout(mobileService.vars.idle_settings,mobileService.vars.idle_settings.tid)
};
mobileService.triggerSesstionTimeoutReset=function(){if(mobileService.vars.reset_session_timeout){mobileService.vars.reset_session_timeout=false;
setTimeout(function(){mobileService.vars.reset_session_timeout=true;
mobileService.startSessionTimeout()
},1000)
}};
function startSession(){ajaxService.updateBasketSideBar()
}function startSessionTimer(){if(!mobileService.vars.session_has_start){mobileService.vars.session_has_start=true;
mobileService.vars.idle_settings.tid=mobileService.sesstionStartTimeout(mobileService.vars.idle_settings);
$(document).on(mobileService.vars.idle_settings.events,mobileService.triggerSesstionTimeoutReset)
}}function renewSession(){stopColorbox();
startSession()
}function getBillingAccountFromBilling(a){if(a.mainContext&&a.mainContext.present&&a.mainContext.present.any&&a.mainContext.present.any[0].billingAccount){return a.mainContext.present.any[0].billingAccount
}else{return[]
}}function getBillingAccountFromBasket(c){if(c.mainContext&&c.mainContext.present&&c.mainContext.present.any&&c.mainContext.present.any[0].pick){var b=c.mainContext.present.any[0].pick;
for(var a=0;
a<b.length;
a++){if(b[a].subscription&&b[a].subscription.billingAccount&&b[a].subscription.billingAccount.billingAccountId&&b[a].subscription.billingAccount.billingAccountNo){return[{billingAccountId:b[a].subscription.billingAccount.billingAccountId,billingAccountNo:b[a].subscription.billingAccount.billingAccountNo}]
}else{if(b[a].subscription&&b[a].subscription.billingAccount&&b[a].subscription.billingAccount.billingAddress){return[{billingAddress:b[a].subscription.billingAccount.billingAddress}]
}}}return[]
}return[]
}function requestLogin(){var a=window.location.pathname;
var c=a.substring(a.lastIndexOf("/"),a.length);
var b=a.substring(0,a.lastIndexOf("/"))+c.substring(0,c.indexOf("."));
$.colorbox($.extend({},{href:b+"/.login.html?cburl="+a,scrolling:false,open:true},_SH.ColorBox))
}function startWebChat(){var a={};
if(typeof window.screenX!="undefined"){a.top=window.screenY;
a.left=window.screenX
}else{if(typeof window.screenLeft!="undefined"){a.top=window.screenTop;
a.left=window.screenLeft
}}a.left=a.left+$(window).width()-66-415;
window.open(WEBCHAT_URL,"_blank","width=415,height=725,location=no,titlebar=yes,menubar=no,status=yes,resizeable=yes,scrollbars=yes,top="+a.top+",left="+a.left);
$(".button-personal-contact-us.has-quick-pane").click()
}function requestLogin(e,b){var a=window.location.pathname;
var d=a.substring(a.lastIndexOf("/"),a.length);
var c=a.substring(0,a.lastIndexOf("/"))+d.substring(0,d.indexOf("."));
if(!e||!e.length){e=a
}if(!b||!b.length){b=a
}$.colorbox($.extend({},{href:c+"/.login.html?cberrorurl="+e+"&cburl="+b,scrolling:false,open:true},_SH.ColorBox))
}function phoneNumberToString(a){if(a.length!==8||!a){return a
}return a.substr(0,4)+" "+a.substr(4,4)
}function addParamToUrl(b,c,d){var a=b;
if(b!=null&&c!=null&&d!=null&&typeof c==="string"&&typeof b==="string"){a+="&";
a+=escapeParam(c);
a+="=";
a+=escapeParam(d)
}return a
}function genDateStringFromObj(b){if(b===null||b==undefined||b==""){return""
}else{var c=b.year;
var d=getMonthObjFromNumber(b.month);
var a=b.day;
return a+" "+d+" "+c
}}function getMonthObjFromNumber(a){switch(a){case 1:return"January";
case 2:return"February";
case 3:return"March";
case 4:return"April";
case 5:return"May";
case 6:return"June";
case 7:return"July";
case 8:return"August";
case 9:return"September";
case 10:return"October";
case 11:return"November";
case 12:return"December";
default:return a
}}function isItemInArray(c,d){for(var b=0,a=d.length;
b<a;
b++){if(c==d[b]){return true
}}return false
}function pushDiff(b,a){if($.inArray(a,b)<0){b.push(a);
return 1
}return 0
}function groupDevice(d){if(!d){return{}
}var n={};
var a="";
var q=0;
var p={};
for(var m=0;
m<d.length;
m++){p=d[m];
a=p.deviceBrand+";"+p.deviceModel;
if(n[a]!=undefined){if(n[a].deviceCheapestPrice>p.devicePrice){n[a].deviceCheapestPrice=p.devicePrice;
n[a].deviceCheapestPlan=""
}if(checkPhoneFeatures(p)){for(var h=0;
h<p.deviceFeatures.loV.value.length;
h++){var l=p.deviceFeatures.loV.value[h];
if(l.key===mobileService.CONSTANTS.OSKEY){if(n[a].deviceOS!==l.value){}}else{if(l.key===mobileService.CONSTANTS.DEVICE_LOWEST_PRICE_KEY){if(n[a].deviceCheapestPrice>parseFloat(l.value)){n[a].deviceCheapestPrice=parseFloat(l.value);
n[a].deviceCheapestPlan=""
}}}if(l.key.indexOf(mobileService.CONSTANTS.KEY_FEATURE_INDICATOR)>=0){pushDiff(n[a].deviceKeyFeatureList,l.value);
if(n[a].deviceGroupedKeyFeatureList[l.key]){pushDiff(n[a].deviceGroupedKeyFeatureList[l.key],l.value);
pushDiff(n[a].deviceGroupedKeyFeatureHintList[l.key],l.hint)
}else{n[a].deviceGroupedKeyFeatureList[l.key]=[];
n[a].deviceGroupedKeyFeatureHintList[l.key]=[];
pushDiff(n[a].deviceGroupedKeyFeatureList[l.key],l.value);
pushDiff(n[a].deviceGroupedKeyFeatureHintList[l.key],l.hint)
}}else{if(l.key.indexOf(mobileService.CONSTANTS.FEATURE_PHONE_INDICATOR)>=0){if(!n[a].deviceIsFeaturePhone){if(typeof l.value==="string"){n[a].deviceIsFeaturePhone=($.trim(l.value).toLowerCase()==="true")
}else{n[a].deviceIsFeaturePhone=l.value
}}}else{if(l.key.indexOf(mobileService.CONSTANTS.NORMAL_FEATURE_INDICATOR)>=0){if(n[a].deviceFeatures&&n[a].deviceFeatures[l.key]!=undefined){pushDiff(n[a].deviceFeatures[l.key],l.value);
pushDiff(n[a].deviceFeaturesHint[l.key],l.hint)
}else{n[a].deviceFeatures[l.key]=[l.value];
n[a].deviceFeaturesHint[l.key]=[l.hint]
}}}}}}if(checkPhoneVariants(p)){for(var h=0;
h<p.deviceVariants.deviceVariant.length;
h++){var g=p.deviceVariants.deviceVariant[h];
if(g.loV&&g.loV.value){var e=getDefaultImage(g);
for(var f=0;
f<g.loV.value.length;
f++){if(g.loV.value[f].key===mobileService.CONSTANTS.HANDSET_RELEASE_DATE_KEY){var c=g.loV.value[f].value;
if(c.length>=10){var b=c.substr(3,2)+"/"+c.substr(0,2)+"/"+c.substr(6,4);
var o=(new Date(b)).getTime();
if(n[a].deviceReleaseDate<o){n[a].deviceReleaseDate=o;
if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT)||(e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}else{if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT)&&(e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}}}else{if(n[a].deviceReleaseDate<=0){if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT&&e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)||n[a].deviceMainImageHint===""){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}}}}}}n[a].deviceOriginalIndexes.push(p)
}else{n[a]={};
n[a].deviceIndex=q;
q=q+1;
n[a].deviceKeyFeatureList=[];
n[a].deviceGroupedKeyFeatureList={};
n[a].deviceGroupedKeyFeatureHintList={};
n[a].deviceFeatures={};
n[a].deviceFeaturesHint={};
n[a].deviceOfferList=[];
n[a].deviceIsFeaturePhone=false;
n[a].deviceIsLessFeaturePhone=false;
n[a].deviceReleaseDate=-1;
n[a].deviceMainImage="";
n[a].deviceMainImageHint="";
n[a].deviceTempOfferList={};
n[a].deviceBrand=p.deviceBrand;
n[a].deviceModel=p.deviceModel;
n[a].deviceCheapestPrice=p.devicePrice;
n[a].deviceCheapestPlan="";
if(checkPhoneFeatures(p)){for(var h=0;
h<p.deviceFeatures.loV.value.length;
h++){var l=p.deviceFeatures.loV.value[h];
if(l.key===mobileService.CONSTANTS.OSKEY){n[a].deviceOS=l.value
}else{if(l.key===mobileService.CONSTANTS.DEVICE_LOWEST_PRICE_KEY){if(n[a].deviceCheapestPrice>parseFloat(l.value)){n[a].deviceCheapestPrice=parseFloat(l.value);
n[a].deviceCheapestPlan=""
}}}if(l.key.indexOf(mobileService.CONSTANTS.KEY_FEATURE_INDICATOR)>=0){pushDiff(n[a].deviceKeyFeatureList,l.value);
if(n[a].deviceGroupedKeyFeatureList[l.key]){pushDiff(n[a].deviceGroupedKeyFeatureList[l.key],l.value);
pushDiff(n[a].deviceGroupedKeyFeatureHintList[l.key],l.hint)
}else{n[a].deviceGroupedKeyFeatureList[l.key]=[];
n[a].deviceGroupedKeyFeatureHintList[l.key]=[];
pushDiff(n[a].deviceGroupedKeyFeatureList[l.key],l.value);
pushDiff(n[a].deviceGroupedKeyFeatureHintList[l.key],l.hint)
}}else{if(l.key.indexOf(mobileService.CONSTANTS.FEATURE_PHONE_INDICATOR)>=0){if(typeof l.value==="string"){n[a].deviceIsFeaturePhone=($.trim(l.value).toLowerCase()==="true")
}else{n[a].deviceIsFeaturePhone=l.value
}}else{if(l.key.indexOf(mobileService.CONSTANTS.NORMAL_FEATURE_INDICATOR)>=0){if(n[a].deviceFeatures&&n[a].deviceFeatures[l.key]!=undefined){pushDiff(n[a].deviceFeatures[l.key],l.value);
pushDiff(n[a].deviceFeaturesHint[l.key],l.hint)
}else{n[a].deviceFeatures[l.key]=[l.value];
n[a].deviceFeaturesHint[l.key]=[l.hint]
}}}}}}if(checkPhoneVariants(p)){for(var h=0;
h<p.deviceVariants.deviceVariant.length;
h++){var g=p.deviceVariants.deviceVariant[h];
if(g.loV&&g.loV.value){var e=getDefaultImage(g);
for(var f=0;
f<g.loV.value.length;
f++){if(g.loV.value[f].key===mobileService.CONSTANTS.HANDSET_RELEASE_DATE_KEY){var c=g.loV.value[f].value;
if(c.length>=10){var b=c.substr(3,2)+"/"+c.substr(0,2)+"/"+c.substr(6,4);
var o=(new Date(b)).getTime();
if(n[a].deviceReleaseDate<o){n[a].deviceReleaseDate=o;
if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT)||(e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}else{if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT)&&(e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}}}else{if(n[a].deviceReleaseDate<=0){if((n[a].deviceMainImageHint.toLowerCase()!==mobileService.CONSTANTS.IMAGE_FRONT_HINT&&e.hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT)||n[a].deviceMainImageHint===""){n[a].deviceMainImage=e.url;
n[a].deviceMainImageHint=e.hint
}}}}}}}n[a].deviceOriginalIndexes=[p]
}}return n
}function getDefaultImage(b){var c={url:"",hint:""};
if(b.deviceImages&&b.deviceImages.loV&&b.deviceImages.loV.value){for(var a=0;
a<b.deviceImages.loV.value.length;
a++){if(b.deviceImages.loV.value[a].hint.toLowerCase()===mobileService.CONSTANTS.IMAGE_FRONT_HINT){c.url=b.deviceImages.loV.value[a].value;
c.hint=b.deviceImages.loV.value[a].hint
}else{if(a===0&&c.url===""){c.url=b.deviceImages.loV.value[a].value;
c.hint=b.deviceImages.loV.value[a].hint
}}}}return c
}function checkPhoneFeatures(a){if(a.deviceFeatures&&a.deviceFeatures.loV&&a.deviceFeatures.loV.value){return true
}else{return false
}}function checkPhoneVariants(a){if(a.deviceVariants&&a.deviceVariants.deviceVariant){return true
}else{return false
}}function getPlanHashMap(c){var d={};
var b="";
for(var a=0;
a<c.length;
a++){b=c[a].partNum;
if(d[b]===undefined&&(!c[a].select||!(c[a].select.suppress==="on"))){d[b]=c[a]
}else{}}return d
}var getBasketArr=function(b){if(!b||!b.mainContext||!b.mainContext.present||!b.mainContext.present.any[0]||!b.mainContext.present.any[0].pick){return[]
}var a=[];
var c=b.mainContext.present.any[0].pick;
$.each(c,function(f,d){if(d.subscription){var e=d.id;
thisObject=new Object();
thisObject.id=e;
thisObject.pickIds=[];
thisObject.pickIds.push(e);
var g=a.push(thisObject)-1;
a[g].subscription=d.subscription
}else{if(d.device&&d.device.deviceSubType==="Handset"&&!d.mainPickId){var e=d.id;
thisObject=new Object();
thisObject.id=e;
thisObject.pickIds=[];
thisObject.pickIds.push(e);
var g=a.push(thisObject)-1;
a[g].device=[];
a[g].device.push(d.device)
}}});
return a
};
var getBasketArrFull=function(b){var a=getBasketArr(b);
if(a===[]){return[]
}var c=b.mainContext.present.any[0].pick;
$.each(c,function(g,d){if(d.mainPickId){var f=d.mainPickId;
var h;
for(h=0;
h<a.length;
h++){if(f===a[h].id){if(d.resource){if(!a[h].resource){a[h].resource=[]
}var e=d.resource;
if(d.stockResCode){e.stockResCode=d.stockResCode
}if(d.otherCreditsCharges){e.otherCreditsCharges=d.otherCreditsCharges
}a[h].resource.push(e);
a[h].pickIds.push(d.id)
}if(d.device){var e=d.device;
if(d.stockResCode){e.stockResCode=d.stockResCode
}if(d.otherCreditsCharges){e.otherCreditsCharges=d.otherCreditsCharges
}if(d.device.deviceSubType==="Accessories"){if(!a[h].acc){a[h].acc=[]
}a[h].acc.push(e)
}else{if(!a[h].device){a[h].device=[]
}a[h].device.push(e)
}a[h].pickIds.push(d.id)
}if(d.product){var e=d.product;
if(d.otherCreditsCharges){e.otherCreditsCharges=d.otherCreditsCharges
}a[h].pickIds.push(d.id);
if(d.product.prodType==="VAS"){if(!a[h].vas){a[h].vas=[]
}a[h].vas.push(e)
}else{if(!a[h].plan){a[h].plan=[]
}a[h].plan.push(e)
}}break
}}}});
return a
};
function escapeParam(b){var a=escape(b);
a=a.replace(/\./g,"%2E");
return a
}function addErrorMsg(g){var b=$("#failMsg");
var e=$("#failMsgYes");
e.show();
var a=$("#failMsgNo");
a.hide();
var d=$("#failMsgYesText");
d.text("OK");
e.attr("href","javascript:stopColorbox();");
var f=$("#failMsgNoText");
f.text("NO");
var c=$("#failMsgFootNote");
c.hide();
if(g){if(typeof g=="string"){b.empty().append('<p class="message">'+g+"</p>")
}else{if(typeof g=="object"){if(g.failmsg){b.empty().append('<p class="message">'+g.failmsg+"</p>")
}else{addErrorMsg(onlinestore.MSG.SYSTEM_ERROR_MSG)
}if(g.yesButton&&g.yesButton===true){if(g.yesButtonText){d.text(g.yesButtonText)
}if(g.yesButtonUrl){e.attr("href",g.yesButtonUrl)
}e.show()
}if(g.noButton&&g.noButton===true){if(g.noButtonText){f.text(g.noButtonText)
}if(g.noButtonUrl){a.attr("href",g.noButtonUrl)
}a.show()
}if(g.footNote&&g.footNote===true){c.show()
}}}}else{b.empty().append('<p class="message">'+onlinestore.MSG.SYSTEM_ERROR_MSG+"</p>")
}}function appendErrorHtml(){var a='<div class="colorbox-content" style="display:none" id="inlined_colorbox_content"><div id="cbox_message_popup"><div class="modal-wrapper session" data-modal="session"><div class="modal-header" id="failMsg"><p class="message"></p></div><div class="modal-content"><a id="failMsgYes" href="javascript:void(0)" class="btn-secondaryGreen-rarrow btn-modal-yes" style="display:none"><span class="icon"></span><span id="failMsgYesText">Yes</span></a><a id="failMsgNo" href="javascript:void(0)" class="btn-secondaryGreen-rarrow btn-modal-no" style="display:none"><span class="icon"></span><span id="failMsgNoText">No</span></a><div class="modal-disclaimer" id="failMsgFootNote" style="display:none"><p>*Terms of your existing plan will still apply. To enjoy additional benefits and new services, please subscribe to a new plan.</p></div></div></div></div></div>';
$("body").append(a)
}function throwError(d){if(d){mobileService.log(d)
}if(mobileService.vars.otherErrorBeingThrowing){return
}mobileService.vars.otherErrorBeingThrowing=true;
var a=true;
var b=false;
var c=false;
if(d&&d.closeButton!=undefined){a=d.closeButton
}if(d&&d.overlayClose!=undefined){b=d.overlayClose
}if(d&&d.escKey!=undefined){c=d.escKey
}if($("#inlined_colorbox_content").length<=0){appendErrorHtml()
}setTimeout(function(){mobileService.vars.otherErrorBeingThrowing=false;
addErrorMsg(d);
$.colorbox($.extend({},_SH.ColorBox,{href:"#cbox_message_popup",inline:true,overlayClose:b,escKey:c,closeButton:a,onClosed:function(){if(d&&d.onClosed){d.onClosed()
}else{if(location&&location.pathname&&(location.pathname.indexOf("orderconfig_billrebate.html")>0)||location.pathname.indexOf("orderconfigurator.html")>0){if(window.history&&window.history.back){window.history.back()
}else{location.href.replace(baseUrl.browse)
}}}}}))
},100)
}function isValidField(a){return((a!==undefined)&&(a!==null))
}function isValidStringField(a){return((a!==undefined)&&(a!==null)&&($.trim(a)!==""))
}function getMainPickById(c,a){var d=c.mainContext.present.any[0].pick;
var b=new Object();
b.id=a;
$.each(d,function(j,g){if((g.mainPickId&&g.mainPickId==a)||g.id==a){if(g.subscription){b.subscription=g
}if(g.resource){if(!b.resource){b.resource=[]
}b.resource.push(g)
}if(g.device){if(g.device.deviceSubType==="Accessories"){if(!b.acc){b.acc=[]
}b.acc.push(g)
}else{if(!b.device){b.device=[]
}b.device.push(g)
}}if(g.offer){if(!b.offer){b.offer=[]
}b.offer.push(g)
}if(g.product){if(g.product.prodType==="VAS"){if(!b.vas){b.vas=[]
}b.vas.push(g)
}else{if(this.product.prodType==="Plan"){if(!b.plan){b.plan=[]
}b.plan.push(g)
}else{if(!this.product.prodType&&this.product.commercialOffers&&this.product.commercialOffers.commercialOffer&&this.product.commercialOffers.commercialOffer.length>0){var f=this.product.commercialOffers.commercialOffer;
for(var h=0,e=f.length;
h<e;
h++){if(f[h].waiver&&f[h].waiver.name=="hubcluberfdiscount"){if(!b.hubClubDiscount){b.hubClubDiscount=[]
}b.hubClubDiscount.push(g);
break
}}}}}}}});
return b
}function stopColorbox(){$.colorbox.close()
}function hideQuickLinks(){$("a.alert-cart").hide();
$("a.alert-compare").hide();
$("a.alert-hotline").hide()
}function postForm(c){var b=$("<form />");
b.hide();
var f=c.nextPageURL;
var e=c.params;
b.attr("action","/content/starhub/en/dev/onlinestore/posthandler.html");
b.attr("method","POST");
b.append('<input name="nextPage" value="'+f+'">');
var d="";
for(var a in e){if(e.hasOwnProperty(a)){d+=a+",";
b.append('<input name="'+a+'" value="'+e[a]+'">')
}}if(d.length>0){d.slice(0,-1)
}b.append('<input name="paramNameList" value="'+d+'">');
b.appendTo("body").submit()
}function parseUrlParam(e){var f={};
if(e){var b=unescape(e);
var d=b.split("&");
for(var c=0;
c<d.length;
c++){if(d[c]&&d[c].indexOf("=")>0){var a=d[c].split("=");
f[a[0]]=a[1]
}}}return f
}var genVasItemHTML=function(a){var b='<li class="vas-selection-row"> <div class="col col-1"><label class="custom-checkbox"><span class="mask"></span><input name="cb-caller-number-display" type="checkbox" value="'+a.partNum+'" class="vasSelect"/><span>'+a.prodName+'</span></label></div><div class="col col-2"><span class="mobile-only">One-time Charge:</span><span>';
if(a.otc===undefined||a.otc=="0"||a.mrc==null){b+="-"
}else{b+="$"+a.otc
}b+='</span></div><div class="col col-3"><span class="mobile-only">Monthly Subscription</span><span>';
if(a.mrc===undefined||a.mrc=="0"||a.mrc==null){b+="-"
}else{b+="$"+a.mrc
}b+='</span></div><div class="col col-4"><a href="javascript:void(0)" class="btn-white-rarrow btn-more-details"><span class="icon"></span>Details</a></div></li>';
return b
};
function precise_round(b,a){return(Math.round(b*Math.pow(10,a))/Math.pow(10,a))
}function calcWaive(d,c,e){if(!e||!c){return d
}var b=d;
for(var a=0;
a<e.length;
a++){if(!e[a].appliedTo||e[a].appliedTo!=c||!e[a].waiveValue||!e[a].waiveValue.type||!e[a].waiveValue.value){continue
}if(e[a].waiveValue.type==="abs"){b-=e[a].waiveValue.value
}else{if(e[a].waiveValue.type==="rel"){b*=(1-e[a].waiveValue.value/100)
}}}if(b<0){return 0
}return b
}function calcCharge(d,c){if(!c){return d
}var b=d;
for(var a=0;
a<c.length;
a++){if(!c[a].chargeValue||!c[a].chargeValue.type||!c[a].chargeValue.value){continue
}if(c[a].chargeValue.type==="abs"){b+=c[a].chargeValue.value
}else{if(c[a].chargeValue.type==="rel"){b*=(1+c[a].chargeValue.value/100)
}}}if(b<0){return 0
}return b
}function calcCommOff(d,c,e){if(!e||!c){return d
}var b=d;
for(var a=0;
a<e.length;
a++){if(!e[a].discount||e[a].discount.appliedTo!=c||!e[a].discount.discValue||!e[a].discount.discValue.type||!e[a].discount.discValue.value){continue
}if(e[a].discount.discValue.type==="abs"){b-=e[a].discount.discValue.value
}else{if(e[a].discount.discValue.type==="rel"){b*=(1-e[a].discount.discValue.value/100)
}}}if(b<0){return 0
}return b
}mobileService.checkCISType=function(e){var c=false;
if(e&&e.Groupings&&e.Groupings.Group){var b=e.Groupings.Group;
if(b.GroupType){if(b.GroupType=="Corporate (CIS)"){c=true
}}else{if(b.length){for(var d=0,a=b.length;
d<a;
d++){if(b[d].GroupType=="Corporate (CIS)"){c=true;
break
}}}}}return c
};
function checkUserTypeBlocking(a){_SH.Components.Loading.Show($(".modal-wrapper.signup-or-recontract"));
ajaxService.getUserInfo(function(b){if(mobileService.checkCISType(b)){var c={};
c.failmsg=onlinestore.MSG.CIS_BLOCK;
c.yesButton=true;
c.yesButtonText="Continue with current plan";
c.yesButtonUrl="javascript:stopColorbox();";
throwError(c)
}else{if(a){a()
}}})
}function addToCart(){if(isLogon()){$.colorbox($.extend({},_SH.ColorBox,{href:baseUrl.newSignUpOrRecontract}))
}else{requestLogin()
}}var validateRequire=function(a){return($.trim(a).length>0)
};
var validateFormat=function(a,b){return a.test(b)
};
mobileService.getIsVIP=function(a){if(a){if(a.toLowerCase()===mobileService.CONSTANTS.USERINFO_SUBCATEGORY.VIP||a.toLowerCase()===mobileService.CONSTANTS.USERINFO_SUBCATEGORY.VVIP){return"Y"
}else{return"N"
}}else{return"N"
}};
mobileService.getCheckedValue=function(b,a){if(b){return b
}else{if(a){return a
}else{return""
}}};
mobileService.fillBillingField=function(b,c){var a=mobileService.getCheckedValue(b);
if(a!==""){c.text(a)
}else{c.closest(".form-row").hide()
}};
mobileService.getKeysInObject=function(c){if(!c||c==={}){return null
}else{var b=[];
for(var a in c){if(c.hasOwnProperty(a)){b.push(a)
}}return b
}};
Object.keys=Object.keys||mobileService.getKeysInObject;
var ajaxService=ajaxService||{};
ajaxService.vars={RenewAuthKeyLock:false,registeredRenewCallBack:[]};
ajaxService.CONSTANTS={COOKIE_KEY_VCTK3KEY:"vctk3",COOKIE_KEY_OLDVCTK3KEY:"EMOBILE_VCTK3TOKEN",COOKIE_KEY_AUTHKEY:"AUTHKEY",SESSION_KEY_USER_INFO:"USER_INFO",STARHUB_ID_TYPE:"HUBIDTYPE",STARHUB_LITE_ID:"HUBIDLITE",PHONE_COMPARE_MODELS:"COMPARE_PHONE_BRAND_MODEL",AJAX_FAIL_MSG:"STARHUB_ECHO_AJAX_SERVICE_FAIL",AUTHKEY_EXPIRE_TIME:1,HUBIDLITE_USER_INFO:"HUBIDLITE_USER_INFO"};
function callFAPI(b,a,c,f,d,e){if(b){var g={success_callback_fn:function(h){},error_callback_fn:function(h){},done:function(h){if(typeof h=="function"){this.success_callback_fn=h
}this.resolve();
return this
},fail:function(h){if(typeof h=="function"){this.error_callback_fn=h
}this.resolve();
return this
},construct:function(j,h,k,n,l,m){this.url=j;
this.argument=h;
this.type=k;
this.data=n;
this.auth=l;
this.query=m
},resolve:function(){if(!this.resolved){this.resolved=true;
setTimeout(function(){ajaxService.resolveDefer(g)
},0)
}},url:undefined,argument:undefined,type:undefined,data:undefined,auth:undefined,query:undefined,resolved:false};
g.construct(b,a,c,f,d,e);
return g
}else{return undefined
}}ajaxService.getAuthForDefer=function(c,b){var a=b?ajaxService.renewAuthKey:ajaxService.getAuthKey;
a(function(e){var d=c;
d.auth=e;
ajaxService.resolveDefer(d)
})
};
ajaxService.getRequestRelated=function(b){var a={};
var c=getURL(b,"querystring__","authorisation__","querystring2__");
if(c.auth!=undefined){a.requireAuth=true
}return a
};
ajaxService.ajaxLog={log:{orderconfig_basket_modified:false},record_success:function(b,a){if(b.url===ONLINEWEB_FAPI_URL.BASKET_PICK){ajaxService.ajaxLog.log.orderconfig_basket_modified=true
}},record_fail:function(c,b){if((b.status!==202||c.count_202>=3)&&(b.status!==401||c.count_401>=3)){_SH.Components.Loading.Hide($(".loading-screen").parent())
}var a={};
a.message="We encounter an error for request <"+c.url+">, the response code is <"+b.status+">";
a.defer=c;
a.jqXHR=b;
mobileService.log(a)
}};
ajaxService.resolveDefer=function(c){if(c&&c.url){var b=ajaxService.getRequestRelated(c.url);
if(b.requireAuth&&!c.auth){ajaxService.getAuthForDefer(c)
}else{var a=callFAPI_(c.url,c.argument,c.type,c.data,c.auth,c.query);
a.done(function(e,f,d){ajaxService.ajaxLog.record_success(c,e);
ajaxService.sendcallback(e,c.success_callback_fn)
});
a.fail(function(d,f,e){ajaxService.ajaxLog.record_fail(c,d);
if(d.status===401){if(c.count_401>=3){ajaxService.sendcallback(d,c.error_callback_fn)
}else{c.count_401=(c.count_401?c.count_401+1:1);
ajaxService.getAuthForDefer(c,1)
}}else{if(d.status===202){if(c.count_202>=3){ajaxService.sendcallback(d,c.error_callback_fn)
}else{c.count_202=(c.count_202?c.count_202+1:1);
setTimeout(function(){ajaxService.resolveDefer(c)
},2000)
}}else{ajaxService.sendcallback(d,c.error_callback_fn)
}}})
}return 1
}else{mobileService.log("Defer cannot be resolved, no valid URL found!");
return 0
}};
ajaxService.myCookieHandler={};
ajaxService.mySessionStorageHandler={};
ajaxService.myCookieHandler.getCookie=function(a){return getCookie(a)
};
ajaxService.myCookieHandler.setCookie=function(c,e,d){var b=c+"="+e;
if(d&&d.expires){if(typeof d.expires=="object"){b+="; expires="+d.expires.toGMTString()
}else{var a=new Date();
a.setTime(a.getTime()+(d.expires*24*60*60*1000));
b+="; expires="+a.toGMTString()
}}if(d&&d.domain){b+="; domain="+d.domain
}if(d&&d.path){b+="; path="+d.path
}if((d&&d.secure)||(window.location.href.indexOf("https")>=0)){b+="; secure"
}document.cookie=b
};
ajaxService.myCookieHandler.removeCookie=function(a,b){var d=new Date();
var c=b||{};
d.setTime(d.getTime()-1);
c.expires=d;
ajaxService.myCookieHandler.setCookie(a,"",c)
};
ajaxService.cookie=function(a,c,b){if(c==undefined){return ajaxService.myCookieHandler.getCookie(a)
}else{return ajaxService.myCookieHandler.setCookie(a,c,b)
}};
ajaxService.removeCookie=function(a,b){return ajaxService.myCookieHandler.removeCookie(a,b)
};
ajaxService.sessionStorage=function(a,b){if(window.sessionStorage){if($.sessionStorage&&typeof $.sessionStorage=="function"){return $.sessionStorage(a,b)
}else{if(b!==undefined){sessionStorage[a]=JSON.stringify(b);
return sessionStorage[a]?JSON.parse(sessionStorage[a]):undefined
}else{return sessionStorage[a]?JSON.parse(sessionStorage[a]):undefined
}}}};
ajaxService.removeItem=function(a){if(window&&window.sessionStorage&&window.sessionStorage.removeItem){return window.sessionStorage.removeItem(a)
}else{return false
}};
function isStarHubLite(b){if(TEST_AUTH){if(TEST_USER_INFO){return TEST_USER_INFO.utype===ajaxService.CONSTANTS.STARHUB_LITE_ID
}else{return false
}}var a=ajaxService.cookie(ajaxService.CONSTANTS.STARHUB_ID_TYPE);
if(a===undefined){return ajaxService.getAuthKey(isStarHubLite)
}else{if(a===ajaxService.CONSTANTS.STARHUB_LITE_ID){return true
}else{return false
}}}function checkTimeOut(c,b){var a=-1;
if(b){a=b*60*60*1000
}else{a=4*60*60*1000
}if(ajaxService.sessionStorage(c)){var e=ajaxService.sessionStorage(c);
var d=(new Date()).getTime();
if(d-e<=a){return true
}else{return false
}}else{return false
}}ajaxService.sendcallback=function(b,c,a){if(a){if(typeof a==="object"){c.call(a.self_obj,a,b)
}else{c(a,b)
}}else{c(b)
}};
ajaxService.clearUserInfo=function(a){ajaxService.removeItem(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO);
if(a){}else{ajaxService.removeItem("CACHE"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE);
ajaxService.removeItem("CACHE_TIME_"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE);
ajaxService.removeCookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO,{path:"/"})
}ajaxService.removeCookie(ajaxService.CONSTANTS.COOKIE_KEY_AUTHKEY,{path:"/"});
ajaxService.removeCookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY,{path:"/"});
ajaxService.removeCookie(ajaxService.CONSTANTS.STARHUB_ID_TYPE,{path:"/"})
};
ajaxService.setUserInfo=function(b){ajaxService.clearUserInfo(1);
if(b){var a=b.uuid;
if(b&&b.fapicustomerinfo&&b.fapicustomerinfo.CustomerInfo){if(!b.fapicustomerinfo.CustomerInfo.HubId){b.fapicustomerinfo.CustomerInfo.HubId=a
}if(!b.fapicustomerinfo.CustomerInfo.ContactInfo||!b.fapicustomerinfo.CustomerInfo.ContactInfo.Email){b.fapicustomerinfo.CustomerInfo.ContactInfo=b.fapicustomerinfo.CustomerInfo.ContactInfo||{};
b.fapicustomerinfo.CustomerInfo.ContactInfo.Email=a
}ajaxService.sessionStorage(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO,b.fapicustomerinfo.CustomerInfo)
}else{ajaxService.sessionStorage(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO,{HubId:a,ContactInfo:{Email:a}})
}ajaxService.cookie(ajaxService.CONSTANTS.STARHUB_ID_TYPE,b.utype,{expires:ajaxService.CONSTANTS.AUTHKEY_EXPIRE_TIME,path:"/"})
}if(b&&b.utoken){var c=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_VCTK3KEY);
ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY,c,{expires:ajaxService.CONSTANTS.AUTHKEY_EXPIRE_TIME,path:"/"});
ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_AUTHKEY,b.utoken,{expires:ajaxService.CONSTANTS.AUTHKEY_EXPIRE_TIME,path:"/"})
}};
ajaxService.isNewLogin=function(){var b=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_VCTK3KEY);
var a=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY);
if(b&&a){if(b===a){return false
}else{ajaxService.clearUserInfo();
ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY,b,{expires:ajaxService.CONSTANTS.AUTHKEY_EXPIRE_TIME,path:"/"});
return true
}}return true
};
ajaxService.getUserInfo=function(b){if(TEST_AUTH&&TEST_USER_INFO){ajaxService.sendcallback(TEST_USER_INFO,b);
return
}var a=ajaxService.sessionStorage(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO);
if(b&&(typeof b==="function")){if(a){ajaxService.sendcallback(a,b);
return
}else{ajaxService.renewAuthKey(function(d){if(d){var c=ajaxService.sessionStorage(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO);
ajaxService.sendcallback(c,b)
}})
}}else{return ajaxService.sessionStorage(ajaxService.CONSTANTS.SESSION_KEY_USER_INFO)
}};
ajaxService.getPlanMapService=function(e,a,b){if(!e){return
}if(checkTimeOut("CACHE_TIME_"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS)){var c=ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS);
ajaxService.sendcallback(c,e,a)
}else{var d=callFAPI(ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS,null,"GET");
d.done(function(h,l,g){if(h&&h.mainContext&&h.mainContext.present&&h.mainContext.present.any&&h.mainContext.present.any[0]&&h.mainContext.present.any[0].product){var k=h.mainContext.present.any[0].product;
var f=getPlanHashMap(k);
try{ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS,f);
ajaxService.sessionStorage("CACHE_TIME_"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS,(new Date()).getTime())
}catch(j){ajaxService.removeItem("CACHE"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS);
ajaxService.removeItem("CACHE_TIME_"+ONLINEWEB_FAPI_URL.PRODUCTS_MOBILE_PLANS)
}ajaxService.sendcallback(f,e,a)
}else{if(!b){throwError()
}else{ajaxService.sendcallback("",b)
}}});
d.fail(function(f,h,g){if(!b){throwError()
}else{ajaxService.sendcallback("",b)
}})
}};
ajaxService.renewAuthKey=function(c,a){if(isLogon()){if(!ajaxService.vars.RenewAuthKeyLock){ajaxService.vars.RenewAuthKeyLock=true;
$.ajax({url:AJAX_UTOKEN_URL+"?ts="+getHashedVctk3(),beforeSend:function(d){d.setRequestHeader("Accept","application/json")
}}).done(function(g,h,f){if(g&&g.utoken){ajaxService.setUserInfo(g);
if(isStarHubLite()){ajaxService.postAuthToken(function(){ajaxService.sendcallback(g.utoken,c,a);
for(var k=0,j=ajaxService.vars.registeredRenewCallBack.length;
k<j;
k++){ajaxService.sendcallback(g.utoken,ajaxService.vars.registeredRenewCallBack[k].callback,ajaxService.vars.registeredRenewCallBack[k].callBackParams)
}ajaxService.vars.registeredRenewCallBack=[];
ajaxService.vars.RenewAuthKeyLock=false
})
}else{ajaxService.sendcallback(g.utoken,c,a);
for(var e=0,d=ajaxService.vars.registeredRenewCallBack.length;
e<d;
e++){ajaxService.sendcallback(g.utoken,ajaxService.vars.registeredRenewCallBack[e].callback,ajaxService.vars.registeredRenewCallBack[e].callBackParams)
}ajaxService.vars.registeredRenewCallBack=[];
ajaxService.vars.RenewAuthKeyLock=false
}}else{ajaxService.vars.RenewAuthKeyLock=false;
throwError()
}}).fail(function(d,f,e){ajaxService.vars.RenewAuthKeyLock=false;
_SH.Components.Loading.Hide($(".loading-screen").parent());
throwError()
})
}else{var b={};
b.callback=c;
b.callBackParams=a;
ajaxService.vars.registeredRenewCallBack.push(b)
}}else{requestLogin()
}};
ajaxService.getAuthKey=function(c,a){if(TEST_AUTH){ajaxService.sendcallback(TEST_AUTH,c,a);
return
}if(isLogon()){if(!ajaxService.isNewLogin()&&ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_AUTHKEY)){var b=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_AUTHKEY);
ajaxService.sendcallback(b,c,a)
}else{ajaxService.renewAuthKey(c,a)
}}else{requestLogin()
}};
ajaxService.getContractService=function(e,b,d){if(!e){return
}if(checkTimeOut("CACHE_TIME_"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE)){var a=ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE);
ajaxService.sendcallback(a,e)
}else{var c=callFAPI(ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE,null,"GET",null,b);
c.done(function(h,k,g){var f=[];
if(h&&h.mainContext&&h.mainContext.present&&h.mainContext.present.any&&h.mainContext.present.any[0]&&h.mainContext.present.any[0].contract){f=h.mainContext.present.any[0].contract;
try{ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE,f);
ajaxService.sessionStorage("CACHE_TIME_"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE,(new Date()).getTime())
}catch(j){ajaxService.removeItem("CACHE"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE);
ajaxService.removeItem("CACHE_TIME_"+ONLINEWEB_FAPI_URL.CONTRACTS_MOBILE)
}}ajaxService.sendcallback(f,e)
});
if(d!=undefined){c.fail(d)
}}};
ajaxService.updateBasketSideBar=function(a){if(isLogon()&&(!isStarHubLite()||ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO))){var b=callFAPI(ONLINEWEB_FAPI_URL.BASKET,null,"GET",null,a);
b.done(function(d,f,c){var e=getBasketArr(d);
if(e.length>0){$("#shopping_cart_number").text(e.length)
}else{$("#shopping_cart_number").text("_")
}if(e.length>0){startSessionTimer()
}});
b.fail(function(c,e,d){})
}};
ajaxService.setPhoneCompareBrandModel=function(a){ajaxService.removeCookie(ajaxService.CONSTANTS.PHONE_COMPARE_MODELS,{path:"/"});
if(a.length>0&&a[0].brand&&a[0].model){var b={};
b.phonelist=a;
ajaxService.cookie(ajaxService.CONSTANTS.PHONE_COMPARE_MODELS,JSON.stringify(b),{path:"/"})
}ajaxService.updateCompareSideBar()
};
ajaxService.getPhoneCompareBrandModel=function(){var b=ajaxService.cookie(ajaxService.CONSTANTS.PHONE_COMPARE_MODELS);
if(b&&b.length>0){var a=JSON.parse(b);
if(a&&a.phonelist){return a.phonelist
}else{return undefined
}}else{return undefined
}};
ajaxService.updateCompareSideBar=function(){var c=ajaxService.getPhoneCompareBrandModel();
var b=$("#compare_item_number"),a=b.parent();
if(c&&c.length>0){if(!a.hasClass("enabled")){a.addClass("enabled")
}b.text(c.length)
}else{if(a.hasClass("enabled")){a.removeClass("enabled")
}b.text("")
}};
ajaxService.getHandsetService=function(d,a){if(!d){return
}if(checkTimeOut("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS)){var c=ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS);
ajaxService.sendcallback(c,d)
}else{var b=callFAPI(ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS,null,"GET");
b.done(function(h,l,g){var f=h.mainContext.present.any[0].device;
var k=groupDevice(f);
try{ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS,k);
ajaxService.sessionStorage("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS,(new Date()).getTime())
}catch(j){ajaxService.removeItem("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS);
ajaxService.removeItem("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS)
}ajaxService.sendcallback(k,d)
});
b.fail(function(e,g,f){if(a){ajaxService.sendcallback(ajaxService.CONSTANTS.AJAX_FAIL_MSG,a)
}else{throwError({debug:"get handset fail."})
}})
}};
ajaxService.getHandsetByCampaignIdService=function(e,a,b){if(!e||!a){return
}if(checkTimeOut("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID)){var d=ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID);
ajaxService.sendcallback(d,e)
}else{var c=callFAPI(ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID,a,"GET");
c.done(function(h,l,g){var f=h.mainContext.present.any[0].device;
var k=groupDevice(f);
try{ajaxService.sessionStorage("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID,k);
ajaxService.sessionStorage("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID,(new Date()).getTime())
}catch(j){ajaxService.removeItem("CACHE"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID);
ajaxService.removeItem("CACHE_TIME_"+ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_BY_CAMPAIGNID)
}ajaxService.sendcallback(k,e)
});
c.fail(function(f,h,g){if(b){ajaxService.sendcallback(ajaxService.CONSTANTS.AJAX_FAIL_MSG,b)
}else{throwError({debug:"get handset by campaignId fail."})
}})
}};
ajaxService.newSignUpEligibleCheckService=function(c,b){if(!c){return
}var a=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP,"","POST","");
a.done(function(f,g,e){var d=f.mainContext.present.any[0];
ajaxService.sendcallback(d,c)
});
a.fail(function(d,f,e){throwError({debug:"new sign up eligible check fail."})
})
};
ajaxService.newSignUpEligibleMasterCheckService=function(c,b){if(!c){return
}var a=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_NEW_SIGNUP_MASTER,"","GET","",b);
a.done(function(f,g,e){var d=f.mainContext.present.any[0];
ajaxService.sendcallback(d,c)
});
a.fail(function(d,f,e){throwError({debug:"new sign up master eligible check fail."})
})
};
ajaxService.getBillAddressService=function(c,a){if(!c){return
}var b=callFAPI(ONLINEWEB_FAPI_URL.BILLS,"","GET","",a);
b.done(function(e,f,d){ajaxService.sendcallback(e,c)
});
b.fail(function(d,f,e){throwError({debug:"get bill fail."})
})
};
ajaxService.postAuthToken=function(c,e,d){var f;
if(d!=undefined){f=getHubIdAuthTokenRequestMsg(d.docID,d.docType,d.birthDate)
}else{if(ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO)){var b=JSON.parse(ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO));
f=getHubIdAuthTokenRequestMsg(b.docID,b.docType,b.birthDate)
}else{ajaxService.sendcallback(undefined,c,e);
return
}}var a=callFAPI(ONLINEWEB_FAPI_URL.HUBIDLITE_AUTHTOKEN,"","POST",f);
a.done(function(h,j,g){ajaxService.sendcallback(h,c,e)
});
a.fail(function(j,l,k){if(j.status==409){var h={};
h.failmsg=onlinestore.MSG.FIRST_TIME_PURCHASE_WAITING_FOR_COMPLETE;
h.yesButton=true;
h.yesButtonUrl="javascript:stopColorbox()";
h.yesButtonText="OK";
throwError(h);
ajaxService.removeCookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO,{path:"/"})
}else{if(j.status==303){var g={};
g.failmsg=onlinestore.MSG.HUBID_LITE_USER_TO_RECONTRACT_EXISTING;
g.yesButton=true;
g.yesButtonUrl="javascript: ajaxService.clearUserInfo(true); window.location.href = HUBIDLITE_ASSOCIATION_URL";
g.yesButtonText="Upgrade Now";
g.noButton=true;
g.noButtonUrl="javascript:stopColorbox()";
g.noButtonText="Cancel";
throwError(g)
}else{if(j.status==403){throwError({debug:"authToken association returns 403"})
}else{throwError({debug:j.status+" is returned from authToken association"})
}}}})
};
ajaxService.checkHubIdTypeAndProceed=function(a){ajaxService.getAuthKey(function(b){if(isStarHubLite()&&!ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO)){authToken.vars.postAuthTokenCallBack=a;
$.colorbox($.extend({},{href:baseUrl.modalUserInfo,open:true},_SH.ColorBox))
}else{ajaxService.sendcallback("",a)
}})
};
AjPool={pendingTaskCount:0,isAbort:false,addTask:function(){this.pendingTaskCount++;
return this.pendingTaskCount
},removeTask:function(){if(this.pendingTaskCount>0){this.pendingTaskCount--;
return this.pendingTaskCount
}else{return -1
}},done:function(b){var f=b;
b=b||{};
var e=b.doneFn||(function(){});
var c=b.pendingFn||(function(){});
var a=b.loadSelector||"body";
if(this.hasAbort()){return
}else{if(this.isEmpty()){ajaxService.sendcallback(undefined,e,b.doneFnParams);
if(!b.noHideAft){_SH.Components.Loading.Hide($(a))
}}else{if(!b.noShowBf){_SH.Components.Loading.Show($(a))
}ajaxService.sendcallback(undefined,c,b.pendingFnParams);
var d=this;
setTimeout(function(){d.done(f)
},100)
}}},isEmpty:function(){return(this.pendingTaskCount<=0)
},abort:function(){this.isAbort=true
},hasAbort:function(){return this.isAbort
}};
ajaxService.getUpdatedUserInfo=function(b){var a=callFAPI(ONLINEWEB_FAPI_URL.GET_CUSTINFO,"","GET");
a.done(function(d){try{ajaxService.sendcallback(d.mainContext.present.any[0],b)
}catch(c){mobileService.log("fapi return incomplete user info object.");
mobileService.log(d);
mobileService.log(c)
}});
a.fail(function(c){ajaxService.sendcallback(undefined,b)
})
};
ajaxService.checkBasketFull=function(a,c){if(a){return getBasketArr(a).length>=1
}else{var b=callFAPI(ONLINEWEB_FAPI_URL.BASKET,"","GET");
b.done(function(e){if(ajaxService.checkBasketFull(e)){var d={};
d.failmsg=onlinestore.MSG.BASKET_FULL;
d.yesButton=true;
d.yesButtonText="Complete Transaction";
d.yesButtonUrl=baseUrl.cartSummary;
throwError(d)
}else{ajaxService.sendcallback(e,c)
}});
b.fail(function(d){throwError()
})
}};
var TEST_AUTH=TEST_AUTH||"";
function isLogon(){if(TEST_AUTH){return true
}var a=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_VCTK3KEY);
if(a==undefined||a==null){ajaxService.clearUserInfo();
return false
}else{if(a!=ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY)){ajaxService.clearUserInfo();
ajaxService.cookie(ajaxService.CONSTANTS.COOKIE_KEY_OLDVCTK3KEY,a,{expires:ajaxService.CONSTANTS.AUTHKEY_EXPIRE_TIME,path:"/"});
ajaxService.getAuthKey(function(b){})
}}return true
}isLogon();
var onlinestore=onlinestore||{};
onlinestore.MSG={SESSION_TIME_OUT:"Your session is about to expire. Do you want to continue shopping?",LISTING_PAGE_RETRIEVE_USER_INFO_FAIL:"Unable to retrieve information.  Please try again",LISTING_PAGE_RECONTRACT_WITH_A_FEE:"Eligible for recontract with a fee.",ELIGIBLE_FOR_RECONTRACT:"Eligible for recontract.",NOT_ELIGIBLE_FOR_RECONTRACT:"Not eligible for recontract.",NOT_ELIGIBLE_FOR_BILLREBATE:"Not eligible for bill rebate.",ELIGIBLE_FOR_BILLREBATE:"Eligible for bill rebate.",COMPARE_ITEM_REACHED_MAX:"Please select only two phones for comparison.",NO_PHONE_IN_COMPARE_PAGE:"Please select two phones to compare them side by side.",LIST_PAGE_WAITING_FOR_USER_CONTRACT_INFO:"Please wait while we are checking on your eligibility",DO_NOT_HAVE_ANY_CONTRACT_LINES:"You currently have no lines eligible for recontract. Would you like to sign up for a new line? ",RECONTRACT_HEADER_FOR_HAS_LINE_ELIGIBLE:"Please select a line to check on its eligibility status.",RECONTRACT_HEADER_FOR_NO_LINE_ELIGIBLE:"Your mobile line recontract eligibility.",BILLREBATE_HEADER_FOR_HAS_LINE_ELIGIBLE:"Please select a line to check on its eligibility status.",BILLREBATE_HEADER_FOR_NO_LINE_ELIGIBLE:"Your mobile line bill rebate eligibility.",RECONTRACT_VAS_BLOCK:function(a){return"Sorry, customers who are subscribed to "+a.join(", ")+' service are currently unable to recontract via Online. Please leave your contact details with us <a href="/content/starhub/en/personal/forms/mobile/signup-or-recontract-with-onlinestore.html" target="_blank">here</a> and we will respond back to you accordingly.'
},SYSTEM_ERROR_MSG:"Sorry, we are unable to process your request. Please try again.",ERROR_REQUEST:"Sorry, there seems to be an error with your request. Please try again.",BLACK_LIST_ACCOUNT_ERROR:"Sorry, you are currently ineligible to apply for a new line. Please call 1630 for more details.",CIS_BLOCK:'Sorry, customers who are subscribed to Corporate Individual Scheme (CIS) are currently unable to recontract or sign up for a new line via Online. Please leave your contact details with us <a href="/content/starhub/en/personal/forms/mobile/signup-or-recontract-with-onlinestore.html" target="_blank">here</a> and we will respond back to you accordingly.',OPTION_TO_NOT_USE_VOUCHER:"No, I do not wish to use the voucher and understand that the voucher will be invalid hereafter.",NO_MATCH_RESULT_FOR_FILTERING:"Sorry, there are no matching results. Please try a different search.",TEXT_TO_LET_USER_SELECT_A_LINE_TO_CHECK_RECONTRACT_ELIGIBILITY:"Please select a line to check on its eligibility status.",BILL_REBATE_LIGHT_BOX_HEADER:"Would you like to enjoy bill rebates?",NO_PLANS_MSG:"Sorry, there is no plan associated with the current device.",ADD_PICK_INTO_CART_ERROR:"Sorry, there seems to be an error in adding the item to your cart. Please try again.",DELETE_MAINPICK_ERROR:"This item does not exist or has already been deleted. Please refresh your browser to continue.",SUBSCRIPTION_PICK_EC_FAIL_DISPLAY_NAME:"This order is not eligible",RESERVATION_CHECK_ERROR:"Sorry, but reservation status for the selected item is invalid. Please Edit/Delete order to continue.",PROCESS_VAS_FAIL_MSG:"Sorry, there seems to be an error with your request. Please try again.",UNKNOWN_ORDER_ERROR_MSG:"Sorry, there was an error in processing your request. Please delete your order and try again.",ORDER_TRACKING_PROCESSING:"Your order package will be sent to you shortly.",ORDER_TRACKING_DELIVERED:"If you have not received your package, please call 1630 for assistance.",BLANK_INPUT_ERROR_MSG:"This field is required.",WRONG_NUMBER:"Please provide a correct number.",INVALID_NRIC_MSG:"Please input a valid NRIC.",INVALID_FIN_MSG:"Please input a valid FIN.",CONFIRM_EDIT_ORDER:"Would you like to edit your order?",LEGACY_PLAN:function(b,a){return"Sorry, your existing plan for "+phoneNumberToString(b)+" is no longer available for recontract. <br>Would you like to choose a new plan?"
},HUBID_LITE_USER_TO_RECONTRACT_EXISTING:"Please upgrade your Hub ID account now to complete your transaction. This will also allow us to serve you better. Thank you.",HUBID_LITE_USER_TO_RECONTRACT_NEW:"Sorry, we don't seem to have your account details. Would you like to sign up for a new line instead?",HUBCLUB_BLOCK:"Sorry, the Hub Club Early Recontract Fee (ERF) waiver is not available for use on online. Please call 1630 for further assistance.",BASKET_FULL:"Please complete your current transaction in your shopping cart before making another purchase. Thank you.",FIRST_TIME_PURCHASE_WAITING_FOR_COMPLETE:"Sorry, you can only make another purchase upon successful delivery of your order. Thank you.",MODAL_ELIGIBLE_FOR_HUB_CLUB_DISCOUNT:"Eligible for recontract with Hub Club Early Recontract Fee waiver*",MODAL_HAS_RECONTRACT_VOUCHER:"Eligible for recontract with Recontract Voucher",RECONTRACT_VOUCHER_TEXT:"We are pleased to extend a recontract voucher for this renewal. Would you like to use it?",HUBCLUB_DISCOUNT_WAIVER_TEXT:"We are pleased to extend a recontract waiver for this renewal. Would you like to use it?",HUBCLUB_YES_RADIO:"Yes, I would like to use my Hub Club Early Recontract Fee (ERF) Waiver for this transaction.",HUBCLUB_NO_RADIO:"No, I do not wish to use the Hub Club Early Recontract Fee (ERF) Waiver.",BASKET_INCOMPLETE:"Please review the details of your order before you proceed to checkout",MRC_NOTE:"Monthly Recurring Charges (MRC) and VAS charges are exclusive of GST as the amount of GST chargeable for these fees varies according to your usage. The detailed breakdown of charges (including GST) will be reflected in your monthly bill.",PDPA_REMINDER:"Want to be informed of StarHub's exclusive promotions that is available for you? Scroll down to the bottom of this page to give us your consent.",TERMS_AND_CONDITIONS_REMINDER:"Please accept the Terms and Conditions before proceeding",TELL_USER_ORDER_REMOVED:"Sorry, the order in your cart is no longer valid and has been removed. To add a new order, please continue shopping."};
var MOBILE_ESHOP_OUTLETID="CSS88OS";
var defaultPlanUrl="/content/starhub/en/personal/mobile/postpaid-plans.html";
var pricePlanMap={};
pricePlanMap["i2Surf 100"]="/content/starhub/en/personal/mobile/postpaid-plans/youth-plans/smartsurf-student.html";
pricePlanMap["i2Surf 300"]="/content/starhub/en/personal/mobile/postpaid-plans/youth-plans/smartsurf-student.html";
pricePlanMap["i2Surf 700"]="/content/starhub/en/personal/mobile/postpaid-plans/youth-plans/smartsurf-student.html";
pricePlanMap["Power Value 80"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["Power Value 100"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["Power Value 300"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["Power Value 700"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["SmartSurf Lite"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-plans.html";
pricePlanMap["SmartSurf Value"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-plans.html";
pricePlanMap["SmartSurf Premium"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-plans.html";
pricePlanMap["SmartSurf Elite"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-plans.html";
pricePlanMap["SmartSurf HD Value"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-hd-plans.html";
pricePlanMap["SmartSurf HD Plus"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-hd-plans.html";
pricePlanMap["SmartSurf HD Premium"]="/content/starhub/en/personal/mobile/postpaid-plans/smartsurf-hd-plans.html";
pricePlanMap.SmartBuddy="/content/starhub/en/personal/mobile/postpaid-plans/smartbuddy.html";
pricePlanMap["3G PowerValue 80"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["3G PowerValue 100"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["3G PowerValue 300"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["3G PowerValue 700"]="/content/starhub/en/personal/mobile/postpaid-plans/powervalue-plans.html";
pricePlanMap["MaxMobile Lite (6GB)"]="/content/starhub/en/personal/mobile/postpaid-plans/maxmobile-plans.html";
pricePlanMap["BlackBerry Unlimited Data"]="/content/starhub/en/personal/mobile/postpaid-plans/blackberry-plans.html";
var defaultVasUrl="/content/starhub/en/personal/mobile/value-added-services.html";
var vasDetailPageUrl={};
vasDetailPageUrl["Itemized Bill"]="/content/starhub/en/personal/mobile/value-added-services/add-on.html";
vasDetailPageUrl["Caller Number Non Display"]="/content/starhub/en/personal/mobile/value-added-services/add-on/call-number-non-display.html";
vasDetailPageUrl["BlackBerry Unlimited"]="/content/starhub/en/personal/mobile/postpaid-plans/blackberry-plans.html";
vasDetailPageUrl["Caller Number Display"]="/content/starhub/en/personal/mobile/value-added-services/add-on/call-number-display.html";
vasDetailPageUrl["MaxMobile Value"]="/content/starhub/en/personal/mobile/value-added-services/maxmobile.html";
vasDetailPageUrl["Pay As You Roam"]="http://roaming.starhub.com";
vasDetailPageUrl["MaxMobile Lite"]="/content/starhub/en/personal/mobile/value-added-services/maxmobile.html";
vasDetailPageUrl["StarHub TV on Mobile+"]="/content/starhub/en/personal/mobile/value-added-services/entertainment/starhub-tv-on-mobile.html";
vasDetailPageUrl["BlackBerry Premium"]="/content/starhub/en/personal/mobile/postpaid-plans/blackberry-plans.html";
vasDetailPageUrl["MaxMobile Premium"]="/content/starhub/en/personal/mobile/value-added-services/maxmobile.html";
vasDetailPageUrl["Free IDD018+"]="/content/starhub/en/personal/promotions/mobile/free-10-mins-idd-018.html";
vasDetailPageUrl["BB PrintMail-PremiereAnywhere+"]="/content/starhub/mobile/vas/bb-printmail-premiereanywhere.html";
vasDetailPageUrl["International Roaming"]="http://roaming.starhub.com";
vasDetailPageUrl["XtraFun Pack+"]="/content/starhub/mobile/vas/xtrafun-pack_.html";
vasDetailPageUrl["BlackBerry Unlimited Data"]="/content/starhub/en/personal/mobile/postpaid-plans/blackberry-plans.html";
vasDetailPageUrl["4G Speed Boost"]="/personal/support/mobile/faq/4g-speed-boost-faq.html";
function getPricePlanURL(a){for(var b in pricePlanMap){if(b.toUpperCase()===a.toUpperCase()){return pricePlanMap[b]
}}return defaultPlanUrl
}function getVasURL(b){for(var a in vasDetailPageUrl){if(a.toUpperCase()===b.toUpperCase()){return vasDetailPageUrl[a]
}}return defaultVasUrl
}var BasketObj=function BasketObj(){};
BasketObj.prototype.getId=function(){return this.id
};
BasketObj.prototype.setId=function(a){this.id=a
};
BasketObj.prototype.getNettPayNow=function(){return this.nettPayNow
};
BasketObj.prototype.setNettPayNow=function(a){this.nettPayNow=a
};
BasketObj.prototype.getNettRecurring=function(){return this.nettRecurring
};
BasketObj.prototype.setNettRecurring=function(a){this.nettRecurring=a
};
BasketObj.prototype.getGrossPayNow=function(){return this.grossPayNow
};
BasketObj.prototype.setGrossPayNow=function(a){this.grossPayNow=a
};
BasketObj.prototype.getGrossRecuring=function(){return this.grossRecuring
};
BasketObj.prototype.setGrossRecuring=function(a){this.grossRecuring=a
};
BasketObj.prototype.getBasketOrderMap=function(){return this.basketOrderMap
};
BasketObj.prototype.setBasketOrderMap=function(a){this.basketOrderMap=a
};
BasketObj.prototype.getTotalPrice=function(){return this.totalPrice
};
BasketObj.prototype.setTotalPrice=function(a){this.totalPrice=a
};
BasketObj.prototype.getSize=function(){return this.size
};
BasketObj.prototype.setSize=function(a){this.size=a
};
var BasketOrder=function BasketOrder(){};
BasketOrder.prototype.getDevicePick=function(){return this.devicePick
};
BasketOrder.prototype.setDevicePick=function(a){this.devicePick=a
};
BasketOrder.prototype.getSubscriptionPick=function(){return this.subscriptionPick
};
BasketOrder.prototype.setSubscriptionPick=function(a){this.subscriptionPick=a
};
BasketOrder.prototype.getPlanPick=function(){return this.planPick
};
BasketOrder.prototype.setPlanPick=function(a){this.planPick=a
};
BasketOrder.prototype.getVasPickList=function(){return this.vasPickList
};
BasketOrder.prototype.setVasPickList=function(a){this.vasPickList=a
};
BasketOrder.prototype.getResourcePick=function(){return this.resourcePick
};
BasketOrder.prototype.setResourcePick=function(a){this.resourcePick=a
};
BasketOrder.prototype.getAccessoryPickList=function(){return this.accessoryPickList
};
BasketOrder.prototype.setAccessoryPickList=function(a){this.accessoryPickList=a
};
BasketOrder.prototype.getTotalPrice=function(){return this.totalPrice
};
BasketOrder.prototype.setTotalPrice=function(a){this.totalPrice=a
};
BasketOrder.prototype.getTotalMRC=function(){return this.totalMRC
};
BasketOrder.prototype.setTotalMRC=function(a){this.totalMRC=a
};
BasketOrder.prototype.getOrderType=function(){return this.orderType
};
BasketOrder.prototype.setOrderType=function(a){this.orderType=a
};
BasketOrder.prototype.getVoucherPrice=function(){return this.voucherPrice
};
BasketOrder.prototype.setVoucherPrice=function(a){this.voucherPrice=a
};
BasketOrder.prototype.getERF=function(){return this.eRF
};
BasketOrder.prototype.setERF=function(a){this.eRF=a
};
BasketOrder.prototype.getDeposit=function(){return this.deposit
};
BasketOrder.prototype.setDeposit=function(a){this.deposit=a
};
BasketOrder.prototype.hasERF=function(){var a=this.getSubscriptionPick();
if(a&&a.getERF()&&(typeof a.getERF().getChargeValue()==="number")){return true
}else{return false
}};
var BasketService=BasketService||{};
BasketService.CONSTANTS={DEVICE_SUBTYPE:{HANDSET:"handset",ACCESSORY:"accessories",TABLET:"tablet",DONGLE:"dongle"},PRODTYPE:{PLAN:"plan",VAS:"vas"},MODE_OF_SERVICE:"mode of service",TYPE_OF_PLAN:"type of plan",ORDER_TYPE:{NEW_SIGN_UP:"NEW_SIGN_UP",RECONTRACT:"RECONTRACT",BILL_REBATE:"BILL_REBATE",UNKNOWN:"UNKNOWN"},SUBSCRIPTION_TYPE:{NEW:"new",EXISTING:"existing"},ERF_CHARGE_STOCKCODE_SET:["UP12M200MOBILE","UP12M300APP"],DEPOSIT_CHARGE_STOCKCODE_SET:["DEPWP000001","DEPFS000001","DEPMOB00001"],OCC_CHARGE_TYPE:{ERF:"ERF",DEPOSIT:"DEPOSIT"},VOUCHER_WAIVER_NAME:"voucher",OCC_WAIVER_TYPE:{VOUCHER:"voucher"},WAIVER_NAME:{HUBCLUB_DISCOUNT_WAIVER:"HUBCLUBERF"}};
BasketService.getBasket=function(g){if(!g||!g.mainContext||!g.mainContext.present||!g.mainContext.present.any||(g.mainContext.present.any.length<=0)||!g.mainContext.present.any[0]){return null
}var G=g.mainContext.present.any[0];
var k=G.pick;
var u=G.basketTotals;
var z=new BasketObj();
z.setId(G.id);
if(u){z.setNettPayNow(u.nettPayNow);
z.setGrossPayNow(u.grossPayNow);
z.setNettRecurring(u.nettRecurring);
z.setGrossRecuring(u.grossRecurring)
}var b={};
for(var J=0;
J<k.length;
J++){var L=k[J];
var a=L.id;
var v=(L.subscription?a:L.mainPickId);
if(!b.hasOwnProperty(v)){var B=new BasketOrder();
var n=[];
B.setVasPickList(n);
var D=[];
B.setAccessoryPickList(D)
}else{var B=b[v]
}var c=L.subscription;
if(c){var p=BasketService.parseSubscriptionPick(a,c,L);
B.setSubscriptionPick(p);
b[v]=B
}var f=L.device;
if(f){var K=BasketService.parseDevicePick(a,v,f,L);
var x=K.getDeviceSubType();
if(x){if(BasketService.CONSTANTS.DEVICE_SUBTYPE.HANDSET===x.toLowerCase()||BasketService.CONSTANTS.DEVICE_SUBTYPE.TABLET===x.toLowerCase()||BasketService.CONSTANTS.DEVICE_SUBTYPE.DONGLE===x.toLowerCase()){B.setDevicePick(K);
b[v]=B
}else{if(BasketService.CONSTANTS.DEVICE_SUBTYPE.ACCESSORY===x.toLowerCase()){B.getAccessoryPickList().push(K);
b[v]=B
}}}}var h=L.resource;
if(h){var C=BasketService.parseResourcePick(a,v,h,L);
B.setResourcePick(C);
b[v]=B
}var r=L.product;
if(r){var I=r.prodType;
if(I){if(BasketService.CONSTANTS.PRODTYPE.PLAN===I.toLowerCase()){var m=BasketService.parsePlanPick(a,v,r);
B.setPlanPick(m);
b[v]=B
}else{if(BasketService.CONSTANTS.PRODTYPE.VAS===I.toLowerCase()){var F=BasketService.parseVASPick(a,v,r);
B.getVasPickList().push(F);
b[v]=B
}}}}}for(var q in b){if(b.hasOwnProperty(q)){var H=PriceCalService.calculateOneOrderVoucherPrice(b[q]);
b[q].setVoucherPrice(H);
var d=PriceCalService.calculateOneOrderERF(b[q]);
b[q].setERF(d);
var t=PriceCalService.calculateOneOrderDeposit(b[q]);
b[q].setDeposit(t);
var o=PriceCalService.calculateOneOrderTotalPrice(b[q]);
b[q].setTotalPrice(o);
var E=PriceCalService.calculateOneOrderTotalMRC(b[q]);
b[q].setTotalMRC(E)
}}var e=0;
for(var q in b){if(b.hasOwnProperty(q)){var w=b[q];
if(w.getSubscriptionPick()){var y=w.getSubscriptionPick()
}else{return null
}var l=w.getPlanPick();
var j=y.getType();
if(j){if(BasketService.CONSTANTS.SUBSCRIPTION_TYPE.NEW===j.toLowerCase()){w.setOrderType(BasketService.CONSTANTS.ORDER_TYPE.NEW_SIGN_UP)
}else{if(BasketService.CONSTANTS.SUBSCRIPTION_TYPE.EXISTING===j.toLowerCase()){if(l){if(l.getDiscountAppliedTo()){w.setOrderType(BasketService.CONSTANTS.ORDER_TYPE.BILL_REBATE)
}else{w.setOrderType(BasketService.CONSTANTS.ORDER_TYPE.RECONTRACT)
}}else{w.setOrderType(BasketService.CONSTANTS.ORDER_TYPE.UNKNOWN)
}}else{w.setOrderType(BasketService.CONSTANTS.ORDER_TYPE.UNKNOWN)
}}}e++
}}z.setBasketOrderMap(b);
z.setSize(e);
var A=PriceCalService.calculateBasketTotalPrice(z);
z.setTotalPrice(A);
return z
};
BasketService.parseSubscriptionPick=function(k,a,e){if(!a){return null
}var l=new SubscriptionPickObj();
l.setId(k);
l.setType(a.type);
if(a.billingAccount){l.setBillingAccountId(a.billingAccount.billingAccountId);
l.setBillingAccountNo(a.billingAccount.billingAccountNo);
l.setBillingAddress(a.billingAccount.billingAddress)
}l.setPartNum(a.partNum);
l.setDeviceCategory(a.deviceCategory);
var h=a.contract;
if(h){l.setContractServiceId(a.contract.serviceId);
l.setContractPlanPartNum(a.contract.planPartNum);
var d=h.contractParams;
if(d){var g=d.serviceParam;
if(g&&(g.length>0)){for(var f=0;
f<g.length;
f++){var c=g[f];
if(c&&c.svcParamName){if(BasketService.CONSTANTS.MODE_OF_SERVICE===c.svcParamName.toLowerCase()){l.setContractModeOfService(c.svcParamValue)
}else{if(BasketService.CONSTANTS.TYPE_OF_PLAN===c.svcParamName.toLowerCase()){l.setContractTypeOfPlan(c.svcParamValue)
}}}}}}}l.setDepositList([]);
var b=function(m){if(m.getType()===BasketService.CONSTANTS.OCC_CHARGE_TYPE.ERF){l.setERF(m)
}else{if(m.getType()===BasketService.CONSTANTS.OCC_CHARGE_TYPE.DEPOSIT){l.getDepositList().push(m)
}}};
var j=function(m){if(m.getType()===BasketService.CONSTANTS.OCC_WAIVER_TYPE.VOUCHER){l.setVoucher(m)
}else{if(m.waiverName===BasketService.CONSTANTS.WAIVER_NAME.HUBCLUB_DISCOUNT_WAIVER){l.setHubClubDiscountWaiver(m)
}}};
BasketService.parseOcc(e.otherCreditsCharges,b,j);
return l
};
BasketService.parseDevicePick=function(e,b,f,d){if(!f){return null
}var c=new DevicePickObj();
c.setId(e);
c.setMainPickId(b);
c.setDeviceName(f.deviceName);
c.setDeviceModel(f.deviceModel);
c.setDeviceCategory(f.deviceCategory);
c.setDeviceType(f.deviceType);
c.setDeviceSubType(f.deviceSubType);
c.setDevicePartNum(f.devicePartNum);
c.setDeviceBrand(f.deviceBrand);
c.setDevicePrice(f.devicePrice);
if(f.deviceVariants&&f.deviceVariants.deviceVariant&&f.deviceVariants.deviceVariant.length>0&&f.deviceVariants.deviceVariant[0]){c.setDeviceStockCode(f.deviceVariants.deviceVariant[0].deviceStockCode)
}if(f.deviceOffers&&f.deviceOffers.deviceOffer&&f.deviceOffers.deviceOffer.length>0&&f.deviceOffers.deviceOffer[0]&&(typeof f.deviceOffers.deviceOffer[0].devicePrice==="number")){c.setDeviceOfferDevicePrice(f.deviceOffers.deviceOffer[0].devicePrice)
}c.setDepositList([]);
BasketService.parseOcc(d.otherCreditsCharges,function(g){if(g.getType()===BasketService.CONSTANTS.OCC_CHARGE_TYPE.DEPOSIT){c.getDepositList().push(g)
}},function(g){if(g.getType()===BasketService.CONSTANTS.OCC_WAIVER_TYPE.VOUCHER){c.setVoucher(g)
}});
c.setStockResCode(d.stockResCode);
var a=PriceCalService.calculateDevicePrice(c.getDevicePrice(),c.getDeviceOfferDevicePrice());
c.setCalculatedPrice(a);
return c
};
BasketService.parseResourcePick=function(j,g,k,e){if(!k){return null
}var b=new ResourcePickObj();
b.setId(j);
b.setMainPickId(g);
if(k.msisdnInfo){b.setNumber(k.msisdnInfo.number);
b.setSIMType(k.msisdnInfo.simtype);
b.setIMSI(k.msisdnInfo.imsi)
}if(e.otherCreditsCharges){if(e.otherCreditsCharges.waiver&&e.otherCreditsCharges.waiver.length>=0&&e.otherCreditsCharges.waiver[0]){var a=e.otherCreditsCharges.waiver[0];
b.setWaiverName(a.name);
b.setWaiverAppliedTo(a.appliedTo);
b.setWaiverStockCode(a.waiveStockCode);
var d=a.waiveValue;
if(d){b.setWaiverValue(d.value);
b.setWaiverType(d.type)
}}if(e.otherCreditsCharges.charge&&e.otherCreditsCharges.charge.length>=0&&e.otherCreditsCharges.charge[0]){var f=e.otherCreditsCharges.charge[0];
b.setChargeName(f.name);
b.setChargeStockCode(f.chargeStockCode);
var h=f.chargeValue;
if(h){b.setChargeValue(h.value);
b.setChargeType(h.type)
}}}b.setStockResCode(e.stockResCode);
var c=PriceCalService.calculateResourcePrice(b.getChargeType(),b.getChargeValue(),b.getWaiverType(),b.getWaiverValue());
b.setCalculatedPrice(c);
return b
};
BasketService.parsePlanPick=function(f,c,e){if(!e){return null
}var d=new PlanPickObj();
d.setId(f);
d.setMainPickId(c);
d.setProdType(e.prodType);
d.setPartNum(e.partNum);
d.setProdName(e.prodName);
d.setMRC(e.mrc);
if(e.commercialOffers&&e.commercialOffers.commercialOffer&&e.commercialOffers.commercialOffer.length>=0&&e.commercialOffers.commercialOffer[0]&&e.commercialOffers.commercialOffer[0].discount){var g=e.commercialOffers.commercialOffer[0].discount;
d.setDiscountAppliedTo(g.appliedTo);
if(g.discValue){var b=g.discValue;
d.setDiscountValue(b.value);
d.setDiscountType(b.type)
}}var a=PriceCalService.calculatePlanMRC(d.getMRC(),d.getDiscountAppliedTo(),d.getDiscountType(),d.getDiscountValue());
d.setCalculatedMRC(a);
return d
};
BasketService.parseVASPick=function(d,a,c){if(!c){return null
}var b=new VasPickObj();
b.setId(d);
b.setMainPickId(a);
b.setPartNum(c.partNum);
b.setProdName(c.prodName);
b.setProdDisplayName(c.prodDisplayName);
b.setMRC(c.mrc);
b.setOTC(c.otc);
if(c.select){b.setSelect(c.select.value);
b.setSuppress(c.select.suppress)
}if(c.prodGroup&&c.prodGroup.value){b.setProdType(c.prodGroup.value)
}return b
};
BasketService.parseOcc=function(f,c,d){if(f){if(f.charge){for(var b=0;
b<f.charge.length;
b++){var e=BasketService.parseOccCharge(f.charge[b]);
c.call(null,e)
}}if(f.waiver){for(var b=0;
b<f.waiver.length;
b++){var a=BasketService.parseOccWaiver(f.waiver[b]);
d.call(null,a)
}}}};
BasketService.parseOccCharge=function(c){var b=new OccChargeObj();
if(c){b.setChargeName(c.name);
b.setChargeStockCode(c.chargeStockCode);
var a=c.chargeValue;
if(a){b.setChargeValue(a.value);
b.setChargeType(a.type)
}}return b
};
BasketService.parseOccWaiver=function(b){var c=new OccWaiverObj();
if(b){c.setWaiverName(b.name);
c.setWaiverAppliedTo(b.appliedTo);
c.setWaiverStockCode(b.waiveStockCode);
var a=b.waiveValue;
if(a){c.setWaiverValue(a.value);
c.setWaiverType(a.type)
}}return c
};
var SubscriptionPickObj=function SubscriptionPickObj(){};
SubscriptionPickObj.prototype.getId=function(){return this.id
};
SubscriptionPickObj.prototype.setId=function(a){this.id=a
};
SubscriptionPickObj.prototype.getType=function(){return this.type
};
SubscriptionPickObj.prototype.setType=function(a){this.type=a
};
SubscriptionPickObj.prototype.getPartNum=function(){return this.partNum
};
SubscriptionPickObj.prototype.setPartNum=function(a){this.partNum=a
};
SubscriptionPickObj.prototype.getDeviceCategory=function(){return this.deviceCategory
};
SubscriptionPickObj.prototype.setDeviceCategory=function(a){this.deviceCategory=a
};
SubscriptionPickObj.prototype.getBillingAccountId=function(){return this.billingAccountId
};
SubscriptionPickObj.prototype.setBillingAccountId=function(a){this.billingAccountId=a
};
SubscriptionPickObj.prototype.getBillingAccountNo=function(){return this.billingAccountNo
};
SubscriptionPickObj.prototype.setBillingAccountNo=function(a){this.billingAccountNo=a
};
SubscriptionPickObj.prototype.setBillingAddress=function(a){this.billingAddress=a
};
SubscriptionPickObj.prototype.getBillingAddress=function(){return this.billingAddress
};
SubscriptionPickObj.prototype.getContractServiceId=function(){return this.contractServiceId
};
SubscriptionPickObj.prototype.setContractServiceId=function(a){this.contractServiceId=a
};
SubscriptionPickObj.prototype.getContractPlanPartNum=function(){return this.contractPlanPartNum
};
SubscriptionPickObj.prototype.setContractPlanPartNum=function(a){this.contractPlanPartNum=a
};
SubscriptionPickObj.prototype.getContractModeOfService=function(){return this.contractModeOfService
};
SubscriptionPickObj.prototype.setContractModeOfService=function(a){this.contractModeOfService=a
};
SubscriptionPickObj.prototype.getContractTypeOfPlan=function(){return this.contractTypeOfPlan
};
SubscriptionPickObj.prototype.setContractTypeOfPlan=function(a){this.contractTypeOfPlan=a
};
SubscriptionPickObj.prototype.getERF=function(){return this.eRF
};
SubscriptionPickObj.prototype.setERF=function(a){this.eRF=a
};
SubscriptionPickObj.prototype.getVoucher=function(){return this.voucher
};
SubscriptionPickObj.prototype.setVoucher=function(a){this.voucher=a
};
SubscriptionPickObj.prototype.setHubClubDiscountWaiver=function(a){this.hubClubDiscountWaiver=a
};
SubscriptionPickObj.prototype.getHubClubDiscountWaiver=function(){return this.hubClubDiscountWaiver
};
SubscriptionPickObj.prototype.getDepositList=function(){return this.depositList
};
SubscriptionPickObj.prototype.setDepositList=function(a){this.depositList=a
};
var DevicePickObj=function DevicePickObj(){};
DevicePickObj.prototype.getDeviceOfferPlanPartNum=function(){return this.deviceOfferPlanPartNum
};
DevicePickObj.prototype.setDeviceOfferPlanPartNum=function(a){this.deviceOfferPlanPartNum=a
};
DevicePickObj.prototype.getDeviceOfferDevicePrice=function(){return this.deviceOfferDevicePrice
};
DevicePickObj.prototype.setDeviceOfferDevicePrice=function(a){this.deviceOfferDevicePrice=a
};
DevicePickObj.prototype.getDeviceSubType=function(){return this.deviceSubType
};
DevicePickObj.prototype.setDeviceSubType=function(a){this.deviceSubType=a
};
DevicePickObj.prototype.getId=function(){return this.id
};
DevicePickObj.prototype.setId=function(a){this.id=a
};
DevicePickObj.prototype.getMainPickId=function(){return this.mainPickId
};
DevicePickObj.prototype.setMainPickId=function(a){this.mainPickId=a
};
DevicePickObj.prototype.getDeviceName=function(){return this.deviceName
};
DevicePickObj.prototype.setDeviceName=function(a){this.deviceName=a
};
DevicePickObj.prototype.getDeviceModel=function(){return this.deviceModel
};
DevicePickObj.prototype.setDeviceModel=function(a){this.deviceModel=a
};
DevicePickObj.prototype.getDeviceCategory=function(){return this.deviceCategory
};
DevicePickObj.prototype.setDeviceCategory=function(a){this.deviceCategory=a
};
DevicePickObj.prototype.getDeviceType=function(){return this.deviceType
};
DevicePickObj.prototype.setDeviceType=function(a){this.deviceType=a
};
DevicePickObj.prototype.getDevicePartNum=function(){return this.devicePartNum
};
DevicePickObj.prototype.setDevicePartNum=function(a){this.devicePartNum=a
};
DevicePickObj.prototype.getDeviceBrand=function(){return this.deviceBrand
};
DevicePickObj.prototype.setDeviceBrand=function(a){this.deviceBrand=a
};
DevicePickObj.prototype.getDevicePrice=function(){return this.devicePrice
};
DevicePickObj.prototype.setDevicePrice=function(a){this.devicePrice=a
};
DevicePickObj.prototype.getDeviceSerialNo=function(){return this.deviceSerialNo
};
DevicePickObj.prototype.setDeviceSerialNo=function(a){this.deviceSerialNo=a
};
DevicePickObj.prototype.getDepositList=function(){return this.depositList
};
DevicePickObj.prototype.setDepositList=function(a){this.depositList=a
};
DevicePickObj.prototype.getVoucher=function(){return this.voucher
};
DevicePickObj.prototype.setVoucher=function(a){this.voucher=a
};
DevicePickObj.prototype.getCalculatedPrice=function(){return this.calculatedPrice
};
DevicePickObj.prototype.setCalculatedPrice=function(a){this.calculatedPrice=a
};
DevicePickObj.prototype.getCalPriceAfterVoucher=function(){if(this.getVoucher()){var a=PriceCalService.calculateOccPrice(this.getVoucher().getWaiverType(),this.getVoucher().getWaiverValue(),this.getCalculatedPrice());
var b=this.getCalculatedPrice()-a;
return(b>0?b:0)
}else{return this.getCalculatedPrice()
}};
DevicePickObj.prototype.getStockResCode=function(){return this.stockResCode
};
DevicePickObj.prototype.setStockResCode=function(a){this.stockResCode=a
};
DevicePickObj.prototype.getDeviceStockCode=function(){return this.deviceStockCode
};
DevicePickObj.prototype.setDeviceStockCode=function(a){this.deviceStockCode=a
};
var ResourcePickObj=function ResourcePickObj(){};
ResourcePickObj.prototype.getChargeName=function(){return this.chargeName
};
ResourcePickObj.prototype.setChargeName=function(a){this.chargeName=a
};
ResourcePickObj.prototype.getNumber=function(){return this.number
};
ResourcePickObj.prototype.setNumber=function(a){this.number=a
};
ResourcePickObj.prototype.getIMSI=function(){return this.IMSI
};
ResourcePickObj.prototype.setIMSI=function(a){this.IMSI=a
};
ResourcePickObj.prototype.getId=function(){return this.id
};
ResourcePickObj.prototype.setId=function(a){this.id=a
};
ResourcePickObj.prototype.getMainPickId=function(){return this.mainPickId
};
ResourcePickObj.prototype.setMainPickId=function(a){this.mainPickId=a
};
ResourcePickObj.prototype.getSIMType=function(){return this.SIMType
};
ResourcePickObj.prototype.setSIMType=function(a){this.SIMType=a
};
ResourcePickObj.prototype.getChargeStockCode=function(){return this.chargeStockCode
};
ResourcePickObj.prototype.setChargeStockCode=function(a){this.chargeStockCode=a
};
ResourcePickObj.prototype.getChargeType=function(){return this.chargeType
};
ResourcePickObj.prototype.setChargeType=function(a){this.chargeType=a
};
ResourcePickObj.prototype.getChargeValue=function(){return this.chargeValue
};
ResourcePickObj.prototype.setChargeValue=function(a){this.chargeValue=a
};
ResourcePickObj.prototype.getWaiverAppliedTo=function(){return this.waiverAppliedTo
};
ResourcePickObj.prototype.setWaiverAppliedTo=function(a){this.waiverAppliedTo=a
};
ResourcePickObj.prototype.getWaiverName=function(){return this.waiverName
};
ResourcePickObj.prototype.setWaiverName=function(a){this.waiverName=a
};
ResourcePickObj.prototype.getWaiverType=function(){return this.waiverType
};
ResourcePickObj.prototype.setWaiverType=function(a){this.waiverType=a
};
ResourcePickObj.prototype.getWaiverValue=function(){return this.waiverValue
};
ResourcePickObj.prototype.setWaiverValue=function(a){this.waiverValue=a
};
ResourcePickObj.prototype.getWaiverStockCode=function(){return this.waiverStockCode
};
ResourcePickObj.prototype.setWaiverStockCode=function(a){this.waiverStockCode=a
};
ResourcePickObj.prototype.getCalculatedPrice=function(){return this.calculatedPrice
};
ResourcePickObj.prototype.setCalculatedPrice=function(a){this.calculatedPrice=a
};
ResourcePickObj.prototype.getStockResCode=function(){return this.stockResCode
};
ResourcePickObj.prototype.setStockResCode=function(a){this.stockResCode=a
};
var PlanPickObj=function PlanPickObj(){};
PlanPickObj.prototype.getId=function(){return this.id
};
PlanPickObj.prototype.setId=function(a){this.id=a
};
PlanPickObj.prototype.getMainPickId=function(){return this.mainPickId
};
PlanPickObj.prototype.setMainPickId=function(a){this.mainPickId=a
};
PlanPickObj.prototype.getPartNum=function(){return this.partNum
};
PlanPickObj.prototype.setPartNum=function(a){this.partNum=a
};
PlanPickObj.prototype.getProdName=function(){return this.prodName
};
PlanPickObj.prototype.setProdName=function(a){this.prodName=a
};
PlanPickObj.prototype.getMRC=function(){return this.mrc
};
PlanPickObj.prototype.setMRC=function(a){this.mrc=a
};
PlanPickObj.prototype.getProdType=function(){return this.prodType
};
PlanPickObj.prototype.setProdType=function(a){this.prodType=a
};
PlanPickObj.prototype.getDiscountAppliedTo=function(){return this.discountAppliedTo
};
PlanPickObj.prototype.setDiscountAppliedTo=function(a){this.discountAppliedTo=a
};
PlanPickObj.prototype.getDiscountType=function(){return this.discountType
};
PlanPickObj.prototype.setDiscountType=function(a){this.discountType=a
};
PlanPickObj.prototype.getDiscountValue=function(){return this.discountValue
};
PlanPickObj.prototype.setDiscountValue=function(a){this.discountValue=a
};
PlanPickObj.prototype.getCalculatedMRC=function(){return this.calculatedMRC
};
PlanPickObj.prototype.setCalculatedMRC=function(a){this.calculatedMRC=a
};
var VasPickObj=function VasPickObj(){};
VasPickObj.prototype.getId=function(){return this.id
};
VasPickObj.prototype.setId=function(a){this.id=a
};
VasPickObj.prototype.getMainPickId=function(){return this.mainPickId
};
VasPickObj.prototype.setMainPickId=function(a){this.mainPickId=a
};
VasPickObj.prototype.getPartNum=function(){return this.partNum
};
VasPickObj.prototype.setPartNum=function(a){this.partNum=a
};
VasPickObj.prototype.getProdName=function(){return this.prodName
};
VasPickObj.prototype.setProdName=function(a){this.prodName=a
};
VasPickObj.prototype.getProdDisplayName=function(){return this.prodDisplayName
};
VasPickObj.prototype.setProdDisplayName=function(a){this.prodDisplayName=a
};
VasPickObj.prototype.getProdGroup=function(){return this.prodGroup
};
VasPickObj.prototype.setProdGroup=function(a){this.prodGroup=a
};
VasPickObj.prototype.getMRC=function(){return this.MRC
};
VasPickObj.prototype.setMRC=function(a){this.MRC=a
};
VasPickObj.prototype.getOTC=function(){return this.OTC
};
VasPickObj.prototype.setOTC=function(a){this.OTC=a
};
VasPickObj.prototype.getProdType=function(){return this.prodType
};
VasPickObj.prototype.setProdType=function(a){this.prodType=a
};
VasPickObj.prototype.getSelect=function(){return this.select
};
VasPickObj.prototype.setSelect=function(a){this.select=a
};
VasPickObj.prototype.getSuppress=function(){return this.suppress
};
VasPickObj.prototype.setSuppress=function(a){this.suppress=a
};
var OfferPickObj=function OfferPickObj(){};
OfferPickObj.prototype.getOfferId=function(){return this.offerId
};
OfferPickObj.prototype.setOfferId=function(a){this.offerId=a
};
OfferPickObj.prototype.getOfferType=function(){return this.offerType
};
OfferPickObj.prototype.setOfferType=function(a){this.offerType=a
};
OfferPickObj.prototype.getOfferServiceId=function(){return this.offerServiceId
};
OfferPickObj.prototype.setOfferServiceId=function(a){this.offerServiceId=a
};
OfferPickObj.prototype.getOfferStatus=function(){return this.offerStatus
};
OfferPickObj.prototype.setOfferStatus=function(a){this.offerStatus=a
};
OfferPickObj.prototype.getOfferSerialNum=function(){return this.offerSerialNum
};
OfferPickObj.prototype.setOfferSerialNum=function(a){this.offerSerialNum=a
};
OfferPickObj.prototype.getOfferStart=function(){return this.offerStart
};
OfferPickObj.prototype.setOfferStart=function(a){this.offerStart=a
};
OfferPickObj.prototype.getOfferExpiry=function(){return this.offerExpiry
};
OfferPickObj.prototype.setOfferExpiry=function(a){this.offerExpiry=a
};
OfferPickObj.prototype.getOfferReference=function(){return this.offerReference
};
OfferPickObj.prototype.setOfferReference=function(a){this.offerReference=a
};
var OccChargeObj=function OccChargeObj(){};
OccChargeObj.prototype.getChargeName=function(){return this.chargeName
};
OccChargeObj.prototype.setChargeName=function(a){this.chargeName=a
};
OccChargeObj.prototype.getChargeStockCode=function(){return this.chargeStockCode
};
OccChargeObj.prototype.setChargeStockCode=function(a){this.chargeStockCode=a
};
OccChargeObj.prototype.getChargeType=function(){return this.chargeType
};
OccChargeObj.prototype.setChargeType=function(a){this.chargeType=a
};
OccChargeObj.prototype.getChargeValue=function(){return this.chargeValue
};
OccChargeObj.prototype.setChargeValue=function(a){this.chargeValue=a
};
OccChargeObj.prototype.getType=function(){if($.inArray(this.chargeStockCode,BasketService.CONSTANTS.ERF_CHARGE_STOCKCODE_SET)!==-1){return BasketService.CONSTANTS.OCC_CHARGE_TYPE.ERF
}else{if($.inArray(this.chargeStockCode,BasketService.CONSTANTS.DEPOSIT_CHARGE_STOCKCODE_SET)!==-1){return BasketService.CONSTANTS.OCC_CHARGE_TYPE.DEPOSIT
}}};
var OccWaiverObj=function OccWaiverObj(){};
OccWaiverObj.prototype.getWaiverAppliedTo=function(){return this.waiverAppliedTo
};
OccWaiverObj.prototype.setWaiverAppliedTo=function(a){this.waiverAppliedTo=a
};
OccWaiverObj.prototype.getWaiverName=function(){return this.waiverName
};
OccWaiverObj.prototype.setWaiverName=function(a){this.waiverName=a
};
OccWaiverObj.prototype.getWaiverType=function(){return this.waiverType
};
OccWaiverObj.prototype.setWaiverType=function(a){this.waiverType=a
};
OccWaiverObj.prototype.getWaiverValue=function(){return this.waiverValue
};
OccWaiverObj.prototype.setWaiverValue=function(a){this.waiverValue=a
};
OccWaiverObj.prototype.getWaiverStockCode=function(){return this.waiverStockCode
};
OccWaiverObj.prototype.setWaiverStockCode=function(a){this.waiverStockCode=a
};
OccWaiverObj.prototype.getType=function(){if(this.waiverName&&BasketService.CONSTANTS.VOUCHER_WAIVER_NAME===this.waiverName.toLowerCase()){return BasketService.CONSTANTS.OCC_WAIVER_TYPE.VOUCHER
}};
var PriceCalService=PriceCalService||{};
PriceCalService.CONSTANTS={OCC_TYPE:{ABS:"abs",REL:"rel"},MRC:"mrc"};
PriceCalService.calculateDevicePrice=function(b,c){if(typeof c==="number"){var a=c
}else{if(typeof b==="number"){var a=b
}else{return null
}}a=PriceCalService.preciseRound(a,2);
return a
};
PriceCalService.calculateResourcePrice=function(e,b,d,c){if(e&&(PriceCalService.CONSTANTS.OCC_TYPE.ABS===e.toLowerCase())&&(typeof b==="number")){var a=b;
if(d&&(PriceCalService.CONSTANTS.OCC_TYPE.ABS===d.toLowerCase())&&(typeof c==="number")){a-=c
}else{if(d&&(PriceCalService.CONSTANTS.OCC_TYPE.REL===d.toLowerCase())&&(typeof c==="number")){a=(a-a*(c/100))
}}a=PriceCalService.preciseRound(a,2);
if(a<0){return 0
}else{return a
}}else{return null
}};
PriceCalService.calculatePlanMRC=function(b,d,c,e){if(!d||!c||(typeof e!=="number")){return b
}if((typeof b==="number")&&(PriceCalService.CONSTANTS.MRC===d.toLowerCase())){var a=b;
if((PriceCalService.CONSTANTS.OCC_TYPE.ABS===c.toLowerCase())&&(typeof e==="number")){a-=e
}else{if((PriceCalService.CONSTANTS.OCC_TYPE.REL===c.toLowerCase())&&(typeof e==="number")){a=(a-a*(e/100))
}}a=PriceCalService.preciseRound(a,2);
if(a<0){return 0
}else{return a
}}else{return b
}};
PriceCalService.preciseRound=function(b,a){return(Math.round(b*Math.pow(10,a))/Math.pow(10,a))
};
PriceCalService.calculateOneOrderTotalPrice=function(b){var a=0;
var e=b.getDevicePick();
if(e){if(typeof e.getCalPriceAfterVoucher()==="number"){a+=e.getCalPriceAfterVoucher()
}}var d=b.getResourcePick();
if(d){if(typeof d.getCalculatedPrice()==="number"){a+=d.getCalculatedPrice()
}}var f=b.getAccessoryPickList();
for(var c=0;
c<f.length;
c++){if(typeof f[c].getCalPriceAfterVoucher()==="number"){a+=f[c].getCalPriceAfterVoucher()
}}a=a+b.getERF()+b.getDeposit();
a=PriceCalService.preciseRound(a,2);
return a
};
PriceCalService.calculateOneOrderTotalMRC=function(a){var d=0;
var c=a.getPlanPick();
if(c){if(typeof c.getCalculatedMRC()==="number"){d+=c.getCalculatedMRC()
}}var e=a.getVasPickList();
for(var b=0;
b<e.length;
b++){if((typeof e[b].getMRC()==="number")&&(e[b].getSelect()===true)){d+=e[b].getMRC()
}}d=PriceCalService.preciseRound(d,2);
return d
};
PriceCalService.calculateBasketTotalPrice=function(c){var b=0;
var d=c.getBasketOrderMap();
for(var a in d){if(d.hasOwnProperty(a)){var e=d[a];
if(typeof e.getTotalPrice()==="number"){b+=e.getTotalPrice()
}}}return b
};
PriceCalService.calculateOneOrderVoucherPrice=function(a){var e=a.getDevicePick();
var f=a.getAccessoryPickList();
var d=0;
if(e&&e.getVoucher()){d+=PriceCalService.calculateOccPrice(e.getVoucher().getWaiverType(),e.getVoucher().getWaiverValue(),e.getCalculatedPrice())
}for(var c=0;
c<f.length;
c++){if(f[c].getVoucher()){var b=f[c].getVoucher();
d+=PriceCalService.calculateOccPrice(b.getWaiverType(),b.getWaiverValue(),f[c].getCalculatedPrice())
}}return(PriceCalService.preciseRound(d,2))
};
PriceCalService.calculateOneOrderERF=function(a){var c=a.getSubscriptionPick();
var b=0;
if(a.hasERF()){if(c.getVoucher()){b=0
}else{if(c.getHubClubDiscountWaiver()){if(c.getHubClubDiscountWaiver().waiverName==BasketService.CONSTANTS.WAIVER_NAME.HUBCLUB_DISCOUNT_WAIVER){b=c.getERF().getChargeValue()-c.getHubClubDiscountWaiver().waiverValue;
b=b>0?b:0
}}else{b=c.getERF().getChargeValue()
}}}return(PriceCalService.preciseRound(b,2))
};
PriceCalService.calculateOneOrderDeposit=function(a){var d=a.getSubscriptionPick();
var c=a.getDevicePick();
var b=0;
if(d){b+=PriceCalService.calculateDepositSum(d.getDepositList())
}if(c){b+=PriceCalService.calculateDepositSum(c.getDepositList(),c.getCalculatedPrice())
}return PriceCalService.preciseRound(b,2)
};
PriceCalService.calculateDepositSum=function(d,a){var c=0;
for(var b=0;
b<d.length;
b++){c+=PriceCalService.calculateOccPrice(d[b].getChargeType(),d[b].getChargeValue(),a)
}return c
};
PriceCalService.calculateOccPrice=function(c,a,b){if(c&&(typeof a==="number")){if(PriceCalService.CONSTANTS.OCC_TYPE.ABS===c.toLowerCase()){return PriceCalService.preciseRound(a,2)
}else{if(PriceCalService.CONSTANTS.OCC_TYPE.REL===c.toLowerCase()&&(typeof b==="number")){return PriceCalService.preciseRound((b*a/100),2)
}else{return 0
}}}else{return 0
}};
var sideBar=sideBar||{};
sideBar.getSideBarCart=function(b){var a=BasketService.getBasket(b);
return sideBar.generateHTML(a)
};
sideBar.getTotalBillCart=function(a){basketObj=BasketService.getBasket(a);
return baseUrl.roundingPrice(basketObj.getTotalPrice()).toFixed(2)
};
sideBar.generateHTML=function(b){var c="";
var f=b.getBasketOrderMap();
var d=0;
for(var a in f){if(f.hasOwnProperty(a)){var g=f[a];
var e="";
if(g.getOrderType()==BasketService.CONSTANTS.ORDER_TYPE.RECONTRACT){e="Mobile Line Recontract for "+g.getSubscriptionPick().getContractServiceId()
}else{if(g.getOrderType()==BasketService.CONSTANTS.ORDER_TYPE.NEW_SIGN_UP){e="New Line Sign-Up "
}else{if(g.getOrderType()==BasketService.CONSTANTS.ORDER_TYPE.BILL_REBATE){e="Bill Rebate"
}else{e="Unknown Order"
}}}c+='<li class="summary-item completed"><div class="summary-number-wrapper"><span class="icon"></span><span class="summary-number">'+(d+1)+'</span></div><div class="summary-item-desc"><div class="summary-item-desc-inner"><h5>'+e+'</h5><p class="price">$'+baseUrl.roundingPrice(g.getTotalPrice()).toFixed(2)+" (incl. GST)</p></div></div></li>";
d++
}}return c
};
var contractBox=contractBox||{};
contractBox.vars={lines:[],basketChecked:false,trayOfferChecked:false,underCheckingLine:0,isOnlyBillRebate:false,basketDataGet:false,trayDataGet:false,basketData:{},isHubClubMember:false,ecStarted:false};
contractBox.CONSTANTS={TypeOfPlan:"Type of Plan",ModeOfService:"Mode of Service",BILL_REBATE_VALUE_CHECK:"Bill Rebate Value Check",MULTISIM_BLOCK_LIST:["MOBL-10127","MOBL-10124"],FAMILY_SHARE_VAS:["MOBL-10040","MOBL-10039"],NFC_BLOCK:["MOBL-10299","MOBL-10300"],EMPLOYEE_PLAN_BLOCK_LIST:["MOBL-10019_2GSTAND","MOBL-10019_4GSTAND"],FAMILY_SHARE_PLAN_BLOCK_LIST:["MOBL-10354_4GFSMAIN","MOBL-10354_4GFSCHILD","MOBL-10356_4GFSMAIN","MOBL-10356_4GFSCHILD","MOBL-10355_4GFSMAIN","MOBL-10355_4GFSCHILD","MOBL-10225_3GFSMAIN","MOBL-10225_3GFSCHILD","MOBL-10224_3GFSMAIN","MOBL-10224_3GFSCHILD","MOBL-10010_2GFSMAIN","MOBL-10010_3GFSMAIN","MOBL-10010_2GFSCHILD","MOBL-10010_3GFSCHILD","MOBL-10015_2GFSMAIN","MOBL-10015_3GFSMAIN","MOBL-10015_2GFSCHILD","MOBL-10015_3GFSCHILD","MOBL-10354_3GFSMAIN","MOBL-10354_3GFSCHILD","MOBL-10356_3GFSMAIN","MOBL-10356_3GFSCHILD","MOBL-10355_3GFSMAIN","MOBL-10355_3GFSCHILD","MOBL-10017_2GFSMAIN","MOBL-10017_3GFSMAIN","MOBL-10017_2GFSCHILD","MOBL-10017_3GFSCHILD","MOBL-10016_2GFSMAIN","MOBL-10016_3GFSMAIN","MOBL-10016_2GFSCHILD","MOBL-10016_3GFSCHILD","MOBL-10014_2GFSMAIN","MOBL-10014_3GFSMAIN","MOBL-10014_2GFSCHILD","MOBL-10014_3GFSCHILD","MOBL-10017_4GFSMAIN","MOBL-10017_4GFSCHILD","MOBL-10224_4GFSMAIN","MOBL-10224_4GFSCHILD","MOBL-10015_4GFSMAIN","MOBL-10015_4GFSCHILD","MOBL-10010_4GFSMAIN","MOBL-10010_4GFSCHILD","MOBL-10225_4GFSMAIN","MOBL-10225_4GFSCHILD","MOBL-10016_4GFSMAIN","MOBL-10016_4GFSCHILD","MOBL-10014_4GFSMAIN","MOBL-10014_4GFSCHILD","MOBL-10353_4GFSMAIN","MOBL-10353_4GFSCHILD","MOBL-10327_2GFSMAIN","MOBL-10327_3GFSMAIN","MOBL-10327_4GFSMAIN","MOBL-10327_2GFSCHILD","MOBL-10327_3GFSCHILD","MOBL-10327_4GFSCHILD","MOBL-10325_2GFSMAIN","MOBL-10325_3GFSMAIN","MOBL-10325_4GFSMAIN","MOBL-10325_2GFSCHILD","MOBL-10325_3GFSCHILD","MOBL-10325_4GFSCHILD","MOBL-10326_2GFSMAIN","MOBL-10326_3GFSMAIN","MOBL-10326_4GFSMAIN","MOBL-10326_2GFSCHILD","MOBL-10326_3GFSCHILD","MOBL-10326_4GFSCHILD"],FREE_MBDP_BLOCK_LIST:["MOBL-10284_2GSTAND","MOBL-10284_3GSTAND","MOBL-10038_3GSTAND","MOBL-10037_3GSTAND","MOBL-10284_4GSTAND","MOBL-10037_4GSTAND","MOBL-10038_4GSTAND"]};
contractBox.genPhoneLines=function(a){var b='<li><div class="recontract-details"><label class="custom-radiobutton"><input type="radio" name="recontract-selection" onclick="cq_analyst_fn(5)"';
if(contractBox.vars.isOnlyBillRebate){if(!a.billRebateEligible){b+='disabled="true"/>'
}else{b+="/>"
}}else{if(!a.reconEligible){b+='disabled="true"/>'
}else{b+="/>"
}}b+='<span class="phone-number">'+phoneNumberToString(a.serviceId)+'</span></label><div class="recontract-details-inner">';
if(!contractBox.vars.isOnlyBillRebate&&a.reconEligible&&a.earlyCharge>0){b+='<div class="recontract-date">Contract ends <span class="date">'+a.endDate+"</span>.</div>"
}b+='<span class="recontract-status">';
if(!contractBox.vars.isOnlyBillRebate){if(!a.reconEligible){b+=onlinestore.MSG.NOT_ELIGIBLE_FOR_RECONTRACT
}else{if(a.reconEligible&&a.earlyCharge>0){if(a.hasRecontractVoucher){b+=onlinestore.MSG.MODAL_HAS_RECONTRACT_VOUCHER
}else{if(a.hubClubDiscountEligible){b+=onlinestore.MSG.MODAL_ELIGIBLE_FOR_HUB_CLUB_DISCOUNT;
$("#hubClubDisclaimer").show()
}else{b+=onlinestore.MSG.LISTING_PAGE_RECONTRACT_WITH_A_FEE
}}}else{b+=onlinestore.MSG.ELIGIBLE_FOR_RECONTRACT
}}}else{if(!a.billRebateEligible){b+=onlinestore.MSG.NOT_ELIGIBLE_FOR_BILLREBATE
}else{b+=onlinestore.MSG.ELIGIBLE_FOR_BILLREBATE
}}b+="</span>";
b+='</div></div><div class="recontract-btn-wrapper">';
if(a.isInBasket){b+='<a href="'+baseUrl.cartSummary+'" class="btn-secondaryGreen-rarrow btn-modal-purchase-phone"  onclick="cq_analyst_fn(12)"><span class="icon"></span>View existing order</a>'
}else{if(a.billRebateEligible){b+='<a href="javascript:contractBox.submitForm('+a.serviceId+', 0)" class="btn-secondaryGreen-rarrow btn-modal-apply-bill-rebate" onclick="cq_analyst_fn(12)"><span class="icon"></span>Apply for Bill Rebates</a>'
}if(!contractBox.vars.isOnlyBillRebate){b+='<a href="javascript:contractBox.submitForm('+a.serviceId+', 1)" class="btn-secondaryGreen-rarrow btn-modal-purchase-phone" onclick="cq_analyst_fn(11)"><span class="icon"></span>Recontract Now</a>'
}}b+="</div></li>";
return b
};
contractBox.hideForLoading=function(){$(".recontract.modal-content").hide();
_SH.Components.Loading.Show($(".recontract"))
};
contractBox.showAfterLoading=function(){$(".modal-content").show();
_SH.Components.Loading.Hide($(".recontract"));
if(contractBox.vars.isOnlyBillRebate){$(".btn-close-colorbox").show()
}};
contractBox.tryGenModalHtml=function(){if(!contractBox.vars.ecStarted||contractBox.vars.underCheckingLine!=0||!contractBox.vars.basketChecked||!contractBox.vars.trayOfferChecked){return
}var d="";
linesEligibleForRecontract=0;
linesEligibleForBillRebate=0;
for(var b=0;
b<contractBox.vars.lines.length;
b++){if(contractBox.vars.lines[b].reconEligible){linesEligibleForRecontract+=1
}if(contractBox.vars.lines[b].billRebateEligible){linesEligibleForBillRebate+=1
}d+=contractBox.genPhoneLines(contractBox.vars.lines[b])
}var a=$("div.modal-content form ul.modal-recontract-inner");
var c=$("div.modal-header");
if(!contractBox.vars.isOnlyBillRebate){if(linesEligibleForRecontract>0){c.empty().append("<h2>"+onlinestore.MSG.RECONTRACT_HEADER_FOR_HAS_LINE_ELIGIBLE+"</h2>")
}else{c.empty().append("<h2>"+onlinestore.MSG.RECONTRACT_HEADER_FOR_NO_LINE_ELIGIBLE+"</h2>")
}}else{if(linesEligibleForBillRebate>0){c.empty().append("<h2>"+onlinestore.MSG.BILLREBATE_HEADER_FOR_HAS_LINE_ELIGIBLE+"</h2>")
}else{c.empty().append("<h2>"+onlinestore.MSG.BILLREBATE_HEADER_FOR_NO_LINE_ELIGIBLE+"</h2>")
}}contractBox.showAfterLoading();
a.empty().append(d);
_SH.Modals.recontract(a);
mobileService.triggerWindowResize()
};
contractBox.checkOneLineEligible=function(a,c){var b=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_RECONTRACT,a.serviceId,"POST",null,c);
b.done(function(f,g,e){var d=f.mainContext.present.any[0];
if(d.eligible==true){a.reconEligible=true
}else{if(d.eligible==false){a.reconEligible=false
}else{throwError({debug:"unknown recontract ec check value"})
}}if(d&&d.chargesApplicable&&d.chargesApplicable.erf&&d.chargesApplicable.erf.value!=undefined&&d.chargesApplicable.erf.waive!=undefined){a.earlyCharge=d.chargesApplicable.erf.value-d.chargesApplicable.erf.waive
}else{a.earlyCharge=0
}contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine-1;
contractBox.tryGenModalHtml()
});
b.fail(function(d,f,e){if(d.status==401){ajaxService.renewAuthKey(contractBox.checkOneLineBillRebateEligible,a)
}else{throwError()
}})
};
contractBox.getBillRebatePartNum=function(c){var b="";
if(c.executionDetails&&c.executionDetails.rule){var d=c.executionDetails.rule;
for(var a=0;
a<d.length;
a++){if(d[a].name&&d[a].name===contractBox.CONSTANTS.BILL_REBATE_VALUE_CHECK&&d[a].reason){b=d[a].reason.split("= ")[1];
break
}}}return b
};
contractBox.checkOneLineBillRebateEligible=function(a,c){var b=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_BILLREBATE,a.serviceId,"GET",null,c);
b.done(function(e,g,d){var f=e.mainContext.present.any;
if(f&&f.length>=0){a.billRebateEligible=f[0].eligible;
a.billRebatePartNum="";
if(a.billRebateEligible){a.billRebatePartNum=contractBox.getBillRebatePartNum(f[0]);
a.billrebateParam.params.billrebatepartnum=a.billRebatePartNum
}else{if(a.billRebateEligible==false){}else{throwError({debug:"unknown bill rebate ec check value"})
}}}else{a.billRebateEligible=false
}contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine-1;
contractBox.tryGenModalHtml()
});
b.fail(function(d,f,e){if(d.status==401){ajaxService.renewAuthKey(contractBox.checkOneLineBillRebateEligible,a)
}else{if(contractBox.vars.isOnlyBillRebate){throwError()
}else{throwError()
}}})
};
contractBox.checkOneLineHubClubDiscountEligible=function(a){var b=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_HUBCLUB_DISCOUNT,a.serviceId,"GET");
b.done(function(c){if(c&&c.mainContext&&c.mainContext.present&&c.mainContext.present.any&&c.mainContext.present.any[0]){a.hubClubDiscountEligible=c.mainContext.present.any[0].eligible;
contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine-1;
contractBox.tryGenModalHtml()
}else{throwError({debug:"hub club discount eligible check return invalid data."})
}});
b.fail(function(){throwError({debug:"call hub club erf waiver api failed."})
})
};
contractBox.checkEligible=function(){for(var a=0;
a<contractBox.vars.lines.length;
a++){if(!contractBox.vars.isOnlyBillRebate){contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine+1;
ajaxService.getAuthKey(contractBox.checkOneLineEligible,contractBox.vars.lines[a]);
if(contractBox.vars.isHubClubMember){contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine+1;
contractBox.checkOneLineHubClubDiscountEligible(contractBox.vars.lines[a])
}}else{contractBox.vars.underCheckingLine=contractBox.vars.underCheckingLine+1;
ajaxService.getAuthKey(contractBox.checkOneLineBillRebateEligible,contractBox.vars.lines[a])
}}contractBox.vars.ecStarted=true;
contractBox.tryGenModalHtml()
};
contractBox.submitForm=function(g,e,h,d){var a={};
var b=g+"";
for(var c=0;
c<contractBox.vars.lines.length;
c++){if($.trim(contractBox.vars.lines[c].serviceId)==$.trim(b)){a=contractBox.vars.lines[c];
break
}}if(a.blocked&&a.blocked.length>0){var f={};
f.failmsg=onlinestore.MSG.RECONTRACT_VAS_BLOCK(a.blocked);
f.yesButton=true;
f.yesButtonText="Continue with current plan";
f.yesButtonUrl="javascript:stopColorbox()";
throwError(f)
}else{if(a.isOldPlan&&(1==e)&&!h){var f={};
f.failmsg=onlinestore.MSG.LEGACY_PLAN(g,a.planName);
f.yesButton=true;
f.yesButtonText="Choose New Plan";
f.yesButtonUrl="javascript:contractBox.submitForm("+g+",1,true)";
f.noButton=true;
f.noButtonText="Cancel*";
f.noButtonUrl="javascript:stopColorbox()";
f.footNote=true;
throwError(f)
}else{if(0==e){postForm(a.billrebateParam)
}else{if(1==e){postForm(a.recontractParam)
}}}}};
contractBox.getPlanPartNum=function(e,a){var d="";
var c="";
for(var b=0;
b<a.length;
b++){if(a[b].svcParamName===contractBox.CONSTANTS.TypeOfPlan){c=a[b].svcParamValue
}if(a[b].svcParamName===contractBox.CONSTANTS.ModeOfService){d=a[b].svcParamValue
}}return{typeOfPlan:c,modOfService:d,planPartNum:e}
};
contractBox.testBlockHelper=function(a,e){var f,d,c,b;
for(f=0,c=e.length;
f<c;
f++){for(d=0,b=a.length;
d<b;
d++){if(e[f]===a[d]){return true
}}}return false
};
contractBox.getBlockedVas=function(e){var b=[];
if(e&&e.mobile&&e.mobile.services&&e.mobile.services.service){var c=e.mobile.services.service;
for(var d=0;
d<c.length;
d++){if(c[d].status!=undefined&&c[d].status!=null&&$.trim(c[d].status).toUpperCase()==="ACTIVE"){if(c[d].servicePartNum!=undefined&&c[d].servicePartNum!=null&&$.trim(c[d].servicePartNum)!=""){b.push(c[d].servicePartNum)
}}}}var a=[];
if(contractBox.testBlockHelper(b,contractBox.CONSTANTS.MULTISIM_BLOCK_LIST)){a.push("MultiSIM")
}if(contractBox.testBlockHelper(b,contractBox.CONSTANTS.FAMILY_SHARE_VAS)){a.push("Family Share")
}if(contractBox.testBlockHelper(b,contractBox.CONSTANTS.NFC_BLOCK)){a.push("NFC")
}return a
};
contractBox.isBlockedPlan=function(d,e){var c=d.planPartNum;
var f=e;
for(var b=0,a=f.length;
b<a;
b++){if(f[b]===c){return true
}}return false
};
contractBox.getBlockCase=function(b){var a=contractBox.getBlockedVas(b);
if(contractBox.isBlockedPlan(b,contractBox.CONSTANTS.EMPLOYEE_PLAN_BLOCK_LIST)){a.push("Employee Plan")
}if(contractBox.isBlockedPlan(b,contractBox.CONSTANTS.FAMILY_SHARE_PLAN_BLOCK_LIST)){if(a.join(",").indexOf("Family Share")<0){a.push("Family Share")
}}if(contractBox.isBlockedPlan(b,contractBox.CONSTANTS.FREE_MBDP_BLOCK_LIST)){a.push("Free Mobile Broadband Data Plan")
}return a
};
contractBox.processLines=function(f,c){contractBox.vars.lines=[];
for(var b=0;
b<f.length;
b++){if(f[b].serviceId&&f[b].contractParams&&f[b].contractParams.serviceParam){var e={};
e.serviceId=f[b].serviceId;
e.existingPlanName=f[b].mobile.planName;
e.existingPlanPartNum=f[b].planPartNum;
e.isOldPlan=false;
if(c[e.existingPlanPartNum]==undefined){e.isOldPlan=true
}if(f[b].contractStatus&&f[b].contractStatus.endDate){e.endDate=genDateStringFromObj(f[b].contractStatus.endDate)
}else{e.endDate=""
}e.blocked=[];
var a=contractBox.getPlanPartNum(f[b].planPartNum,f[b].contractParams.serviceParam);
e.blocked=contractBox.getBlockCase(f[b]);
var g={};
g.nextPageURL=baseUrl.billRebate;
g.params={};
g.params.planpartnum=a.planPartNum;
g.params.serviceid=e.serviceId;
g.params.modofservice=a.modOfService;
g.params.typeofplan=a.typeOfPlan;
e.billrebateParam=g;
var d={};
d.nextPageURL=baseUrl.orderConfig;
d.params=parseUrlParam($("#selectedPlanPartNum").text());
d.params.type="existing";
d.params.serviceid=e.serviceId;
d.params.planpartnum=a.planPartNum;
d.params.modofservice=a.modOfService;
d.params.typeofplan=a.typeOfPlan;
e.recontractParam=d;
contractBox.vars.lines.push(e)
}}contractBox.addIsInBasketNotify();
contractBox.addRecontractVoucherInfo()
};
contractBox.getBasketNumbers=function(f){var a=[];
var e=[];
var d=[];
if(f.mainContext.present.any[0]&&f.mainContext.present.any[0].pick){d=f.mainContext.present.any[0].pick
}for(var c=0;
c<d.length;
c++){if(d[c].subscription&&d[c].subscription.type&&d[c].subscription.type==="existing"&&d[c].id){e.push(d[c].id);
if(d[c].subscription.contract&&d[c].subscription.contract.serviceId){a.push(d[c].subscription.contract.serviceId)
}}}for(var b=0;
b<d.length;
b++){if(d[b].resource&&d[b].resource.msisdnInfo&&d[b].resource.msisdnInfo.number&&$.inArray(d[b].mainPickId,e)>=0){a.push(d[b].resource.msisdnInfo.number)
}}return a
};
contractBox.addIsInBasketNotify=function(){if(contractBox.vars.basketDataGet&&contractBox.vars.lines.length>0&&!contractBox.vars.basketChecked){var c=contractBox.vars.basketData;
var a=contractBox.getBasketNumbers(c);
for(var b=0;
b<contractBox.vars.lines.length;
b++){if($.inArray(contractBox.vars.lines[b].serviceId,a)>=0){contractBox.vars.lines[b].isInBasket=true
}else{contractBox.vars.lines[b].isInBasket=false
}}contractBox.vars.basketChecked=true;
contractBox.tryGenModalHtml()
}};
contractBox.addRecontractVoucherInfo=function(){if(contractBox.vars.trayDataGet&&contractBox.vars.lines.length>0&&!contractBox.vars.trayOfferChecked){var d=contractBox.vars.trayOffers;
if(d&&d.mainContext&&d.mainContext.present&&d.mainContext.present.any&&d.mainContext.present.any[0]&&d.mainContext.present.any[0].offer){var c=d.mainContext.present.any[0].offer;
for(var b=0;
b<c.length;
b++){for(var a=0;
a<contractBox.vars.lines.length;
a++){if(c[b].offerServiceId&&$.trim(c[b].offerServiceId)===contractBox.vars.lines[a].serviceId){contractBox.vars.lines[a].hasRecontractVoucher=true
}}}}contractBox.vars.trayOfferChecked=true;
contractBox.tryGenModalHtml()
}};
contractBox.checkRecontractVoucher=function(b){var a=callFAPI(ONLINEWEB_FAPI_URL.TRAY,null,"GET",null,b);
a.done(function(c){contractBox.vars.trayOffers=c;
contractBox.vars.trayDataGet=true;
contractBox.addRecontractVoucherInfo()
});
a.fail(function(c){throwError({debug:"call tray api fail."})
})
};
contractBox.checkBasket=function(a){var b=callFAPI(ONLINEWEB_FAPI_URL.BASKET,null,"GET",null,a);
b.done(function(d,e,c){contractBox.vars.basketData=d;
contractBox.vars.basketDataGet=true;
contractBox.addIsInBasketNotify()
});
b.fail(function(c,e,d){throwError({debug:"call basket api fail."})
})
};
contractBox.processContract=function(b){if(b.length<=0){var a={};
a.failmsg=onlinestore.MSG.DO_NOT_HAVE_ANY_CONTRACT_LINES;
a.yesButton=true;
a.yesButtonText="Sign Up New Line";
if(contractBox.vars.isOnlyBillRebate){a.yesButtonUrl=baseUrl.browse
}else{a.yesButtonUrl="javascript:checkUserTypeBlocking(authToken.checkNewSignUp);"
}a.noButton=true;
a.noButtonUrl="javascript:stopColorbox()";
a.noButtonText="Cancel";
throwError(a)
}else{ajaxService.getPlanMapService(function(c){contractBox.processLines(b,c);
contractBox.checkEligible()
})
}};
contractBox.initCounters=function(){contractBox.vars.lines=[];
contractBox.vars.basketChecked=false;
contractBox.vars.underCheckingLine=0;
contractBox.vars.basketDataGet=false;
contractBox.vars.basketData={};
contractBox.vars.isHubClubMember=false;
contractBox.ecStarted=false
};
contractBox.displayUserLines=function(a){if(a){ajaxService.checkHubIdTypeAndProceed(function(){ajaxService.checkBasketFull("",function(){if(isStarHubLite()){var b={};
b.failmsg=onlinestore.MSG.HUBID_LITE_USER_TO_RECONTRACT_NEW;
b.yesButton=true;
b.yesButtonUrl="javascript:checkUserTypeBlocking(authToken.checkNewSignUp);";
b.yesButtonText="Sign Up New Line";
b.noButton=true;
b.noButtonUrl="javascript:stopColorbox()";
b.noButtonText="Cancel";
throwError(b)
}else{contractBox.initCounters();
ajaxService.getUserInfo(function(c){if(c&&c.Membership&&c.Membership=="Hub Club"){contractBox.vars.isHubClubMember=true
}ajaxService.getContractService(contractBox.processContract,a,function(){throwError(onlinestore.MSG.SYSTEM_ERROR_MSG)
});
contractBox.checkBasket(a);
contractBox.checkRecontractVoucher(a)
})
}})
})
}else{ajaxService.getAuthKey(contractBox.displayUserLines)
}};
var detailFn=function(){return{refreshKeyFeatures:function(d,b){$("#keyFeatures").empty();
var f=false;
if(d[b]!=undefined&&d[b]!=null){var e="";
for(var c in d[b]){if(d[b].hasOwnProperty(c)){f=true;
var a=d[b][c];
if(jQuery.type(a)==="array"){a=a.sort().join(", ")
}if(a==true||a=="Yes"||a=="true"){a=c
}e+="<li>"+a+"</li>"
}}$("#keyFeatures").append(e)
}if(f===false){$("#keyFeatures").append("&nbsp;")
}},refreshImgThumb:function(c,a,f){$("#imgthumb").empty();
var e=c[a+f];
if(e!=undefined){var b;
if(e.length===0){e=[{hint:"",value:""}]
}for(i=0;
i<e.length;
i++){var d="<li";
if($.trim(e[i].hint).toUpperCase()==="FRONT"){d+=' class="selected"';
b=e[i]
}if(!e[i].altText){e[i].altText=brand+" "+model+" "+a+" "+f+" "+e[i].hint+" | StarHub Store"
}d+='><a href="javascript:void(0)" title="'+e[i].altText+'"><img src="'+e[i].value+'" alt="'+e[i].altText+'" /></a></li>';
$("#imgthumb").append(d);
if(i>=5){break
}}b=b||e[0];
if(b!=undefined&&b!=null){$('#imgthumb img[src="'+b.value+'"]').parent().parent().addClass("selected");
$("#mainImg").attr("src",b.value);
$("#mainImg").attr("alt",b.altText);
$("#mainImg").attr("title",b.altText)
}}},refreshSpecs:function(d,a){$("#specsDetail").empty();
for(var c in d[a]){if(d[a].hasOwnProperty(c)){var b=d[a][c];
if(jQuery.type(b)==="array"){b=b.sort().join(", ")
}$("#specsDetail").append('<li><div class="label">'+c+'</div><div class="value">'+b+"</div></li>")
}}},refreshPkgs:function(c,a){$("#pkgDetail").empty();
for(var b in c[a]){if(c[a].hasOwnProperty(b)){$("#pkgDetail").append("<li>"+c[a][b]+"</li>")
}}},refreshColorBox:function(c,b,a){$("#colorBox").empty();
var d,e;
if(c[a]!=undefined){for(i=0;
i<c[a].length;
i++){d="";
if(c[a][i]==selectedColor){d="selected"
}$("#colorBox").append('<li><a class="'+d+'" style="background-color: '+b[a+c[a][i]]["rgb"]+';" color="'+c[a][i]+'"; title="'+c[a][i]+'"></a></li>')
}}},genPlanLiHtml:function(b,e,a,d){var c='<li class="'+a+'"><img src="';
if(b=="sms"){c+="/etc/designs/onlinestore/img/productdetail-icon-sms.png"
}else{if(b=="talktime"){c+="/etc/designs/onlinestore/img/productdetail-icon-mins.png"
}else{if(b=="data"){c+="/etc/designs/onlinestore/img/productdetail-icon-data.png"
}}}c+='"/><span class="notes"><h4>'+e+"</h4><span>";
if(b=="sms"){c+="SMS/MMS"
}else{if(b=="talktime"){c+="outgoing local mins"
}else{if(b=="data"){c+="local bundled data"
}}}c+='</span></span><span class="print-only formula-sign">'+d+"</span></li>";
return c
},refreshStock:function(f,d,c){var e,h,b;
var g={};
if($("#colorBox .selected").hasClass("out-of-stock")){detailFn().disableChoosePlanButton()
}else{detailFn().enableChoosePlanButton()
}for(var a=0;
a<f[c].length;
a++){e=f[c][a];
h=d[c+e].stock;
b=callFAPI(ONLINEWEB_FAPI_URL.MOBILE_STOCK_STATUS,h,"GET");
b.done(function(m,p,l){var o=m.mainContext.present.any[0];
var n=o.deviceStockCode;
var j=o.stockStatus;
if(j=="OUT_OF_STOCK"){for(var k=0;
k<f[c].length;
k++){e=f[c][k];
if(n==d[c+e].stock){$('#colorBox a[color="'+e+'"]').addClass("out-of-stock");
if($('#colorBox a[color="'+e+'"]').hasClass("selected")){detailFn().disableChoosePlanButton()
}}}}})
}},refreshButtonStatus:function(){if(productDetail.vars.currentSelectionInstock){$("#disable_choose_plan").hide();
$("#recontractbtn").show();
$(".recontractbtn").removeClass("btn-inactive-rarrow").addClass("btn-secondaryGreen-rarrow")
}else{$("#recontractbtn").hide();
$("#disable_choose_plan").show();
$(".recontractbtn").removeClass("btn-secondaryGreen-rarrow").addClass("btn-inactive-rarrow")
}},disableChoosePlanButton:function(){$("#label-out-of-stock").show();
productDetail.vars.currentSelectionInstock=false;
$("#recontractbtn").hide();
$("#disable_choose_plan").show();
$(".recontractbtn").removeClass("btn-secondaryGreen-rarrow").addClass("btn-inactive-rarrow")
},enableChoosePlanButton:function(){$("#label-out-of-stock").hide();
productDetail.vars.currentSelectionInstock=true;
$("#disable_choose_plan").hide();
$("#recontractbtn").show();
$(".recontractbtn").removeClass("btn-inactive-rarrow").addClass("btn-secondaryGreen-rarrow")
}}
};
var productDetail=productDetail||{};
productDetail.vars={currentSelectionInstock:true,planMapRetrieved:false,planMap:{},planLists:{},selectedPlanType:""};
productDetail.recalculateCheapestPriceMap=function(e){var d={};
for(var c in e){if(e.hasOwnProperty(c)){for(var b=0,a=e[c].length;
b<a;
b++){if(b===0||parseFloat(d[c])>parseFloat(e[c][b].price)){d[c]=e[c][b].price
}}}}return d
};
productDetail.pushCheapestOffer=function(d,c){for(var b=0,a=d.length;
b<a;
b++){if(d[b].partNum===c.partNum){if(parseFloat(d[b].price)>parseFloat(c.price)){d.splice(b,1);
d.push(c);
return
}else{return
}}}d.push(c)
};
productDetail.recalculateOfferMap=function(g,j,a){var c={};
for(var h in a){if(a.hasOwnProperty(h)){var b=[];
for(var e=0,f=a[h].length;
e<f;
e++){var d=a[h][e];
if(!(j[d.partNum]==undefined||j[d.partNum]==null)){productDetail.pushCheapestOffer(b,d)
}}c[h]=b.sort(function(l,k){if(j[l.partNum].mrc!=j[k.partNum].mrc){return parseFloat(j[l.partNum].mrc)-parseFloat(j[k.partNum].mrc)
}else{return parseFloat(l.price)-parseFloat(k.price)
}})
}}return c
};
productDetail.processPlan=function(a){if(a!=undefined){productDetail.vars.planMap=a;
productDetail.vars.planMapRetrieved=true
}if(productDetail.vars.planMapRetrieved){productDetail.refreshPlanList(productDetail.vars.planMap,subtypeMap[selectedCap],variants[selectedCap+selectedColor].stock)
}else{ajaxService.getPlanMapService(productDetail.processPlan,"",function(){$("#planFilter").hide()
})
}};
productDetail.showPage=function(){productDetail.refreshPrice();
detailFn().refreshKeyFeatures(features,selectedCap);
selectedColor=colorMap[selectedCap][0];
detailFn().refreshColorBox(colorMap,variants,selectedCap);
detailFn().refreshStock(colorMap,variants,selectedCap);
detailFn().refreshImgThumb(imgMap,selectedCap,selectedColor);
detailFn().refreshSpecs(specsMap,selectedCap);
detailFn().refreshPkgs(pkgMap,selectedCap);
setRecontractLink();
productDetail.processPlan();
_SH.Components.Loading.Hide($("body"))
};
productDetail.genPricePlanTab=function(f,j){$("#plans").empty();
var n,q,r={},m=3,d="",g,p,t,a=true,b=true,o=true;
if(f.length>0){for(var e=0,h=f.length;
e<h;
e++){r=[];
a=true;
b=true;
o=true;
g=f[e].deviceOffer.devicePrice;
n=f[e].plan;
p=n.partNum;
q=n.prodFeatures;
m=3;
if(n&&n.prodSubType===j&&q.loV&&q.loV.value){for(var c=0,l=q.loV.value.length;
c<l;
c++){if(q.loV.value[c].key!=undefined){r[q.loV.value[c].key]=q.loV.value[c].value
}}if(r.talktime==null||r.talktime==""||r.talktime==undefined||r.talktime==0||r.talktime==="null"){a=false;
m--
}if(r.sms==null||r.sms==""||r.sms==undefined||r.sms==0||r.sms==="null"){b=false;
m--
}if(r.data==null||r.data==""||r.data==undefined||r.data==0||r.data==="null"){o=false;
m--
}if(m==0){continue
}d+=' <li class="price-plan plan-data-'+m+' featured full-width formula-v2"><div class="formula-name"><h3>'+n.prodName+'</h3></div><div class="formula small small-v2"><ul>';
if(a&&b&&o){d+=detailFn().genPlanLiHtml("talktime",r.talktime,"first","+");
d+=detailFn().genPlanLiHtml("sms",r.sms,"","+");
d+=detailFn().genPlanLiHtml("data",r.data,"last","=")
}else{if(a&&b){d+=detailFn().genPlanLiHtml("talktime",r.talktime,"first","+");
d+=detailFn().genPlanLiHtml("sms",r.sms,"last","=")
}else{if(a&&o){d+=detailFn().genPlanLiHtml("talktime",r.talktime,"first","+");
d+=detailFn().genPlanLiHtml("data",r.data,"last","=")
}else{if(b&&o){d+=detailFn().genPlanLiHtml("sms",r.sms,"first","+");
d+=detailFn().genPlanLiHtml("data",r.data,"last","=")
}else{if(a){d+=detailFn().genPlanLiHtml("talktime",r.talktime,"first","=")
}else{if(b){d+=detailFn().genPlanLiHtml("sms",r.sms,"first","=")
}else{if(o){d+=detailFn().genPlanLiHtml("data",r.data,"first","=")
}}}}}}}d+='</ul></div><div class="formula-content"><div class="read-more-pane"><a href="'+getPricePlanURL(n.prodName)+'" title="More Details">More Details</a></div></div><ul class="formula-result small small-v2"><li class="month-price"><div class="amount-wrapper"><div class="amount"><small class="currency-symbol">$</small><span>'+baseUrl.roundingPrice(parseFloat(n.mrc)).toFixed(2)+'</span></div><div class="amount-note">per month (excl. GST)</div></div></li><li class="phone-price"><div class="amount-wrapper"><div class="amount"><small class="currency-symbol">$</small><span>'+baseUrl.roundingPrice(parseFloat(g)).toFixed(2)+'</span></div><div class="amount-note">Phone price (incl. GST)</div></div><div title="Buy Now" class="btn-rarrow recontractbtn" planPartNum="'+p+'" href="javascript:void(0)" onclick="cq_analyst_fn(3)"><span class="icon"></span>Buy Now</div></li></ul><p class="promo-notes"></p><span class="indicator"></span></li>';
if(t==undefined||t>g){t=g
}}else{continue
}}productDetail.refreshPrice(t);
$("#plans").append(d);
_SH.Site.autoLoadComponents($("#plans"))
}else{productDetail.refreshPrice();
$("#plans").append(onlinestore.MSG.NO_PLANS_MSG)
}};
productDetail.refreshPrice=function(a){if(a!=undefined&&typeof a=="number"){}else{try{$("#cheapPrice").text(baseUrl.roundingPrice(parseFloat(cheapestPricesMap[selectedCap])).toFixed(2))
}catch(b){$("#cheapPrice").text(baseUrl.roundingPrice(parseFloat(cheapestPricesMap[selectedCap])).toFixed(2))
}}};
productDetail.refreshOnlineEx=function(f){var c=$("#onlineEx");
var e=false;
for(var d=0,a=f.length;
d<a;
d++){for(var b=0;
b<campaignIdList.length;
b++){if(f[d].deviceOffer.campaignId===campaignIdList[b]){e=true
}}}if(e){c.attr("class","label-exclusive");
c.text("Online Exclusive")
}else{c.removeAttr("class");
c.text("")
}};
productDetail.calculatePageVariables=function(a){var b=productDetail.initPlanType(a);
productDetail.genPricePlanTab(a,b);
productDetail.refreshOnlineEx(a);
detailFn().refreshButtonStatus()
};
productDetail.filterOffersWithCampaignId=function(d,a,c){var b=a?a.deviceOffer:undefined;
if(b&&isItemInArray(b.campaignId,c)&&!isItemInArray(d.campaignId,c)){return false
}else{if(b&&isItemInArray(b.campaignId,c)&&isItemInArray(d.campaignId,c)){return b.devicePrice>d.devicePrice
}else{if(isItemInArray(d.campaignId,c)){return true
}else{if(b){return b.devicePrice>d.devicePrice
}else{return true
}}}}};
productDetail.refreshPlanList=function(b,a,d){if(productDetail.vars.planLists[d]!=undefined){productDetail.calculatePageVariables(productDetail.vars.planLists[d])
}else{_SH.Components.Loading.Show($(".list-voice-and-data"));
var h=callFAPI(ONLINEWEB_FAPI_URL.DEVICE_MOBILE_HANDSETS_OFFER,a,"GET","","",d);
var c,e=[],f={},g;
h.done(function(o){if(o&&o.mainContext&&o.mainContext.present&&o.mainContext.present.any&&o.mainContext.present.any[0]&&o.mainContext.present.any[0].device&&o.mainContext.present.any[0].device[0]&&o.mainContext.present.any[0].device[0].deviceOffers&&o.mainContext.present.any[0].device[0].deviceOffers.deviceOffer){var m=o.mainContext.present.any[0].device[0].deviceOffers.deviceOffer;
for(var l=0,j=m.length;
l<j;
l++){if(m[l].exclusiveTo!="Existing"&&m[l].commitment){c=m[l].planPartNum.value;
g=b[c];
if(g&&(!g.select||!g.select.suppress||g.select.suppress.toUpperCase()!="ON")){var k={};
k.deviceOffer=m[l];
k.plan=g;
if(productDetail.filterOffersWithCampaignId(k.deviceOffer,f[g.partNum],campaignIdList)){f[g.partNum]=k
}}}}e=[];
for(var n in f){if(f.hasOwnProperty(n)){e.push(f[n])
}}e.sort(function(q,p){return q.plan.mrc-p.plan.mrc
});
productDetail.vars.planLists[d]=e;
productDetail.calculatePageVariables(productDetail.vars.planLists[d])
}else{$("#plans").empty();
$("#planFilter").hide();
mobileService.log("Receive device data, but cannot find offers from the response.");
mobileService.log(o)
}_SH.Components.Loading.Hide($(".list-voice-and-data"))
});
h.fail(function(j){mobileService.log("Get Device Offer from FAPI failed.");
$("#plans").empty();
$("#planFilter").hide();
_SH.Components.Loading.Hide($(".list-voice-and-data"))
})
}};
productDetail.initPlanType=function(d){var b=0,f=0;
for(var c=0,a=d.length;
c<a;
c++){var e=d[c].plan;
if(e!=undefined&&e.prodSubType=="VOICE"){b++
}else{if(e!=undefined&&e.prodSubType=="DATA"){f++
}}}productDetail.vars.selectedPlanType=productDetail.vars.selectedPlanType||"VOICE";
if(b!=0&&f==0){productDetail.vars.selectedPlanType="VOICE"
}else{if(f!=0&&b==0){productDetail.vars.selectedPlanType="DATA"
}}if(b==0){$("#voice_and_data_plan").attr("disabled","true");
$("#voice_and_data_plan").closest("label").addClass("disabled");
$("#planFilter").hide()
}else{$("#voice_and_data_plan").removeAttr("disabled");
$("#voice_and_data_plan").closest("label").removeClass("disabled")
}if(f==0){$("#data_plan").attr("disabled","true");
$("#data_plan").closest("label").addClass("disabled");
$("#planFilter").hide()
}else{$("#data_plan").removeAttr("disabled");
$("#data_plan").closest("label").removeClass("disabled")
}$("#planFilter input").each(function(){if($(this).attr("value")==productDetail.vars.selectedPlanType){$(this).parent().addClass("checked");
$(this).attr("checked",true)
}else{$(this).parent().removeClass("checked");
$(this).removeAttr("checked")
}});
return productDetail.vars.selectedPlanType
};
var browse=browse||{};
browse.CONSTANTS={URL_PARAM_ZERO_PHONE:"zero_phone",URL_PARAM_CAMPAIGNID:"campaignId",PHONE_COMPARE_MAX_LIMIT:2};
browse.vars={phones:[],planMap:{},contractLines:{},filterBrands:[],filterFeatures:[],filterOSes:[],filterPrices:[],filterZeroPhone:[],filterOnlineExclusive:[],predicates:["deviceReleaseDate","deviceCheapestPrice","deviceIsFeaturePhone","deviceBrand"],reverse:[1,-1,1,-1],noSort:true,noFilter:true,hasApplyFilter:false,hasFinishedLoading:false,currentPhoneList:[],currentPage:1,itemOnPage:12,totalPage:0,viewAll:false,comparePhoneIds:[],comparePhoneLength:0,paginationList:[1,2,3,4,5],onlineExclusive:false,featurePhones:0,selectedServiceId:"",getPlanDone:false,getHandsetDone:false,handsetSourceStatus:[0,0]};
browse.genPhoneHtml=function(h,g){var c="";
var d=h.deviceBrand;
var f=h.deviceModel;
var p="";
var k=browse.vars.planMap;
if(k[h.deviceCheapestPlan]){p="with "+k[h.deviceCheapestPlan].prodName
}var o=h.deviceCheapestPrice;
var n=0;
if(typeof n=="string"){n=parseFloat(o)
}else{n=o
}n=baseUrl.roundingPrice(n).toFixed(2);
var m=baseUrl.DEFAULT_IMAGE;
var b="";
if(h.deviceMainImage){m=h.deviceMainImage;
b=h.deviceMainImageHint
}var a=baseUrl.mobileDetail(d,f);
if(!h.deviceIsLessFeaturePhone&&!h.deviceIsFeaturePhone){c='<div class="cell11 cell" id="phoneCell'+h.deviceIndex+'">'
}else{if(browse.vars.noSort&&browse.vars.noFilter&&h.deviceIsFeaturePhone&&!h.deviceIsLessFeaturePhone){c='<div class="cell21 cell featured" id="phoneCell'+h.deviceIndex+'" title="Featured Phone">'
}else{c='<div class="cell11 cell featured" id="phoneCell'+h.deviceIndex+'">'
}}var l=[d,f,b,"| StarHub Store"].join(" ");
c+='<span class="indicator"></span><div class="inner"><div class="cell-product-img"><img src="'+m+'" title="'+l+'" alt="'+l+'"/></div><div class="cell-product-desc"><div class="inner"><div class="info-basic"><div class="product-name"><span class="model-name">'+d+'</span><span class="model-no">'+f+"</span></div>";
if(browse.vars.noSort&&browse.vars.noFilter&&h.deviceIsFeaturePhone&&!h.deviceIsLessFeaturePhone){c+="<ul>";
for(var e in h.deviceGroupedKeyFeatureList){if(h.deviceGroupedKeyFeatureList.hasOwnProperty(e)){var j=(h.deviceGroupedKeyFeatureList[e].sort()).join(",");
if((j=="true"||j==true)&&h.deviceGroupedKeyFeatureHintList[e]){j=h.deviceGroupedKeyFeatureHintList[e]
}c+="<li>"+j+"</li>"
}}c+="</ul>"
}c+='</div><div class="info-focus"><div class="notes">From</div><div class="product-price"><small class="currency-symbol">$</small><span>'+n+'</span></div><a href="'+a+'"class="btn-secondaryGreen-rarrow btn-view-details" pos="'+g+'"><span class="icon"></span>View Details</a><label class="custom-checkbox"><span class="mask"></span><input name="phone_compare" type="checkbox" value="'+h.deviceIndex+'" id = "compare_checkbox_'+h.deviceIndex+'"/><span>Add to compare</span></label></div></div></div></div></div>';
return c
};
browse.sortByPredicates=function(n,e){var b=n;
var l=browse.vars.predicates;
var h=browse.vars.reverse;
b=b.sort(function(o,j){var q,p;
for(var r=0;
r<l.length;
r++){q=o[l[r]];
p=j[l[r]];
q=(typeof q==="string")?q.toLowerCase():q;
p=(typeof p==="string")?p.toLowerCase():p;
if(q>p){return(-1)*h[r]
}else{if(q<p){return h[r]
}}}return 0
});
if(browse.vars.noSort&&browse.vars.noFilter&&!e){var k={};
browse.vars.featurePhones=0;
var f=b.length<10?1:2;
var a=[0,9];
for(var d=0,g=b.length;
d<g;
d++){if(b[d].deviceIsFeaturePhone){if(browse.vars.featurePhones<f){if(d!=a[browse.vars.featurePhones]){k=b[d];
b.splice(d,1);
b.splice(a[browse.vars.featurePhones],0,k);
if(d<a[browse.vars.featurePhones]){d=d-1
}}browse.vars.featurePhones=browse.vars.featurePhones+1
}else{var m=false;
for(var c=0;
c<browse.vars.featurePhones;
c++){if(d===a[c]){m=true;
break
}}if(!m){b[d].deviceIsLessFeaturePhone=true;
b[d].deviceIsFeaturePhone=true
}}}}}return b
};
browse.genHtml=function(b){var e=$("div.tiles.compare-available.product-list");
browse.vars.currentPhoneList=b;
e.empty();
b=browse.paginated(b);
$("div.list-info").text("Showing "+b.length+" of "+browse.vars.currentPhoneList.length);
var d="";
for(var c=0;
c<b.length;
c++){d+=browse.genPhoneHtml(b[c],c)
}if(d!=""){var a=$(d);
_SH.Site.autoLoadComponents(a);
a=browse.newProductCell(a);
e.append(a);
browse.vars.hasFinishedLoading=true;
mobileService.triggerWindowResize()
}else{if(browse.vars.hasApplyFilter){e.append("<p>"+onlinestore.MSG.NO_MATCH_RESULT_FOR_FILTERING+"</p>")
}}_SH.Components.Loading.Hide($(".primary-column"))
};
browse.updatePhoneCompareRecord=function(){var f=[];
var h=[];
for(var d=0,a=browse.vars.comparePhoneIds.length;
d<a;
d++){pushDiff(h,browse.vars.comparePhoneIds[d])
}browse.vars.comparePhoneIds=h;
for(var e=0,b=browse.vars.comparePhoneIds.length;
e<b&&e<browse.CONSTANTS.PHONE_COMPARE_MAX_LIMIT;
e++){for(var g=0,a=browse.vars.phones.length;
g<a;
g++){if(browse.vars.phones[g].deviceIndex==browse.vars.comparePhoneIds[e]){var c={};
c.brand=browse.vars.phones[g].deviceBrand;
c.model=browse.vars.phones[g].deviceModel;
f.push(c)
}}}ajaxService.setPhoneCompareBrandModel(f)
};
browse.newProductCell=function(b){b.find('input[name="phone_compare"]').on("change",function(){var j=$(this),h=j.parents(".cell"),g=parseInt(this.value);
if(j.is(":checked")){if($.inArray(g,browse.vars.comparePhoneIds)<0&&browse.vars.comparePhoneLength>=browse.CONSTANTS.PHONE_COMPARE_MAX_LIMIT){var f={};
f.failmsg=onlinestore.MSG.COMPARE_ITEM_REACHED_MAX;
f.yesButton=true;
f.yesButtonText="OK";
f.yesButtonUrl="javascript:stopColorbox();";
throwError(f);
j.prop("checked",false);
j.change()
}else{h.addClass("selected");
j.parents("label").find('span:not(".mask"):not(".icon")').html('<a href="javascript:phonecomp.checkComparisonStatus();"><span class="icon"></span>Compare Now</a>');
if(pushDiff(browse.vars.comparePhoneIds,g)){browse.vars.comparePhoneLength=browse.vars.comparePhoneLength+1
}else{if(browse.vars.comparePhoneIds.length>browse.vars.comparePhoneLength){browse.vars.comparePhoneLength=browse.vars.comparePhoneLength+1
}}}}else{h.removeClass("selected");
j.parents("label").find('span:not(".mask"):not(".icon")').text("Add to compare");
var e=$.inArray(parseInt(g),browse.vars.comparePhoneIds);
if(e>=0){browse.vars.comparePhoneIds.splice(e,1);
browse.vars.comparePhoneLength=browse.vars.comparePhoneLength-1
}}browse.updatePhoneCompareRecord()
});
b.find("img").each(function(e,f){f.onload=browse.imgOnLoad;
f.onerror=browse.imgOnError
});
var c;
for(var d=0,a=browse.vars.comparePhoneIds.length;
d<a;
d++){c=b.find("#compare_checkbox_"+browse.vars.comparePhoneIds[d]);
if(c.length>0){c.prop("checked",true);
c.change()
}}b.each(function(e,h){var f=$(h).find(".btn-view-details");
f.on("click",function(){s.linkTrackVars="eVar4,eVar8";
s.linkTrackEvents=s.events="event17";
s.tl(this,"o","product-tiles | "+scPageName+" | "+this.href)
});
if(f){f.attr("href",browse.appendIcidParams(f.attr("href"),f.attr("pos"),h))
}var g=$(h).find('input[name="phone_compare"]');
g.on("change",function(k){if($(this).is(":checked")){var j=$(h).find(".model-name").text();
var l=$(h).find(".model-no").text();
s.linkTrackVars="prop14,eVar4,eVar8";
s.prop14="Compare Products";
s.tl(this,"o","product-tiles - compare phone check box | "+scPageName+" | "+l)
}})
});
return b
};
browse.appendIcidParams=function(d,c,b){var a=$(b).hasClass("cell21")?"big":"small";
if(d.indexOf("?")>-1){return d+"&icid="+scPageName+"_leadintiles-"+a+"_A"+c+"_"+campaignID_analyst+"_"+d
}else{return d+"?icid="+scPageName+"_leadintiles-"+a+"_A"+c+"_"+campaignID_analyst+"_"+d
}};
browse.imgOnLoad=function(){mobileService.triggerWindowResize()
};
browse.imgOnError=function(){this.src=baseUrl.DEFAULT_IMAGE;
this.onload=browse.imgOnLoad;
mobileService.triggerWindowResize()
};
browse.shiftPagination=function(a){if(0===a){var b=browse.vars.paginationList[0];
if(b===1){}else{browse.vars.paginationList=[b-5,b-4,b-3,b-2,b-1];
browse.setPagination(browse.vars.currentPhoneList.length)
}}else{var b=browse.vars.paginationList[4];
if(b>=browse.vars.totalPage){}else{browse.vars.paginationList=[b+1,b+2,b+3,b+4,b+5];
browse.setPagination(browse.vars.currentPhoneList.length)
}}};
browse.setPagination=function(c){if(browse.vars.noSort&&browse.vars.noFilter){browse.vars.totalPage=Math.ceil((c+browse.vars.featurePhones)/browse.vars.itemOnPage)
}else{browse.vars.totalPage=Math.ceil(c/browse.vars.itemOnPage)
}if(browse.vars.totalPage===0){browse.vars.totalPage=1
}var e="";
e+='<li class="prev"><a href="javascript:browse.setPage(-1)">&lt;</a></li>';
if(browse.vars.paginationList[0]!==1){e+='<li class="number"><a href="javascript:browse.shiftPagination(0)">...</a></li>'
}for(var b=0;
b<=browse.vars.paginationList.length;
b++){if(browse.vars.paginationList[b]<=browse.vars.totalPage){if(browse.vars.paginationList[b]===browse.vars.currentPage){e+='<li class="number"><span>'+browse.vars.paginationList[b]+"</span></li>"
}else{e+='<li class="number"><a href="javascript:browse.setPage('+browse.vars.paginationList[b]+')">'+browse.vars.paginationList[b]+"</a></li>"
}}}if(browse.vars.paginationList[4]<browse.vars.totalPage){e+='<li class="number"><a href="javascript:browse.shiftPagination(1)">...</a></li>'
}e+='<li class="prev"><a href="javascript:browse.setPage(-2)">&gt;</a></li>';
var a=e+'<li class="viweall"><a href="javascript:browse.setViewAll(0)">View All</a></li>';
var d=e+'<li class="viweall"><a href="javascript:browse.setViewAll(1)">View All</a></li>';
$("#ListPaginationUp").empty().append(a);
$("#ListPaginationDown").empty().append(d);
mobileService.triggerWindowResize()
};
browse.paginated=function(b){browse.setPagination(b.length);
var a=[];
if(browse.vars.noSort&&browse.vars.noFilter){for(var c=0;
c<b.length;
c++){if(c>=Math.max((browse.vars.currentPage-1)*browse.vars.itemOnPage-browse.vars.featurePhones,0)&&c<Math.min(browse.vars.currentPage*browse.vars.itemOnPage-browse.vars.featurePhones,b.length)){a.push(b[c])
}}}else{for(var c=0;
c<b.length;
c++){if(c>=Math.max((browse.vars.currentPage-1)*browse.vars.itemOnPage,0)&&c<Math.min(browse.vars.currentPage*browse.vars.itemOnPage,b.length)){a.push(b[c])
}}}return a
};
browse.isInPriceRange=function(c){var b,d;
for(var a=0;
a<browse.vars.filterPrices.length;
a++){b=parseInt(browse.vars.filterPrices[a].split("#")[0]);
d=parseInt(browse.vars.filterPrices[a].split("#")[1]);
if(c>=b&&c<=d){return true
}}return false
};
browse.matchCheck=function(a,b,c){if(!(a&&b)){return false
}if(c==2){return($.trim(a).toLowerCase()).indexOf($.trim(b).toLowerCase())>=0
}else{return $.trim(a).toLowerCase()===$.trim(b).toLowerCase()
}};
browse.deepContain=function(a,c,e){for(var d=0;
d<a.length;
d++){if(typeof a[d]==="string"){if(browse.matchCheck(a[d],c,e)){return true
}}else{for(var b=0;
b<a[d].length;
b++){if(browse.matchCheck(a[d][b],c,e)){return true
}}}}return false
};
browse.meetFilter=function(a){var d=true;
if(d&&browse.vars.filterBrands.length>0&&!browse.deepContain(browse.vars.filterBrands,a.deviceBrand)){d=false
}if(d&&browse.vars.filterOSes.length>0&&!browse.deepContain(browse.vars.filterOSes,a.deviceOS)){d=false
}if(d&&browse.vars.filterFeatures.length>0){d=false;
for(var c=0;
c<a.deviceKeyFeatureList.length;
c++){if(browse.deepContain(browse.vars.filterFeatures,a.deviceKeyFeatureList[c],2)){d=true;
break
}}if(!d){for(var b in a.deviceGroupedKeyFeatureList){if(a.deviceGroupedKeyFeatureList.hasOwnProperty(b)&&browse.deepContain(browse.vars.filterFeatures,b)){d=true;
break
}}}}if(d&&browse.vars.filterPrices.length>0){d=false;
if(browse.isInPriceRange(a.deviceCheapestPrice)){d=true
}}if(d&&browse.vars.filterZeroPhone.length>0){d=false;
for(var c=0;
c<browse.vars.filterZeroPhone.length;
c++){if(browse.vars.filterZeroPhone[c]==a.deviceCheapestPrice){d=true;
break
}}}return d
};
browse.checkStrictFilter=function(){if(browse.vars.filterOnlineExclusive.length>0&&browse.vars.handsetSourceStatus[1]!=1){browse.vars.handsetSourceStatus[0]=browse.vars.handsetSourceStatus[1];
browse.vars.handsetSourceStatus[1]=1;
_SH.Components.Loading.Show($(".primary-column"));
$(".secondary-box .inner .left-column").empty().append("<h1>Online Exclusive</h1>");
browse.callAjaxData(browse.vars.filterOnlineExclusive[0][0]);
return true
}else{if(browse.vars.filterOnlineExclusive.length<=0&&browse.vars.handsetSourceStatus[1]==1){browse.vars.handsetSourceStatus[0]=browse.vars.handsetSourceStatus[1];
browse.vars.handsetSourceStatus[1]=0;
_SH.Components.Loading.Show($(".primary-column"));
$(".secondary-box .inner .left-column").empty().append("<h1>Take your pick from our latest mobiles</h1>");
browse.callAjaxData();
return true
}}return false
};
browse.filterBy=function(){browse.vars.noFilter=false;
var a=[];
$($('input[name="campaignId"]:checked')).each(function(b,c){browse.vars.filterOnlineExclusive.push(c.value.split("|"))
});
if(browse.checkStrictFilter()){return
}$($('input[name="brandfilter"]:checked')).each(function(b,c){browse.vars.filterBrands.push(c.value.split("|"))
});
$($('input[name="osfilter"]:checked')).each(function(b,c){browse.vars.filterOSes.push(c.value.split("|"))
});
$($('input[name="featurefilter"]:checked')).each(function(b,c){browse.vars.filterFeatures.push(c.value.split("|"))
});
$($('input[name="pricefilter"]:checked')).each(function(b,c){browse.vars.filterPrices.push(c.value)
});
$($('input[name="zerophone"]:checked')).each(function(b,c){browse.vars.filterZeroPhone.push(c.value.split("|"))
});
if(browse.vars.filterBrands.length===0&&browse.vars.filterPrices.length===0&&browse.vars.filterFeatures.length===0&&browse.vars.filterOSes.length===0&&browse.vars.filterZeroPhone.length===0&&browse.vars.filterOnlineExclusive.length===0){browse.vars.hasApplyFilter=false;
a=browse.vars.phones
}else{browse.vars.hasApplyFilter=true;
a=jQuery.grep(browse.vars.phones,function(c,b){return browse.meetFilter(c)
});
browse.vars.filterBrands=[];
browse.vars.filterFeatures=[];
browse.vars.filterOSes=[];
browse.vars.filterPrices=[];
browse.vars.filterZeroPhone=[];
browse.vars.filterOnlineExclusive=[]
}browse.vars.currentPage=1;
browse.vars.paginationList=[1,2,3,4,5];
browse.vars.viewAll=false;
a=browse.sortByPredicates(a);
browse.genHtml(a)
};
browse.infiniteScroll=function(g,j){var e=$("div.tiles.compare-available.product-list");
var d,c;
if(browse.vars.currentPage<=browse.vars.totalPage){if(browse.vars.noSort&&browse.vars.noFilter){c=(browse.vars.currentPage-1)*browse.vars.itemOnPage-2;
d=browse.vars.currentPage*browse.vars.itemOnPage-2
}else{c=(browse.vars.currentPage-1)*browse.vars.itemOnPage;
d=browse.vars.currentPage*browse.vars.itemOnPage
}c=Math.max(c,0);
var a="";
var f=0;
if(!g){f=d
}for(;
f<browse.vars.itemOnPage+d;
f++){if(f<browse.vars.currentPhoneList.length){a+=browse.genPhoneHtml(browse.vars.currentPhoneList[f],f)
}else{break
}}browse.vars.currentPage=browse.vars.currentPage+1;
if(browse.vars.currentPage>browse.vars.totalPage){browse.vars.currentPage=browse.vars.totalPage
}$("div.list-info").text("Showing "+Math.min((d+browse.vars.itemOnPage),browse.vars.currentPhoneList.length)+" of "+browse.vars.currentPhoneList.length);
var h=browse.newProductCell($(a));
e.append(h);
_SH.Site.autoLoadComponents($(".product-list"));
mobileService.triggerWindowResize();
if(g){var b="";
if(j==0){b="phoneCell"+browse.vars.currentPhoneList[c].deviceIndex
}else{if(j==1&&d<=browse.vars.currentPhoneList.length){b="phoneCell"+browse.vars.currentPhoneList[d-1].deviceIndex
}else{if(j==1){b="phoneCell"+browse.vars.currentPhoneList[browse.vars.currentPhoneList.length-1].deviceIndex
}}}document.getElementById(b).scrollIntoView()
}}};
browse.applyUrlParameters=function(){var c=$(location)[0].search;
if(c.indexOf("?")<0&&browse.vars.noFilter){$(".secondary-box .inner .left-column").empty().append("<h1>Take your pick from our latest mobiles</h1>");
browse.genHtml(browse.vars.currentPhoneList)
}else{var b=parseUrlParam(c.slice(1));
for(var a in b){if(a.toLowerCase()==="brand"){browse.vars.noFilter=false;
$('input[name="brandfilter"]').each(function(d,f){var e=f.value.split("|");
if(browse.deepContain(e,b[a])){$(f).parents("label").each(function(h,g){if(document.createEvent){var j=document.createEvent("MouseEvents");
j.initEvent("click",true,true);
g.dispatchEvent(j)
}else{if(document.createEventObject){var j=document.createEventObject();
g.fireEvent("onclick",j)
}}})
}});
browse.vars.filterBrands.push([b[a]])
}else{if(a.toLowerCase()===browse.CONSTANTS.URL_PARAM_ZERO_PHONE.toLowerCase()&&b[a]==="true"){browse.vars.noFilter=false;
$($('input[name="zerophone"]').parents("label")).each(function(d,e){e.click()
})
}else{if(a.toLowerCase()===browse.CONSTANTS.URL_PARAM_CAMPAIGNID.toLowerCase()){browse.vars.noFilter=false;
$('input[name="campaignId"]').each(function(d,e){if(e.value.indexOf(b[a])>=0){if(!e.checked){$(e).parents("label").each(function(g,f){if(document.createEvent){var h=document.createEvent("MouseEvents");
h.initEvent("click",true,true);
f.dispatchEvent(h)
}else{if(document.createEventObject){var h=document.createEventObject();
f.fireEvent("onclick",h)
}}})
}}});
browse.vars.filterOnlineExclusive.push([b[a]])
}}}}if(!browse.vars.noFilter){browse.filterBy()
}else{$(".secondary-box .inner .left-column").empty().append("<h1>Take your pick from our latest mobiles</h1>");
browse.genHtml(browse.vars.currentPhoneList)
}}};
browse.applyPageProperty=function(){var c,b,a;
if(typeof campaignIdProperty!="undefined"){c=campaignIdProperty;
campaignIdProperty=""
}if(typeof brandProperty!="undefined"){b=brandProperty;
brandProperty=""
}if(typeof zerophoneProperty!="undefined"){a=zerophoneProperty;
zerophoneProperty=""
}if(!c&&!b&&!a){}else{if(b!=undefined&&b){browse.vars.noFilter=false;
$('input[name="brandfilter"]').each(function(d,f){var e=f.value.split("|");
if(browse.deepContain(e,b)){$(f).parents("label").each(function(h,g){if(document.createEvent){var j=document.createEvent("MouseEvents");
j.initEvent("click",true,true);
g.dispatchEvent(j)
}else{if(document.createEventObject){var j=document.createEventObject();
g.fireEvent("onclick",j)
}}})
}});
browse.vars.filterBrands.push([b])
}else{if(a!=undefined&&a){browse.vars.noFilter=false;
$($('input[name="zerophone"]').parents("label")).each(function(d,e){e.click()
})
}else{if(c!=undefined&&c){browse.vars.noFilter=false;
$('input[name="campaignId"]').each(function(d,e){if(e.value.indexOf(c)>=0){if(!e.checked){$(e).parents("label").each(function(g,f){if(document.createEvent){var h=document.createEvent("MouseEvents");
h.initEvent("click",true,true);
f.dispatchEvent(h)
}else{if(document.createEventObject){var h=document.createEventObject();
f.fireEvent("onclick",h)
}}})
}}});
browse.vars.filterOnlineExclusive.push([c])
}}}}browse.applyUrlParameters()
};
browse.genFilterItemHtml=function(a,b,c){return'<li><label class="custom-checkbox"><input name="'+a+'" type="checkbox" value="'+b+'" /><span>'+c+"</span></label></li>"
};
browse.prepareFilter=function(){$.getJSON(baseUrl.FILTER_JSON_FILE).then(function(g){var k="";
var d="";
var l="";
var b="";
var h="";
var c,m,a;
for(var f in g){if(f==="PriceRangeContent"){b='<strong>Price Range</strong><ul class="no-style">';
c="pricefilter";
for(var e=0;
e<g[f].length;
e++){m=g[f][e].value[0]+"#"+g[f][e].value[1];
a=g[f][e].display;
b+=browse.genFilterItemHtml(c,m,a)
}b+="</ul>"
}else{if(f==="BrandContent"){d='<strong>Brand</strong><ul class="no-style">';
c="brandfilter";
for(var e=0;
e<g[f].length;
e++){m=g[f][e].value.join("|");
a=g[f][e].display;
d+=browse.genFilterItemHtml(c,m,a)
}d+="</ul>"
}else{if(f==="OSContent"){k='<strong>Operating System</strong><ul class="no-style">';
c="osfilter";
for(var e=0;
e<g[f].length;
e++){m=g[f][e].value.join("|");
a=g[f][e].display;
k+=browse.genFilterItemHtml(c,m,a)
}k+="</ul>"
}else{if(f==="FeatureContent"){l='<strong>Feature</strong><ul class="no-style">';
c="featurefilter";
for(var e=0;
e<g[f].length;
e++){m=g[f][e].value.join("|");
a=g[f][e].display;
l+=browse.genFilterItemHtml(c,m,a)
}l+="</ul>"
}else{if(f==="PromotionContent"){h='<strong>Promotion</strong><ul class="no-style">';
for(var e=0;
e<g[f].length;
e++){c=g[f][e].id;
m=g[f][e].value.join("|");
a=g[f][e].display;
h+=browse.genFilterItemHtml(c,m,a)
}h+="</ul>"
}else{}}}}}}$("#browse_id_pricefilter").empty().append(b);
$("#browse_id_osfilter").empty().append(k);
$("#browse_id_featurefilter").empty().append(l);
$("#browse_id_brandfilter").empty().append(d);
$("#browse_id_promotionfilter").empty().append(h);
_SH.Site.autoLoadComponents($("#browse_id_pricefilter"));
_SH.Site.autoLoadComponents($("#browse_id_osfilter"));
_SH.Site.autoLoadComponents($("#browse_id_featurefilter"));
_SH.Site.autoLoadComponents($("#browse_id_brandfilter"));
_SH.Site.autoLoadComponents($("#browse_id_promotionfilter"));
browse.callAjaxData()
})
};
browse.callAjaxData=function(a){var b=browse.vars.handsetSourceStatus[1];
if(b===1){ajaxService.getHandsetByCampaignIdService(browse.processHandset,a)
}else{if(b===2){}else{ajaxService.getHandsetService(browse.processHandset)
}}};
browse.processPlan=function(a){browse.vars.planMap=a;
browse.vars.getPlanDone=true;
browse.populatePhones()
};
browse.recordComparedPhones=function(e){var b=ajaxService.getPhoneCompareBrandModel();
var d;
if(b){for(var c=0,a=b.length;
c<a;
c++){d=b[c].brand+";"+b[c].model;
if(e[d]&&e[d].deviceIndex!==undefined){pushDiff(browse.vars.comparePhoneIds,e[d].deviceIndex)
}}}};
browse.processHandset=function(b){browse.recordComparedPhones(b);
browse.vars.phones=[];
for(var a in b){if(b.hasOwnProperty(a)){browse.vars.phones.push(b[a])
}}browse.vars.getHandsetDone=true;
browse.populatePhones()
};
browse.filterOutPhonesWithoutPlan=function(b,l){var k=[];
var d=true;
var m;
var f;
var c=[];
for(var g=0,h=b.length;
g<h;
g++){d=true;
c=[];
for(var e=0,a=b[g].deviceOfferList.length;
e<a;
e++){if(l[b[g].deviceOfferList[e].planName]){if(d){m=b[g].deviceOfferList[e].planPrice;
f=b[g].deviceOfferList[e].planName
}else{if(b[g].deviceOfferList[e].planPrice<m){m=b[g].deviceOfferList[e].planPrice;
f=b[g].deviceOfferList[e].planName
}}d=false;
c.push(b[g].deviceOfferList[e])
}}if(!d){b[g].deviceCheapestPrice=m;
b[g].deviceCheapestPlan=f;
b[g].deviceOfferList=c;
k.push(b[g])
}}return k
};
browse.populatePhones=function(a){if(browse.vars.getHandsetDone){browse.vars.currentPhoneList=browse.sortByPredicates(browse.vars.phones);
browse.applyPageProperty()
}};
browse.browseRecontractEligibleCheck=function(b){if(browse.vars.selectedServiceId){var a=$("#Listing_Page_UserInfo");
var d=browse.vars.selectedServiceId;
var c=callFAPI(ONLINEWEB_FAPI_URL.ELIGIBILITY_RECONTRACT,d,"POST");
c.done(function(h,k,f){_SH.Components.Loading.Hide($(".secondary-box"));
var j="";
var e=h.mainContext.present.any[0];
if(e.eligible){var g=0;
if(e&&e.chargesApplicable&&e.chargesApplicable.erf&&e.chargesApplicable.erf.value!=undefined&&e.chargesApplicable.erf.waive!=undefined){g=e.chargesApplicable.erf.value-e.chargesApplicable.erf.waive
}if(g<=0){j+='<p class="recontract-notes">'+onlinestore.MSG.ELIGIBLE_FOR_RECONTRACT+"</p>"
}else{j+='<p class="recontract-notes">Contract ends '+genDateStringFromObj(browse.vars.contractLines[d].endDate)+'.</p><p class="recontract-notes">'+onlinestore.MSG.LISTING_PAGE_RECONTRACT_WITH_A_FEE+"</p>"
}}else{if(e.eligible==false){j+='<p class="recontract-notes">'+onlinestore.MSG.NOT_ELIGIBLE_FOR_RECONTRACT+"</p>"
}else{j+='<p class="recontract-notes">'+onlinestore.MSG.LISTING_PAGE_RETRIEVE_USER_INFO_FAIL+"</p>"
}}$("#Listing_Page_UserInfo p.recontract-notes").remove();
a.append(j)
});
c.fail(function(e,g,f){_SH.Components.Loading.Hide($(".secondary-box"));
$("#Listing_Page_UserInfo p.recontract-notes").remove();
a.append('<p class="recontract-notes">'+onlinestore.MSG.LISTING_PAGE_RETRIEVE_USER_INFO_FAIL+"</p>")
})
}};
browse.populateGreenBanner=function(b){if(b.length>0){var d='<p class="important">'+onlinestore.MSG.TEXT_TO_LET_USER_SELECT_A_LINE_TO_CHECK_RECONTRACT_ELIGIBILITY+'</p><select name="" class="full" id="Listing_Page_Select"><option value="" selected="selected">Select number</option>';
var c;
for(var a=0;
a<b.length;
a++){c=b[a].serviceId;
browse.vars.contractLines[c]={};
browse.vars.contractLines[c].serviceId=c;
browse.vars.contractLines[c].endDate=b[a].contractStatus.endDate;
browse.vars.contractLines[c].reconEligible=b[a].contractStatus.reconEligible;
d+='<option value="'+c+'">'+phoneNumberToString(c)+"</option>"
}d+="</select>";
$("#Listing_Page_UserInfo").empty().append(d);
_SH.Components.Dropdown($("#Listing_Page_Select"));
$("#Listing_Page_Select").change(browse.listingPageRecontractLineSelectionEvent)
}_SH.Components.Loading.Hide($(".secondary-box"))
};
browse.listingPageRecontractLineSelectionEvent=function(){if(this.value&&this.value.length>0){$("#Listing_Page_UserInfo p.recontract-notes").remove();
_SH.Components.Loading.Show($(".secondary-box"));
$("#Listing_Page_UserInfo").append('<p class="recontract-notes">'+onlinestore.MSG.LIST_PAGE_WAITING_FOR_USER_CONTRACT_INFO+"</p>");
browse.vars.selectedServiceId=this.value;
browse.browseRecontractEligibleCheck()
}else{$("#Listing_Page_UserInfo p.recontract-notes").remove()
}};
browse.listingPageSortByOptionSelectionEvent=function(){var a=this.value;
browse.vars.noSort=false;
$("a.option-key.accordion-header.cta-sort-by").click();
if(a===0){browse.vars.predicates=["deviceBrand","deviceReleaseDate","deviceCheapestPrice","deviceIsFeaturePhone"];
browse.vars.reverse=[-1,1,-1,1]
}else{if(a===1){browse.vars.predicates=["deviceBrand","deviceReleaseDate","deviceCheapestPrice","deviceIsFeaturePhone"];
browse.vars.reverse=[1,1,-1,1]
}else{if(a===2){browse.vars.predicates=["deviceCheapestPrice","deviceReleaseDate","deviceIsFeaturePhone","deviceBrand"];
browse.vars.reverse=[-1,1,1,-1]
}else{if(a===3){browse.vars.predicates=["deviceCheapestPrice","deviceReleaseDate","deviceIsFeaturePhone","deviceBrand"];
browse.vars.reverse=[1,1,1,-1]
}else{if(a===4){browse.vars.predicates=["deviceReleaseDate","deviceCheapestPrice","deviceIsFeaturePhone","deviceBrand"];
browse.vars.reverse=[1,-1,1,-1]
}else{}}}}}browse.vars.currentPhoneList=browse.sortByPredicates(browse.vars.currentPhoneList);
browse.vars.currentPage=1;
browse.vars.paginationList=[1,2,3,4,5];
browse.vars.viewAll=false;
browse.genHtml(browse.vars.currentPhoneList)
};
browse.clickListViewEvent=function(){if(browse.vars.noSort&&browse.vars.noFilter&&browse.vars.hasFinishedLoading){browse.vars.predicates=["deviceIsFeaturePhone","deviceReleaseDate","deviceCheapestPrice","deviceBrand"];
reverse:[1,-1,1,-1];
var a=browse.sortByPredicates(browse.vars.currentPhoneList,true);
browse.genHtml(a)
}};
browse.clickGridViewEvent=function(){if(browse.vars.noSort&&browse.vars.noFilter&&browse.vars.hasFinishedLoading){browse.vars.predicates=["deviceReleaseDate","deviceCheapestPrice","deviceIsFeaturePhone","deviceBrand"];
browse.vars.reverse=[1,-1,1,-1];
var a=browse.sortByPredicates(browse.vars.currentPhoneList);
browse.genHtml(a)
}};
browse.setViewAll=function(b){browse.vars.viewAll=!browse.vars.viewAll;
if(browse.vars.viewAll){$("div.tiles.compare-available.product-list").empty();
var a=$("ul.pagination.right");
a.empty();
a.append('<li class="viweall"><a href="javascript:browse.setViewAll()">View By Page</a></li>');
browse.infiniteScroll(true,b)
}else{browse.vars.currentPage=1;
browse.vars.paginationList=[1,2,3,4,5];
browse.setPagination(browse.vars.currentPhoneList.length);
browse.genHtml(browse.vars.currentPhoneList)
}};
browse.submitFilter=function(){browse.filterBy();
$("a.option-key.accordion-header.cta-filter-by").click()
};
browse.clearFilter=function(){$($('input[name="brandfilter"]:checked')).each(function(a,b){b.click()
});
$($('input[name="osfilter"]:checked')).each(function(a,b){b.click()
});
$($('input[name="featurefilter"]:checked')).each(function(a,b){b.click()
});
$($('input[name="pricefilter"]:checked')).each(function(a,b){b.click()
});
$($('input[name="zerophone"]:checked')).each(function(a,b){b.click()
});
$($('input[name="campaignId"]:checked')).each(function(a,b){b.click()
})
};
browse.afterLoginCallback=function(a){if(!isStarHubLite()||ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO)){ajaxService.getContractService(browse.populateGreenBanner,a,function(b){_SH.Components.Loading.Hide($(".secondary-box"))
})
}else{_SH.Components.Loading.Hide($(".secondary-box"))
}};
browse.setPage=function(a){if(a===-1&&browse.vars.currentPage>1){browse.vars.currentPage=browse.vars.currentPage-1;
if(browse.vars.currentPage<browse.vars.paginationList[0]){browse.vars.paginationList=[browse.vars.currentPage-4,browse.vars.currentPage-3,browse.vars.currentPage-2,browse.vars.currentPage-1,browse.vars.currentPage]
}browse.genHtml(browse.vars.currentPhoneList)
}else{if(a===-2&&browse.vars.currentPage<browse.vars.totalPage){browse.vars.currentPage=browse.vars.currentPage+1;
if(browse.vars.currentPage>browse.vars.paginationList[4]){browse.vars.paginationList=[browse.vars.currentPage,browse.vars.currentPage+1,browse.vars.currentPage+2,browse.vars.currentPage+3,browse.vars.currentPage+4]
}browse.genHtml(browse.vars.currentPhoneList)
}else{if(a>=1&&a<=browse.vars.totalPage){browse.vars.currentPage=a;
browse.genHtml(browse.vars.currentPhoneList)
}}}document.getElementById("ListFilterBar").scrollIntoView()
};
browse.windowResized=function(){var a=$(".product-list");
var b=function(){var f=null;
f=a.find(".cell11 .product-name");
a.data("names",f);
var d=0;
f.each(function(g,h){d=Math.max(d,f.filter(":eq("+g+")").height())
});
f.css({minHeight:d});
$plan=a.find(".cell11 .notes");
a.data("plan",$plan);
var e=0;
$plan.each(function(g,h){e=Math.max(e,$plan.filter(":eq("+g+")").height())
});
$plan.css({minHeight:e})
};
a.get(0).onWindowResized=b;
var c=new _SH.ResizeStack();
c.push("onWindowResized",a.get(0));
_SH.Components.ResizeCells(a,".inner");
a.on("viewChanged.viewstyle",function(){var d=$(this);
if(d.hasClass("list-view")){a.find(".cell").css({height:""})
}else{a.get(0).onCellResized()
}});
_SH.Components.ViewStyle($(".view-options"),a)
};
var phonecomp=phonecomp||{};
phonecomp.vars={brandModelList:[],brandModels:{},allFeatures:[],keyToHint:{}};
phonecomp.CONSTANTS={excludeFeature:{"Packaging Info":true,"Lowest Price":true}};
phonecomp.checkComparisonStatus=function(b){var a=ajaxService.getPhoneCompareBrandModel();
if(!a||a.length<2){var c={};
c.failmsg=onlinestore.MSG.NO_PHONE_IN_COMPARE_PAGE;
c.yesButton=true;
c.yesButtonText="OK";
c.closeButton=false;
if(b){c.yesButtonUrl=baseUrl.browse
}else{c.yesButtonUrl="javascript:stopColorbox();"
}throwError(c)
}else{if(b){}else{if(typeof campaignID_analyst=="undefined"){campaignID_analyst=""
}window.location.href=baseUrl.phoneComparison+"?icid="+scPageName+"_icon-small_A1_"+campaignID_analyst+"_"+baseUrl.phoneComparison
}}};
phonecomp.getComparePhoneModels=function(){phonecomp.checkComparisonStatus(true);
phonecomp.vars.brandModelList=ajaxService.getPhoneCompareBrandModel();
if(phonecomp.vars.brandModelList&&phonecomp.vars.brandModelList.length>0){ajaxService.getHandsetService(phonecomp.processHandsetData)
}};
phonecomp.extractFeatureNames=function(b,c){for(var a in b){if(b.hasOwnProperty(a)&&!phonecomp.CONSTANTS.excludeFeature[a]){pushDiff(phonecomp.vars.allFeatures,a)
}}return
};
phonecomp.genHtmlLabel=function(a){var b='<th class="col-label"><div><span>'+a+"</span></div></th>";
return b
};
phonecomp.valueMapping=function(a){if(a===undefined){return"N.A."
}else{if(a===null){return"N.A."
}else{if(a===""){return"N.A."
}else{if(a==="false"){return"No"
}else{if(a==="true"){return"Yes"
}else{if(a===false){return"No"
}else{if(a===true){return"Yes"
}else{return a
}}}}}}}};
phonecomp.genHtmlfieldText=function(a){var c=phonecomp.valueMapping(a);
var b='<td class="col-product col-fields"><div><span>'+c+"</span></div></td>";
return b
};
phonecomp.genHtmlfield=function(a,d){var c="";
var b=a.hintAsKey[d];
if(b==undefined||b===""){c=phonecomp.genHtmlfieldText("N.A.")
}else{if(typeof b=="string"){c=phonecomp.genHtmlfieldText(b)
}else{if(typeof b=="object"&&b[0]!=undefined){try{c=phonecomp.genHtmlfieldText(b.sort().join(","))
}catch(f){c=phonecomp.genHtmlfieldText("N.A.")
}}else{c=phonecomp.genHtmlfieldText("N.A.")
}}}return c
};
phonecomp.addListener=function(b){var a=b;
a.find("img").each(function(c,d){d.onload=function(){mobileService.triggerWindowResize()
};
d.onerror=function(){this.src=baseUrl.DEFAULT_IMAGE;
mobileService.triggerWindowResize()
}
});
a.find(".delete-item-btn").on("click",function(){var g='<div class="phone-wrapper"><div class="phone-img"><img alt="" src="'+baseUrl.DEFAULT_IMAGE+'" /></div><div class="phone-warning"><p>'+onlinestore.MSG.NO_PHONE_IN_COMPARE_PAGE+'</p><a href="javascript:window.location.replace(baseUrl.browse);" class="btn-secondaryGreen-rarrow"><span class="icon"></span>Choose another phone</a></div></div>';
var h=$(this),e=h.parents("td"),d=e.index(),c=h.parents("table");
var f=c.find("tr > *:nth-child("+(d+1)+")");
f.empty();
e.append(g);
phonecomp.removeCompareId(parseInt(this.id.replace("RemoveItemKey_","")))
});
a.find(".phonecomp-add-to-cart").on("click",function(){var c=parseInt(this.id.replace("AddToCartKey_",""));
$("#selectedPlanPartNum").text("brand="+escapeParam(phonecomp.vars.brandModels[c].brand)+"&model="+escapeParam(phonecomp.vars.brandModels[c].model));
s.linkTrackVars="prop14,eVar4,eVar8";
s.linkTrackEvents=s.events="scAdd";
s.tl(this,"o","Add to Cart Button | "+scPageName+" | "+phonecomp.vars.brandModels[c].model);
addToCart()
});
_SH.Site.autoLoadComponents(a);
return a
};
phonecomp.populatePhoneData=function(){var c='<tr><th class="col-label col1"></th>';
var d="";
var b;
for(var e in phonecomp.vars.brandModels){if(phonecomp.vars.brandModels.hasOwnProperty(e)){b=phonecomp.vars.brandModels[e];
d=[b.brand,b.model,b.imgHint,"| StarHub Store"].join(" ");
c=c+'<td class="col-product col2"><div class="phone-wrapper"><a href="javascript:void(0)" class="icon-secondaryGreen-cross delete-item-btn" id="RemoveItemKey_'+e+'"></a><div class="phone-img"><img alt="'+d+'" title="'+d+'" src="'+b.imageurl+'"></div><div class="phone-desc"><div class="phone-name-wrapper"><div class="phone-name">'+b.brand+'</div><div class="phone-model">'+b.model+'</div></div><div class="phone-price-wrapper"><span>From</span><div class="formatted-price"><small class="currency-symbol">$</small><span>'+baseUrl.roundingPrice(b.phonePrice).toFixed(2)+"</span></div></div></div></div></td>"
}}c=c+"</tr>";
var a=phonecomp.addListener($(c));
$("thead").empty().append(a)
};
phonecomp.populateFeatureData=function(){var b="";
for(var c=0,a=phonecomp.vars.allFeatures.length;
c<a;
c++){b=b+"<tr>";
b=b+phonecomp.genHtmlLabel(phonecomp.vars.allFeatures[c]);
for(var d in phonecomp.vars.brandModels){if(phonecomp.vars.brandModels.hasOwnProperty(d)){b=b+phonecomp.genHtmlfield(phonecomp.vars.brandModels[d],phonecomp.vars.allFeatures[c])
}}b=b+"</tr>"
}$("tbody").empty().append(b)
};
phonecomp.populateButtons=function(){var c='<tr><th class="col-label"><div><span></span></div></th>';
for(var b in phonecomp.vars.brandModels){if(phonecomp.vars.brandModels.hasOwnProperty(b)){c=c+'<td class="col-product col-action"><div><a href="javascript:void(0)" class="btn-secondaryGreen-rarrow phonecomp-add-to-cart"  id="AddToCartKey_'+b+'" title="Add to Cart"><span class="icon"></span>Add to Cart</a></div></td>'
}}c=c+"</tr>";
var a=phonecomp.addListener($(c));
$("tfoot").empty().append(a)
};
phonecomp.hintToKey=function(e,h,c,b){var a={};
var g,f,d;
if(e&&h&&typeof e=="object"&&typeof h=="object"){for(d in e){if(e.hasOwnProperty(d)&&h[d]!=undefined){g=h[d];
f=e[d];
a[g]=f
}}}if(c&&b&&typeof c=="object"&&typeof b=="object"){for(d in c){if(c.hasOwnProperty(d)){if(c.hasOwnProperty(d)&&b[d]!=undefined){g=b[d];
f=c[d];
a[g]=f
}}}}return a
};
phonecomp.processHandsetData=function(e){var b;
var d;
for(var c=0,a=phonecomp.vars.brandModelList.length;
c<a;
c++){d=phonecomp.vars.brandModelList[c].brand+";"+phonecomp.vars.brandModelList[c].model;
b=e[d];
if(b){phonecomp.vars.brandModels[c]={};
phonecomp.vars.brandModels[c].brand=phonecomp.vars.brandModelList[c].brand;
phonecomp.vars.brandModels[c].model=phonecomp.vars.brandModelList[c].model;
phonecomp.vars.brandModels[c].phoneName=b.deviceName;
phonecomp.vars.brandModels[c].phonePrice=parseFloat(b.deviceCheapestPrice);
phonecomp.vars.brandModels[c].imageurl=b.deviceMainImage;
phonecomp.vars.brandModels[c].imgHint=b.deviceMainImageHint;
phonecomp.vars.brandModels[c].hintAsKey=phonecomp.hintToKey(b.deviceFeatures,b.deviceFeaturesHint,b.deviceGroupedKeyFeatureList,b.deviceGroupedKeyFeatureHintList);
phonecomp.extractFeatureNames(phonecomp.vars.brandModels[c].hintAsKey)
}}phonecomp.vars.allFeatures=phonecomp.sortFeatures();
phonecomp.populatePhoneData();
phonecomp.populateFeatureData();
phonecomp.populateButtons();
mobileService.triggerWindowResize();
phonecomp.showContent()
};
phonecomp.sortFeatures=function(){return phonecomp.vars.allFeatures.sort()
};
phonecomp.removeCompareId=function(d){delete phonecomp.vars.brandModels[d];
var a=[];
for(var c in phonecomp.vars.brandModels){if(phonecomp.vars.brandModels.hasOwnProperty(c)){var b={};
b.brand=phonecomp.vars.brandModels[c].brand;
b.model=phonecomp.vars.brandModels[c].model;
a.push(b)
}}ajaxService.setPhoneCompareBrandModel(a)
};
phonecomp.showLoading=function(){_SH.Components.Loading.Show($("body"))
};
phonecomp.showContent=function(){_SH.Components.Loading.Hide($("body"))
};
var authToken=authToken||{};
authToken.vars={postAuthTokenCallBack:undefined};
authToken.newSignUpError=function(){var a={};
a.yesButton=true;
a.yesButtonText="OK";
a.failmsg=onlinestore.MSG.BLACK_LIST_ACCOUNT_ERROR;
a.yesButtonUrl=baseUrl.browse;
throwError(a)
};
authToken.passEligibleCheck=function(){var b=parseUrlParam($("#selectedPlanPartNum").text());
b.type="new";
var a={};
a.params=b;
a.nextPageURL=baseUrl.orderConfig;
postForm(a)
};
authToken.processNewSignUpEC=function(a){if(a.eligible){authToken.passEligibleCheck()
}else{authToken.newSignUpError()
}};
authToken.processNewSignUpMasterEC=function(d){var e=d.bdmsrequest,b;
for(var c=0,a=e.length;
c<a;
c++){b=e[c].bdmsresponse;
if(!(b&&b.eligible)){authToken.newSignUpError();
return
}}authToken.passEligibleCheck()
};
authToken.checkNewSignUp=function(a){if(!a){ajaxService.getAuthKey(authToken.checkNewSignUp)
}else{if(isStarHubLite(a)){_SH.Components.Loading.Show($(".modal-wrapper.signup-or-recontract"));
ajaxService.checkHubIdTypeAndProceed(function(){_SH.Components.Loading.Show($(".modal-wrapper.signup-or-recontract"));
ajaxService.checkBasketFull("",function(){ajaxService.newSignUpEligibleCheckService(authToken.processNewSignUpEC)
})
})
}else{ajaxService.checkBasketFull("",function(){ajaxService.newSignUpEligibleMasterCheckService(authToken.processNewSignUpMasterEC)
})
}}};
authToken.vars={inputValueMap:{docType:"",docID:"",birthDate:""},inputValidationMap:{docType:false,docID:false,birthDate:false}};
authToken.genDocTypeForm=function(){var a=callFAPI(ONLINEWEB_FAPI_URL.DOCUMENT_TYPE,"","GET");
a.done(function(c,d,b){if(c&&c.value&&c.value.length>0){authToken.genDocTypeFormHTML(c.value)
}else{throwError()
}});
a.fail(function(b,d,c){throwError()
})
};
authToken.genDocTypeFormHTML=function(d){var a='<option class="oneDocType" value="">Please Select</option>';
for(var b=0;
b<d.length;
b++){a=a+'<option class="oneDocType" value="'+d[b].value+'">'+d[b].value+"</option>"
}var c='<form class="modal-login-form form-template"><div id="authToken_docType_errorDiv" class="form-row free-size"><div class="form-label">Document Type:</div><div class="form-field"><div class="dropdown-wrapper"><select name="select_input" id="authToken_docType">'+a+'</select></div><span class="field-error-text" id="authToken_docType_errorSpan"></span></div></div><div id="authToken_docID_errorDiv" class="form-row free-size"><div class="form-label">Document ID:</div><div class="form-field"><input id="authToken_docID" type="text" name="docID" placeholder="e.g. S2782161H"/><span class="field-error-text" id="authToken_docID_errorSpan"></span></div></div><div><div class="form-row free-size" id="authToken_birthDate_errorDiv"><div class="form-label">Date Of Birth:</div><div class="form-field has-icon"><input id="authToken_birthDate" type="text" class="datepicker" placeholder="Please select" readonly="readonly"><div class="field-icon calendar-icon"></div><span class="field-error-text" id="authToken_birthDate_errorSpan" style="margin-left: 4px;"></span></div></div><div class="hubid-login-cta"></div><button class="btn-secondaryGreen-rarrow btn-login" id="authToken_nextBtn"><span class="icon"></span>Next</button></form>';
$("div.modal-header").empty().append("<h2>Please key in details for verification</h2>");
$("#nsuContent").empty().append(c);
_SH.Components.Dropdown($("#authToken_docType"));
$(".datepicker").datepicker({inline:true,dateFormat:"dd/mm/yy",maxDate:authToken.getTodayDate(),changeMonth:true,changeYear:true,yearRange:"-95:+0"});
mobileService.triggerWindowResize();
_SH.Components.Loading.Hide($(".modal-wrapper.signup-or-recontract"))
};
authToken.getTodayDate=function(){var a=new Date();
a.setDate(a.getDate());
return a
};
authToken.errorFn=function(b,c,e){var a="authToken_"+b+"_errorDiv";
var d="authToken_"+b+"_errorSpan";
e[b]=false;
$("#"+d).text(c);
$("#"+a).addClass("error")
};
authToken.validatedFn=function(c,a,f,e){var b="authToken_"+c+"_errorDiv";
var d="authToken_"+c+"_errorSpan";
f[c]=true;
e[c]=$.trim(a);
$("#"+d).empty();
$("#"+b).removeClass("error")
};
authToken.isAllUserInputValid=function(b){var a=true;
$.each(b,function(c,d){if(!d){a=false;
return
}});
return a
};
authToken.fillInErrors=function(b,a){$.each(b,function(c,d){if(!d){var e=$("#"+a+"_"+c);
if(e.attr("type")==="text"){e.trigger("blur")
}e.trigger("change")
}})
};
authToken.postAuthToken=function(){var b=authToken.vars.inputValueMap.docID;
var c=authToken.vars.inputValueMap.docType;
var a=authToken.vars.inputValueMap.birthDate;
_SH.Components.Loading.Show($(".modal-wrapper.signup-or-recontract"));
ajaxService.postAuthToken(function(){authToken.storeUserDetails(b,c,a);
_SH.Components.Loading.Hide($(".modal-wrapper.signup-or-recontract"));
ajaxService.sendcallback("",authToken.vars.postAuthTokenCallBack)
},undefined,{docID:b,docType:c,birthDate:a});
authToken.vars.inputValidationMap=authToken.resetValidationMap(authToken.vars.inputValidationMap)
};
authToken.resetValidationMap=function(a){var b={};
$.each(a,function(c,d){b[c]=false
});
return b
};
authToken.storeUserDetails=function(b,c,a){ajaxService.cookie(ajaxService.CONSTANTS.HUBIDLITE_USER_INFO,JSON.stringify({docID:b,docType:c,birthDate:a}),{path:"/"})
};
var ordertrack=ordertrack||{};
ordertrack.vars={orders:[]};
ordertrack.CONTANTS={};
ordertrack.handleError=function(d,c,e,f){var g=d?d:c;
if(e&&g){g=e+" "+g
}if(f&&g){g=f+" "+g
}return g
};
ordertrack.getOrderDeliveryHtml=function(b,a,c){return'<div class="span2 bg-lighter-grey"><div class="tracking-status-wrapper"><div class="tracking-status-icon"><div class="icon-delivery"></div><div class="icon-status '+b+'"></div></div><div class="tracking-status-detail"><h5>'+a+"</h5><div>"+c+"</div></div></div></div>"
};
ordertrack.genOneOrderHtml=function(c){if(!c.orderDeliveryInfo.deliveryAddress){c.orderDeliveryInfo.deliveryAddress={}
}try{var a='<div class="section-header"><h2 class="section-header-left">Order '+c.orderNo+'</h2></div><div class="section-body"><div class="inner"><div class="row-fluid"><div class="span2"><div class="form-row"><div class="form-label">Deliver to:</div><div class="form-field"><div class="disabled">'+ordertrack.handleError(c.orderDeliveryInfo.customerName,"")+"<br />"+ordertrack.handleError(c.orderDeliveryInfo.deliveryAddress.blockNo,"")+" "+ordertrack.handleError(c.orderDeliveryInfo.deliveryAddress.street,"","","<br />")+ordertrack.handleError(c.orderDeliveryInfo.deliveryAddress.level,"","Level","<br />")+ordertrack.handleError(c.orderDeliveryInfo.deliveryAddress.country,"")+" "+ordertrack.handleError(c.orderDeliveryInfo.deliveryAddress.postalCode,"")+'</div></div></div></div><div class="span2"><div class="form-row"><div class="form-label">Order total:</div><div class="form-field"><div class="disabled">$'+c.orderAmount+'</div></div></div><div class="form-row" style="display:none"><div class="form-label">Remarks:</div><div class="form-field"><div class="disabled">'+ordertrack.handleError(c.orderDeliveryInfo.orderDeliveryRemark,"-")+'</div></div></div></div></div><a href="javascript:void(0)" class="link-rarrow" style="display:none"><span class="icon"></span>View order details</a><hr class="separator" /><h5><strong>Order Status: </strong></h5><div class="row-fluid"><div class="span2 bg-lighter-grey"><div class="tracking-status-wrapper"><div class="tracking-status-icon"><div class="icon-processing"></div><div class="icon-status ok"></div></div><div class="tracking-status-detail"><h5>'+c.orderStatus+"</h5><div>Delivery Date: "+c.orderDeliveryInfo.appointDetail.appDate+"</div><div>Delivery Time: "+c.orderDeliveryInfo.appointDetail.timeBand+"</div></div></div></div>";
if(c.orderDeliveryInfo.orderDeliveryStatus=="Process Order"){a+=ordertrack.getOrderDeliveryHtml("nil","Process Order",onlinestore.MSG.ORDER_TRACKING_PROCESSING)
}else{if(c.orderDeliveryInfo.orderDeliveryStatus=="Delivery"){a+=ordertrack.getOrderDeliveryHtml("ok","Delivery",onlinestore.MSG.ORDER_TRACKING_DELIVERED)
}else{if(c.orderDeliveryInfo.orderDeliveryStatus=="Failed Delivery"){a+=ordertrack.getOrderDeliveryHtml("failed","Failed Delivery",ordertrack.handleError(c.orderUndeliveryReason,"-","Reason: "))
}else{if(c.orderDeliveryInfo.orderDeliveryStatus=="Cancel Order"){a+=ordertrack.getOrderDeliveryHtml("failed","Cancel Order",ordertrack.handleError(c.orderUndeliveryReason,"-"))
}else{if(!c.orderDeliveryInfo.orderDeliveryStatus){a+=ordertrack.getOrderDeliveryHtml("nil","-",ordertrack.handleError(c.orderUndeliveryReason,"-"))
}else{a+=ordertrack.getOrderDeliveryHtml("nil",c.orderDeliveryInfo.orderDeliveryStatus,ordertrack.handleError(c.orderUndeliveryReason,"-"))
}}}}}a+="</div></div></div>";
return a
}catch(b){mobileService.log("Generate order tracking html fail.");
mobileService.log(b);
return""
}};
ordertrack.processTracking=function(d){var c=d.mainContext.present.any[0].orderTrackingInfo;
for(var b=0,a=c.length;
b<a;
b++){if(c[b].orderDeliveryInfo){ordertrack.vars.orders.push(c[b])
}}$("#order_count").text(ordertrack.vars.orders.length)
};
ordertrack.genPageHtml=function(){var d="";
var c=ordertrack.vars.orders;
for(var b=0,a=c.length;
b<a;
b++){d+=ordertrack.genOneOrderHtml(c[b])
}$(".primary-column").append(d);
_SH.Components.Loading.Hide($("body"))
};
ordertrack.getOrderData=function(){var a=callFAPI(ONLINEWEB_FAPI_URL.ORDER_TRACK,"","GET");
a.done(function(b){ordertrack.processTracking(b);
if(ordertrack.vars.orders.length<=0){_SH.Components.Loading.Hide($("body"))
}else{$("#remindertext").show();
ordertrack.genPageHtml()
}});
a.fail(function(b){throwError({debug:"retrieve order tracking data fail!"})
})
};
var liteInfo=liteInfo||{};
liteInfo.processDropdowns=function(){var a=Object.create(AjPool);
liteInfo.processSalutation(a);
liteInfo.processGender(a);
liteInfo.processPersonalId(a);
liteInfo.processNationality(a);
liteInfo.processRace(a);
a.done({loadSelector:"div.hubid-lite-form",doneFn:function(){mobileService.triggerWindowResize()
}})
};
liteInfo.processSalutation=function(b){b.addTask();
var a=callFAPI(ONLINEWEB_FAPI_URL.LOV_TITLE,"","GET");
a.done(function(d,e,c){if(d&&d.value&&d.value.length>0){liteInfo.genSalutationHtml(d.value);
$("#liteInfo_salutation").change();
b.removeTask()
}else{b.abort();
throwError({debug:"salutation api response incorrect"})
}});
a.fail(function(c,e,d){b.abort();
throwError({debug:"salutation GET failed"})
})
};
liteInfo.genSalutationHtml=function(a){$("#salutationDropdownDiv").append('<select id="liteInfo_salutation"></select>');
var b="";
for(var c=0;
c<a.length;
c++){b+='<option class="oneSalutation" value="'+a[c].value+'">'+a[c].value+"</option>"
}$("#liteInfo_salutation").append(b);
_SH.Components.Dropdown($("#liteInfo_salutation"))
};
liteInfo.processGender=function(b){b.addTask();
var a=callFAPI(ONLINEWEB_FAPI_URL.LOV_GENDER,"","GET");
a.done(function(d,e,c){if(d&&d.value&&d.value.length>0){liteInfo.genGenderHtml(d.value);
$("#liteInfo_gender").change();
b.removeTask()
}else{b.abort();
throwError({debug:"gender api response incorrect"})
}});
a.fail(function(c,e,d){b.abort();
throwError({debug:"gender GET failed"})
})
};
liteInfo.genGenderHtml=function(b){$("#genderDropdownDiv").append('<select id="liteInfo_gender"></select>');
var a="";
for(var c=0;
c<b.length;
c++){a+='<option class="oneGender" value="'+b[c].value+'">'+b[c].value+"</option>"
}$("#liteInfo_gender").append(a);
_SH.Components.Dropdown($("#liteInfo_gender"))
};
liteInfo.processPersonalId=function(a){a.addTask();
var b=callFAPI(ONLINEWEB_FAPI_URL.DOCUMENT_TYPE,"","GET");
b.done(function(e,f,d){if(e&&e.value&&e.value.length>0){liteInfo.genPersonalIdHtml(e.value);
var c=$(".onePersonalId:selected").attr("value");
liteInfo.validatedFn("personalId",c,liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap);
liteInfo.processIdType(a,c);
a.removeTask()
}else{a.abort();
throwError({debug:"personal id api response incorrect"})
}});
b.fail(function(c,e,d){a.abort();
throwError({debug:"personal id GET failed"})
})
};
liteInfo.genPersonalIdHtml=function(a){$("#personalIdDropdownDiv").append('<select id="liteInfo_personalId"></select>');
var c="";
for(var b=0;
b<a.length;
b++){c+='<option class="onePersonalId" value="'+a[b].value+'">'+a[b].value+"</option>"
}$("#liteInfo_personalId").append(c);
_SH.Components.Dropdown($("#liteInfo_personalId"))
};
liteInfo.processIdType=function(c,a){if(a.toLowerCase()===liteInfo.vars.CONSTANTS.NRIC){liteInfo.validatedFn("idType","",liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap);
liteInfo.genIdTypeHtml([])
}else{c.addTask();
var b=callFAPI(ONLINEWEB_FAPI_URL.LOV_DOCSUBTYPE,$(".onePersonalId:selected").attr("value"),"GET");
b.done(function(e,f,d){if(e&&e.value&&e.value.length>0){liteInfo.genIdTypeHtml(e.value);
$("#liteInfo_idType").change();
c.removeTask()
}else{c.abort();
throwError({debug:"id type api response incorrect"})
}});
b.fail(function(d,f,e){c.abort();
throwError({debug:"id type GET failed"})
})
}};
liteInfo.genIdTypeHtml=function(a){$("#idTypeDropdownDiv").empty().append('<select id="liteInfo_idType"></select>');
var b="";
$.each(a,function(c,d){b+='<option class="oneIdType" value="'+d.value+'">'+d.value+"</option>"
});
$("#liteInfo_idType").append(b);
_SH.Components.Dropdown($("#liteInfo_idType"));
if(a.length<=0){$("#liteInfo_idType_errorDiv").addClass("inactive");
$("#liteInfo_idType").msDropDown().data("dd").set("disabled",true)
}else{$("#liteInfo_idType_errorDiv").removeClass("inactive");
$("#liteInfo_idType").msDropDown().data("dd").set("disabled",false)
}};
liteInfo.processNationality=function(b){b.addTask();
var a=callFAPI(ONLINEWEB_FAPI_URL.LOV_NATIONALITY,"","GET");
a.done(function(d,e,c){if(d&&d.value&&d.value.length>0){liteInfo.genNationalityHtml(d.value);
$("#liteInfo_nationality").change();
b.removeTask()
}else{b.abort();
throwError({debug:"nationality api response incorrect"})
}});
a.fail(function(c,e,d){b.abort();
throwError({debug:"nationality GET failed"})
})
};
liteInfo.genNationalityHtml=function(a){$("#nationalityDropdownDiv").append('<select id="liteInfo_nationality"></select>');
var c="";
for(var b=0;
b<a.length;
b++){c+='<option class="oneNationality" value="'+a[b].value+'">'+a[b].value+"</option>"
}$("#liteInfo_nationality").append(c);
_SH.Components.Dropdown($("#liteInfo_nationality"))
};
liteInfo.processRace=function(b){b.addTask();
var a=callFAPI(ONLINEWEB_FAPI_URL.LOV_RACE,"","GET");
a.done(function(d,e,c){if(d&&d.value&&d.value.length>0){liteInfo.genRaceHtml(d.value);
$("#liteInfo_race").change();
b.removeTask()
}else{b.abort();
throwError({debug:"race api response incorrect"})
}});
a.fail(function(c,e,d){b.abort();
throwError({debug:"race GET failed"})
})
};
liteInfo.genRaceHtml=function(b){$("#raceDropdownDiv").append('<select id="liteInfo_race"></select>');
var c="";
for(var a=0;
a<b.length;
a++){c+='<option class="oneRace" value="'+b[a].value+'">'+b[a].value+"</option>"
}$("#liteInfo_race").append(c);
_SH.Components.Dropdown($("#liteInfo_race"))
};
liteInfo.getTodayDate=function(){var a=new Date();
a.setDate(a.getDate());
return a
};
liteInfo.validatedFn=function(d,a,b,f){var c="liteInfo_"+d+"_errorDiv";
var e="liteInfo_"+d+"_errorSpan";
if(b.hasOwnProperty(d)){b[d]=true
}f[d]=$.trim(a);
$("#"+e).empty();
$("#"+c).removeClass("error")
};
liteInfo.errorFn=function(c,d,a){var b="liteInfo_"+c+"_errorDiv";
var e="liteInfo_"+c+"_errorSpan";
if(a.hasOwnProperty(c)){a[c]=false
}$("#"+e).text(d);
$("#"+b).addClass("error")
};
liteInfo.autoFillAddr=function(f,c){var e=Object.create(AjPool);
var b=$("#"+c+"_postalCode");
var d=$("#"+c+"_street");
e.addTask();
e.done({loadSelector:"div.hubid-lite-form"});
var a=callFAPI(ONLINEWEB_FAPI_URL.ADDRESS_POSTALCODE,f,"GET");
a.done(function(h,j,g){if(h.localAddress.length>0){liteInfo.vars.custInfoMap.street=h.localAddress[0].street;
d.val(liteInfo.vars.custInfoMap.street);
liteInfo.vars.addressMap=liteInfo.getAddressMap(h.localAddress);
liteInfo.populateBlocks();
liteInfo.clearAddrFields({level:true,unit:true});
liteInfo.validatedFn("postalCode",f,liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap)
}else{liteInfo.processInValidPostal()
}e.removeTask()
});
a.fail(function(g,j,h){e.abort();
throwError({debug:"address GET failed"})
})
};
liteInfo.processInValidPostal=function(){liteInfo.errorFn("postalCode",onlinestore.MSG.BLANK_INPUT_ERROR_MSG,liteInfo.vars.isValidMap)
};
liteInfo.clearAddrFields=function(a){if(a){if(a.street){$("#liteInfo_street").val("")
}if(a.block){liteInfo.clearDropdown("block",liteInfo.vars.isValidMap)
}if(a.level){liteInfo.clearDropdown("level",liteInfo.vars.isValidMap)
}if(a.unit){liteInfo.clearDropdown("unit",liteInfo.vars.isValidMap)
}}else{$("#liteInfo_street").val("");
liteInfo.clearDropdown("block",liteInfo.vars.isValidMap);
liteInfo.clearDropdown("level",liteInfo.vars.isValidMap);
liteInfo.clearDropdown("unit",liteInfo.vars.isValidMap)
}};
liteInfo.clearDropdown=function(d,b){var c="liteInfo_"+d+"_errorDiv";
var e="liteInfo_"+d+"_errorSpan";
var a="liteInfo_"+d+"_dropdownDiv";
b[d]=false;
$("#"+a).empty().append("<select><select>");
_SH.Components.Dropdown($("#"+a+" select"));
$("#"+c).removeClass("error");
$("#"+e).empty()
};
liteInfo.getAddressMap=function(b){var d={};
for(var c=0;
c<b.length;
c++){if(!d.hasOwnProperty(b[c].blockNo)){d[b[c].blockNo]={}
}var e=d[b[c].blockNo];
if(!e.hasOwnProperty(b[c].level)){e[b[c].level]={}
}var a=e[b[c].level];
a[b[c].unit]=b[c].addressId
}return d
};
liteInfo.populateBlocks=function(){var b='<select id="liteInfo_block" style="width: 100%;"><option value="Select">Select</option>';
for(var c in liteInfo.vars.addressMap){if(liteInfo.vars.addressMap.hasOwnProperty(c)){b=b+"<option value='"+c+"'>"+c+"</option>"
}}b+="</select>";
var a=$("#liteInfo_block_dropdownDiv");
a.empty().append(b);
_SH.Components.Dropdown($("#liteInfo_block"))
};
liteInfo.populateLevels=function(c){var a='<select id="liteInfo_level" style="width: 100%;"><option value="Select">Select</option>';
for(var d in liteInfo.vars.addressMap[c]){if(liteInfo.vars.addressMap[c].hasOwnProperty(d)){a=a+"<option value='"+d+"'>"+d+"</option>"
}}a+="</select>";
var b=$("#liteInfo_level_dropdownDiv");
b.empty().append(a);
_SH.Components.Dropdown($("#liteInfo_level"))
};
liteInfo.populateUnits=function(d,e){var a='<select id="liteInfo_unit" style="width: 100%;"><option value="Select">Select</option>';
for(var c in liteInfo.vars.addressMap[d][e]){if(liteInfo.vars.addressMap[d][e].hasOwnProperty(c)){a=a+"<option value='"+c+"'>"+c+"</option>"
}}a+="</select>";
var b=$("#liteInfo_unit_dropdownDiv");
b.empty().append(a);
_SH.Components.Dropdown($("#liteInfo_unit"))
};
liteInfo.isValidInfo=function(a){var b=true;
$.each(a,function(d,c){if(!c){b=false;
return
}});
return b
};
liteInfo.fillInErrors=function(a){$.each(liteInfo.vars.isValidMap,function(b,d){if(!d){var c=$("#"+a+"_"+b);
liteInfo.triggerError(c)
}})
};
liteInfo.triggerError=function(a){if(a.attr("type")==="text"){a.trigger("blur")
}a.trigger("change")
};
liteInfo.postSubPick=function(c){var a=liteInfo.getSubReqPickMsg();
c.addTask();
var b=callFAPI(ONLINEWEB_FAPI_URL.BASKET_PICK,"","POST",a);
b.done(function(e,f,d){c.removeTask()
});
b.fail(function(d,f,e){c.abort();
throwError({debug:"POST main pick for hub id lite failed"})
})
};
liteInfo.getSubReqPickMsg=function(){var a=new SubscriptionRequestPick();
a.setPickId(OrderConfigScope.mainPickID);
a.setSubscriptionType(OrderConfigScope.subscriptionType);
a.setPartNum(OrderConfigScope.selectedPlan.partNum);
a.setDeviceCategory(OrderConfigScope.phone[OrderConfigScope.selectedCapacity].deviceCategory);
a.setPlanPartNum(OrderConfigScope.selectedPlan.partNum);
a.setModeOfService(OrderConfigScope.selectedPlan.modeOfService);
a.setTypeOfPlan(OrderConfigScope.selectedPlan.typeOfPlan);
a.setAddressId(liteInfo.vars.custInfoMap.addressId);
a.setBlockNo(liteInfo.vars.custInfoMap.block);
a.setStreet(liteInfo.vars.custInfoMap.street);
a.setLevel(liteInfo.vars.custInfoMap.level);
a.setUnit(liteInfo.vars.custInfoMap.unit);
a.setPostalCode(liteInfo.vars.custInfoMap.postalCode);
return getSubscriptionRequestPickMessage(a)
};
liteInfo.postCustInfo=function(c){var a=liteInfo.getCustInfoMsg();
c.addTask();
var b=callFAPI(ONLINEWEB_FAPI_URL.UPDATE_CUST_INFO,"","POST",a);
b.done(function(e,f,d){c.removeTask()
});
b.fail(function(d,f,e){c.abort();
throwError({debug:"POST customer info for hub id lite failed"})
})
};
liteInfo.getCustInfoMsg=function(){var b=new UpdateUserInfo();
var a=liteInfo.vars.custInfoMap;
b.setTitle(a.salutation);
b.setName(a.name);
b.setDocType(a.personalId);
b.setDocSubType(a.idType);
b.setGender(a.gender);
b.setDob(a.birthDate);
b.setRace(a.race);
b.setNationality(a.nationality);
b.setMobileNo(a.mobileNum);
b.setHomeNo(a.homeNum);
b.setRegAddressId(a.addressId);
return getUpdateCustInfoMsg(b)
};
liteInfo.clearVars=function(){liteInfo.vars={CONSTANTS:{HOME_NUMBER_REGEX:/^[6]\d{7}$/,MOBILE_NUMBER_REGEX:/^[89]\d{7}$/,NRIC:"nric",FIN:"fin"},isValidMap:{name:false,idNumber:false,birthDate:false,postalCode:false,homeNum:false,mobileNum:false,block:false,level:false,unit:false},custInfoMap:{salutation:"",name:"",gender:"",personalId:"",idType:"",idNumber:"",nationality:"",race:"",birthDate:"",mobileNum:"",homeNum:"",postalCode:"",street:"",block:"",level:"",unit:"",addressId:""},addressMap:{}}
};
liteInfo.blurNumHandler=function(){var c=$("#liteInfo_mobileNum").val();
var d=$("#liteInfo_homeNum").val();
var a=validateRequire(d);
var e=validateRequire(c);
var b=validateFormat(liteInfo.vars.CONSTANTS.HOME_NUMBER_REGEX,d);
var f=validateFormat(liteInfo.vars.CONSTANTS.MOBILE_NUMBER_REGEX,c);
if(a&&e){liteInfo.validateNum(f,"mobileNum",c);
liteInfo.validateNum(b,"homeNum",d)
}else{if(a){liteInfo.validatedFn("mobileNum",c,liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap);
liteInfo.validateNum(b,"homeNum",d)
}else{if(e){liteInfo.validatedFn("homeNum",d,liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap);
liteInfo.validateNum(f,"mobileNum",c)
}else{liteInfo.errorFn("homeNum",onlinestore.MSG.WRONG_NUMBER,liteInfo.vars.isValidMap);
liteInfo.errorFn("mobileNum",onlinestore.MSG.WRONG_NUMBER,liteInfo.vars.isValidMap)
}}}};
liteInfo.validateNum=function(c,b,a){if(c){liteInfo.validatedFn(b,a,liteInfo.vars.isValidMap,liteInfo.vars.custInfoMap)
}else{liteInfo.errorFn(b,onlinestore.MSG.WRONG_NUMBER,liteInfo.vars.isValidMap)
}};
liteInfo.processLiteBillingLine=function(){OrderConfigScope.billInfo.doPost=false;
OrderConfigScope.billInfo.content=[];
OrderConfigScope.billInfo.content.push({billingAddress:{addressId:liteInfo.vars.custInfoMap.addressId,blockNo:liteInfo.vars.custInfoMap.block,street:liteInfo.vars.custInfoMap.street,level:liteInfo.vars.custInfoMap.level,unit:liteInfo.vars.custInfoMap.unit,postalCode:liteInfo.vars.custInfoMap.postalCode}});
OrderConfigScope.popOutFormForBillingLines(1)
};
liteInfo.processFINValidation=function(h){var b=[];
b.multiples=[2,7,6,5,4,3,2];
if(!h||h==""){return false
}if(h.length!=9){return false
}var e=0,d=0,a;
var g=h[0],c=h[h.length-1];
if(g!="F"&&g!="G"){return false
}a=h.substr(1,h.length-2);
if(isNaN(a)){return false
}while(a!=0){e+=(a%10)*b.multiples[b.multiples.length-(1+d++)];
a/=10;
a=Math.floor(a)
}var f;
if(g=="F"){f=["X","W","U","T","R","Q","P","N","M","L","K"]
}else{f=["R","Q","P","N","M","L","K","X","W","U","T"]
}return c==f[e%11]
};
liteInfo.processNRICValidation=function(e){var h=[];
h.multiples=[2,7,6,5,4,3,2];
if(!e||e==""){return false
}if(e.length!=9){return false
}var d=0,c=0,a;
var g=e[0],b=e[e.length-1];
if(g!="S"&&g!="T"){return false
}a=e.substr(1,e.length-2);
if(isNaN(a)){return false
}while(a!=0){d+=(a%10)*h.multiples[h.multiples.length-(1+c++)];
a/=10;
a=Math.floor(a)
}var f;
if(g=="S"){f=["J","Z","I","H","G","F","E","D","C","B","A"]
}else{f=["G","F","E","D","C","B","A","J","Z","I","H"]
}return b==f[d%11]
};